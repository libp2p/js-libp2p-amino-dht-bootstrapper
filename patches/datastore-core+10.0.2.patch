diff --git a/node_modules/datastore-core/dist/index.min.js b/node_modules/datastore-core/dist/index.min.js
index 50fd21b..353a3de 100644
--- a/node_modules/datastore-core/dist/index.min.js
+++ b/node_modules/datastore-core/dist/index.min.js
@@ -1,4 +1,5 @@
 (function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.DatastoreCore = factory()}(typeof self !== 'undefined' ? self : this, function () {
-"use strict";var DatastoreCore=(()=>{var De=Object.defineProperty;var zt=Object.getOwnPropertyDescriptor;var Ot=Object.getOwnPropertyNames;var Pt=Object.prototype.hasOwnProperty;var C=(r,e)=>{for(var t in e)De(r,t,{get:e[t],enumerable:!0})},Lt=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Ot(e))!Pt.call(r,o)&&o!==t&&De(r,o,{get:()=>e[o],enumerable:!(n=zt(e,o))||n.enumerable});return r};var _t=r=>Lt(De({},"__esModule",{value:!0}),r);var In={};C(In,{BaseDatastore:()=>v,KeyTransformDatastore:()=>_,MemoryDatastore:()=>ge,MountDatastore:()=>Se,NamespaceDatastore:()=>Ie,ShardingDatastore:()=>ve,TieredDatastore:()=>ke,shard:()=>Ye});var Ye={};C(Ye,{NextToLast:()=>de,PREFIX:()=>fe,Prefix:()=>le,SHARDING_FN:()=>pe,ShardBase:()=>J,Suffix:()=>he,parseShardFun:()=>Dt,readShardFun:()=>me});var ze={};C(ze,{base10:()=>Rt});var Mn=new Uint8Array(0);function ot(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}function U(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function st(r){return new TextEncoder().encode(r)}function it(r){return new TextDecoder().decode(r)}function Tt(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<r.length;o++){var s=r.charAt(o),i=s.charCodeAt(0);if(t[i]!==255)throw new TypeError(s+" is ambiguous");t[i]=o}var a=r.length,l=r.charAt(0),N=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function f(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var h=0,u=0,m=0,b=d.length;m!==b&&d[m]===0;)m++,h++;for(var g=(b-m)*c+1>>>0,w=new Uint8Array(g);m!==b;){for(var S=d[m],A=0,E=g-1;(S!==0||A<u)&&E!==-1;E--,A++)S+=256*w[E]>>>0,w[E]=S%a>>>0,S=S/a>>>0;if(S!==0)throw new Error("Non-zero carry");u=A,m++}for(var k=g-u;k!==g&&w[k]===0;)k++;for(var j=l.repeat(h);k<g;++k)j+=r.charAt(w[k]);return j}function p(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var h=0;if(d[h]!==" "){for(var u=0,m=0;d[h]===l;)u++,h++;for(var b=(d.length-h)*N+1>>>0,g=new Uint8Array(b);d[h];){var w=t[d.charCodeAt(h)];if(w===255)return;for(var S=0,A=b-1;(w!==0||S<m)&&A!==-1;A--,S++)w+=a*g[A]>>>0,g[A]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");m=S,h++}if(d[h]!==" "){for(var E=b-m;E!==b&&g[E]===0;)E++;for(var k=new Uint8Array(u+(b-E)),j=u;E!==b;)k[j++]=g[E++];return k}}}function z(d){var h=p(d);if(h)return h;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:p,decode:z}}var Kt=Tt,jt=Kt,ct=jt;var Me=class{name;prefix;baseEncode;constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Ne=class{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ut(this,e)}},Ue=class{decoders;constructor(e){this.decoders=e}or(e){return ut(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function ut(r,e){return new Ue({...r.decoders??{[r.prefix]:r},...e.decoders??{[e.prefix]:e}})}var $e=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,n,o){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=o,this.encoder=new Me(e,t,n),this.decoder=new Ne(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function B({name:r,prefix:e,encode:t,decode:n}){return new $e(r,e,t,n)}function O({name:r,prefix:e,alphabet:t}){let{encode:n,decode:o}=ct(t,r);return B({prefix:e,name:r,encode:n,decode:s=>U(o(s))})}function Bt(r,e,t,n){let o={};for(let c=0;c<e.length;++c)o[e[c]]=c;let s=r.length;for(;r[s-1]==="=";)--s;let i=new Uint8Array(s*t/8|0),a=0,l=0,N=0;for(let c=0;c<s;++c){let f=o[r[c]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);l=l<<t|f,a+=t,a>=8&&(a-=8,i[N++]=255&l>>a)}if(a>=t||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return i}function Vt(r,e,t){let n=e[e.length-1]==="=",o=(1<<t)-1,s="",i=0,a=0;for(let l=0;l<r.length;++l)for(a=a<<8|r[l],i+=8;i>t;)i-=t,s+=e[o&a>>i];if(i!==0&&(s+=e[o&a<<t-i]),n)for(;s.length*t&7;)s+="=";return s}function y({name:r,prefix:e,bitsPerChar:t,alphabet:n}){return B({prefix:e,name:r,encode(o){return Vt(o,n,t)},decode(o){return Bt(o,n,t,r)}})}var Rt=O({prefix:"9",name:"base10",alphabet:"0123456789"});var Oe={};C(Oe,{base16:()=>Wt,base16upper:()=>Jt});var Wt=y({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Jt=y({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Pe={};C(Pe,{base2:()=>Gt});var Gt=y({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Le={};C(Le,{base256emoji:()=>qt});var ft=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Xt=ft.reduce((r,e,t)=>(r[t]=e,r),[]),Ht=ft.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Qt(r){return r.reduce((e,t)=>(e+=Xt[t],e),"")}function Zt(r){let e=[];for(let t of r){let n=Ht[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}var qt=B({prefix:"\u{1F680}",name:"base256emoji",encode:Qt,decode:Zt});var _e={};C(_e,{base32:()=>P,base32hex:()=>rr,base32hexpad:()=>or,base32hexpadupper:()=>sr,base32hexupper:()=>nr,base32pad:()=>er,base32padupper:()=>tr,base32upper:()=>Yt,base32z:()=>ir});var P=y({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Yt=y({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),er=y({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),tr=y({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),rr=y({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),nr=y({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),or=y({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),sr=y({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ir=y({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Te={};C(Te,{base36:()=>ee,base36upper:()=>ar});var ee=O({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ar=O({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ke={};C(Ke,{base58btc:()=>I,base58flickr:()=>cr});var I=O({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),cr=O({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Be={};C(Be,{base64:()=>je,base64pad:()=>ur,base64url:()=>fr,base64urlpad:()=>lr});var je=y({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ur=y({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),fr=y({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),lr=y({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ve={};C(Ve,{base8:()=>hr});var hr=y({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Re={};C(Re,{identity:()=>dr});var dr=B({prefix:"\0",name:"identity",encode:r=>it(r),decode:r=>st(r)});var Jn=new TextEncoder,Gn=new TextDecoder;var Je={};C(Je,{identity:()=>Pr});var yr=dt,lt=128,br=127,gr=~br,wr=Math.pow(2,31);function dt(r,e,t){e=e||[],t=t||0;for(var n=t;r>=wr;)e[t++]=r&255|lt,r/=128;for(;r&gr;)e[t++]=r&255|lt,r>>>=7;return e[t]=r|0,dt.bytes=t-n+1,e}var xr=We,Cr=128,ht=127;function We(r,n){var t=0,n=n||0,o=0,s=n,i,a=r.length;do{if(s>=a)throw We.bytes=0,new RangeError("Could not decode varint");i=r[s++],t+=o<28?(i&ht)<<o:(i&ht)*Math.pow(2,o),o+=7}while(i>=Cr);return We.bytes=s-n,t}var vr=Math.pow(2,7),Sr=Math.pow(2,14),Er=Math.pow(2,21),Fr=Math.pow(2,28),Ar=Math.pow(2,35),kr=Math.pow(2,42),Ir=Math.pow(2,49),Dr=Math.pow(2,56),Mr=Math.pow(2,63),Nr=function(r){return r<vr?1:r<Sr?2:r<Er?3:r<Fr?4:r<Ar?5:r<kr?6:r<Ir?7:r<Dr?8:r<Mr?9:10},Ur={encode:yr,decode:xr,encodingLength:Nr},$r=Ur,te=$r;function re(r,e=0){return[te.decode(r,e),te.decode.bytes]}function V(r,e,t=0){return te.encode(r,e,t),e}function R(r){return te.encodingLength(r)}function T(r,e){let t=e.byteLength,n=R(r),o=n+R(t),s=new Uint8Array(o+t);return V(r,s,0),V(t,s,n),s.set(e,o),new W(r,t,e,s)}function pt(r){let e=U(r),[t,n]=re(e),[o,s]=re(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new W(t,o,i,e)}function mt(r,e){if(r===e)return!0;{let t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&ot(r.bytes,t.bytes)}}var W=class{code;size;digest;bytes;constructor(e,t,n,o){this.code=e,this.size=t,this.digest=n,this.bytes=o}};var yt=0,zr="identity",bt=U;function Or(r){return T(yt,bt(r))}var Pr={code:yt,name:zr,encode:bt,digest:Or};var He={};C(He,{sha256:()=>Lr,sha512:()=>_r});function Xe({name:r,code:e,encode:t}){return new Ge(r,e,t)}var Ge=class{name;code;encode;constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?T(this.code,t):t.then(n=>T(this.code,n))}else throw Error("Unknown type, must be binary type")}};function wt(r){return async e=>new Uint8Array(await crypto.subtle.digest(r,e))}var Lr=Xe({name:"sha2-256",code:18,encode:wt("SHA-256")}),_r=Xe({name:"sha2-512",code:19,encode:wt("SHA-512")});function xt(r,e){let{bytes:t,version:n}=r;switch(n){case 0:return Kr(t,Qe(r),e??I.encoder);default:return jr(t,Qe(r),e??P.encoder)}}var Ct=new WeakMap;function Qe(r){let e=Ct.get(r);if(e==null){let t=new Map;return Ct.set(r,t),t}return e}var ae=class r{code;version;multihash;bytes;"/";constructor(e,t,n,o){this.code=t,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:t}=this;if(e!==oe)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Br)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=T(e,t);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return r.equals(this,e)}static equals(e,t){let n=t;return n!=null&&e.code===n.code&&e.version===n.version&&mt(e.multihash,n.multihash)}toString(e){return xt(this,e)}toJSON(){return{"/":xt(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let t=e;if(t instanceof r)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){let{version:n,code:o,multihash:s,bytes:i}=t;return new r(n,o,s,i??vt(n,o,s.bytes))}else if(t[Vr]===!0){let{version:n,multihash:o,code:s}=t,i=pt(o);return r.create(n,s,i)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==oe)throw new Error(`Version 0 CID must use dag-pb (code: ${oe}) block encoding`);return new r(e,t,n,n.bytes)}case 1:{let o=vt(e,t,n.bytes);return new r(e,t,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return r.create(0,oe,e)}static createV1(e,t){return r.create(1,e,t)}static decode(e){let[t,n]=r.decodeFirst(e);if(n.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=r.inspectBytes(e),n=t.size-t.multihashSize,o=U(e.subarray(n,n+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");let s=o.subarray(t.multihashSize-t.digestSize),i=new W(t.multihashCode,t.digestSize,s,o);return[t.version===0?r.createV0(i):r.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[f,p]=re(e.subarray(t));return t+=p,f},o=n(),s=oe;if(o===18?(o=0,t=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=t,a=n(),l=n(),N=t+l,c=N-i;return{version:o,codec:s,multihashCode:a,digestSize:l,multihashSize:c,size:N}}static parse(e,t){let[n,o]=Tr(e,t),s=r.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Qe(s).set(n,e),s}};function Tr(r,e){switch(r[0]){case"Q":{let t=e??I;return[I.prefix,t.decode(`${I.prefix}${r}`)]}case I.prefix:{let t=e??I;return[I.prefix,t.decode(r)]}case P.prefix:{let t=e??P;return[P.prefix,t.decode(r)]}case ee.prefix:{let t=e??ee;return[ee.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}}function Kr(r,e,t){let{prefix:n}=t;if(n!==I.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let o=e.get(n);if(o==null){let s=t.encode(r).slice(1);return e.set(n,s),s}else return o}function jr(r,e,t){let{prefix:n}=t,o=e.get(n);if(o==null){let s=t.encode(r);return e.set(n,s),s}else return o}var oe=112,Br=18;function vt(r,e,t){let n=R(r),o=n+R(e),s=new Uint8Array(o+t.byteLength);return V(r,s,0),V(e,s,n),s.set(t,o),s}var Vr=Symbol.for("@ipld/js-cid/CID");var Ze={...Re,...Pe,...Ve,...ze,...Oe,..._e,...Te,...Ke,...Be,...Le},yo={...He,...Je};function St(r=0){return new Uint8Array(r)}function Ft(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}var Et=Ft("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),qe=Ft("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=St(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Rr={utf8:Et,"utf-8":Et,hex:Ze.base16,latin1:qe,ascii:qe,binary:qe,...Ze},ce=Rr;function At(r,e="utf8"){let t=ce[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return t.decoder.decode(`${t.prefix}${r}`)}function kt(r,e="utf8"){let t=ce[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return t.encoder.encode(r).substring(1)}var $="/",It=new TextEncoder().encode($),ue=It[0],x=class r{_buf;constructor(e,t){if(typeof e=="string")this._buf=At(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==ue)throw new Error("Invalid key")}toString(e="utf8"){return kt(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new r(e.join($))}static random(){return new r(Math.random().toString().substring(2))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new r(e):typeof e.uint8Array=="function"?new r(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=It),this._buf[0]!==ue){let e=new Uint8Array(this._buf.byteLength+1);e.fill(ue,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===ue;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let o=0;o<t.length;o++){if(n.length<o+1)return!1;let s=t[o],i=n[o];if(s<i)return!0;if(s>i)return!1}return t.length<n.length}reverse(){return r.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split($).slice(1)}type(){return Wr(this.baseNamespace())}name(){return Jr(this.baseNamespace())}instance(e){return new r(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith($)||(e+=$),e+=this.type(),new r(e)}parent(){let e=this.list();return e.length===1?new r($):new r(e.slice(0,-1).join($))}child(e){return this.toString()===$?e:e.toString()===$?this:new r(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return r.withNamespaces([...this.namespaces(),...Gr(e.map(t=>t.namespaces()))])}};function Wr(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Jr(r){let e=r.split(":");return e[e.length-1]}function Gr(r){return[].concat(...r)}var fe="/repo/flatfs/shard/",pe="SHARDING",J=class{param;name;_padding;constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${fe}v1/${this.name}/${this.param}`}},le=class extends J{constructor(e){super(e),this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}},he=class extends J{constructor(e){super(e),this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){let t=this._padding+e;return t.slice(t.length-this.param)}},de=class extends J{constructor(e){super(e),this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){let t=this._padding+e,n=t.length-this.param-1;return t.slice(n,n+this.param)}};function Dt(r){if(r=r.trim(),r.length===0)throw new Error("empty shard string");if(!r.startsWith(fe))throw new Error(`invalid or no path prefix: ${r}`);let e=r.slice(fe.length).split("/"),t=e[0];if(t!=="v1")throw new Error(`expect 'v1' version, got '${t}'`);let n=e[1];if(e[2]==null||e[2]==="")throw new Error("missing param");let o=parseInt(e[2],10);switch(n){case"prefix":return new le(o);case"suffix":return new he(o);case"next-to-last":return new de(o);default:throw new Error(`unkown sharding function: ${n}`)}}var me=async(r,e)=>{let t=new x(r).child(new x(pe)),o=await(typeof e.getRaw=="function"?e.getRaw.bind(e):e.get.bind(e))(t);return Dt(new TextDecoder().decode(o??"").trim())};function Xr(r){return r[Symbol.asyncIterator]!=null}function Hr(r){if(Xr(r))return(async()=>{for await(let e of r);})();for(let e of r);}var G=Hr;function Qr(r){let[e,t]=r[Symbol.asyncIterator]!=null?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:o=>{n.push(o)},next:()=>n.length>0?{done:!1,value:n.shift()}:e.next(),[t](){return this}}}var ye=Qr;function Zr(r){return r[Symbol.asyncIterator]!=null}function qr(r,e){let t=0;if(Zr(r))return async function*(){for await(let l of r)await e(l,t++)&&(yield l)}();let n=ye(r),{value:o,done:s}=n.next();if(s===!0)return function*(){}();let i=e(o,t++);if(typeof i.then=="function")return async function*(){await i&&(yield o);for await(let l of n)await e(l,t++)&&(yield l)}();let a=e;return function*(){i===!0&&(yield o);for(let l of n)a(l,t++)&&(yield l)}()}var D=qr;function Yr(r){return r[Symbol.asyncIterator]!=null}function en(r){if(Yr(r))return(async()=>{let t=[];for await(let n of r)t.push(n);return t})();let e=[];for(let t of r)e.push(t);return e}var et=en;function tn(r){return r[Symbol.asyncIterator]!=null}function rn(r,e){return tn(r)?async function*(){yield*(await et(r)).sort(e)}():function*(){yield*et(r).sort(e)}()}var X=rn;function nn(r){return r[Symbol.asyncIterator]!=null}function on(r,e){return nn(r)?async function*(){let t=0;if(!(e<1)){for await(let n of r)if(yield n,t++,t===e)return}}():function*(){let t=0;if(!(e<1)){for(let n of r)if(yield n,t++,t===e)return}}()}var H=on;var v=class{put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:n,value:o}of e)await this.put(n,o,t),yield n}async*getMany(e,t={}){for await(let n of e)yield{key:n,value:await this.get(n,t)}}async*deleteMany(e,t={}){for await(let n of e)await this.delete(n,t),yield n}batch(){let e=[],t=[];return{put(n,o){e.push({key:n,value:o})},delete(n){t.push(n)},commit:async n=>{await G(this.putMany(e,n)),e=[],await G(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(e.prefix!=null){let o=e.prefix;n=D(n,s=>s.key.toString().startsWith(o))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((o,s)=>D(o,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((o,s)=>X(o,s),n)),e.offset!=null){let o=0,s=e.offset;n=D(n,()=>o++>=s)}return e.limit!=null&&(n=H(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(e.prefix!=null){let o=e.prefix;n=D(n,s=>s.toString().startsWith(o))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((o,s)=>D(o,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((o,s)=>X(o,s),n)),e.offset!=null){let o=e.offset,s=0;n=D(n,()=>s++>=o)}return e.limit!=null&&(n=H(n,e.limit)),n}};var be=class extends Error{constructor(e="Open failed"){super(e),this.name="OpenFailedError"}};var Q=class extends Error{constructor(e="Put failed"){super(e),this.name="PutFailedError"}};var Z=class extends Error{constructor(e="Delete failed"){super(e),this.name="DeleteFailedError"}};var L=class extends Error{constructor(e="Not Found"){super(e),this.name="NotFoundError"}};var ge=class extends v{data;constructor(){super(),this.data=new Map}put(e,t){return this.data.set(e.toString(),t),e}get(e){let t=this.data.get(e.toString());if(t==null)throw new L;return t}has(e){return this.data.has(e.toString())}delete(e){this.data.delete(e.toString())}*_all(){for(let[e,t]of this.data.entries())yield{key:new x(e),value:t}}*_allKeys(){for(let e of this.data.keys())yield new x(e)}};function sn(r){return r[Symbol.asyncIterator]!=null}function an(r,e){let t=0;if(sn(r))return async function*(){for await(let l of r)yield e(l,t++)}();let n=ye(r),{value:o,done:s}=n.next();if(s===!0)return function*(){}();let i=e(o,t++);if(typeof i.then=="function")return async function*(){yield await i;for await(let l of n)yield e(l,t++)}();let a=e;return function*(){yield i;for(let l of n)yield a(l,t++)}()}var M=an;function we(){let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r}var xe=class{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},q=class{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new xe(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new xe(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};var tt=class extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}};function K(r={}){return cn(t=>{let n=t.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},r)}function cn(r,e){e=e??{};let t=e.onEnd,n=new q,o,s,i,a=we(),l=async()=>{try{return n.isEmpty()?i?{done:!0}:await new Promise((u,m)=>{s=b=>{s=null,n.push(b);try{u(r(n))}catch(g){m(g)}return o}}):r(n)}finally{n.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=we()})}},N=u=>s!=null?s(u):(n.push(u),o),c=u=>(n=new q,s!=null?s({error:u}):(n.push({error:u}),o)),f=u=>{if(i)return o;if(e?.objectMode!==!0&&u?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return N({done:!1,value:u})},p=u=>i?o:(i=!0,u!=null?c(u):N({done:!0})),z=()=>(n=new q,p(),{done:!0}),d=u=>(p(u),{done:!0});if(o={[Symbol.asyncIterator](){return this},next:l,return:z,throw:d,push:f,end:p,get readableLength(){return n.size},onEmpty:async u=>{let m=u?.signal;if(m?.throwIfAborted(),n.isEmpty())return;let b,g;m!=null&&(b=new Promise((w,S)=>{g=()=>{S(new tt)},m.addEventListener("abort",g)}));try{await Promise.race([a.promise,b])}finally{g!=null&&m!=null&&m?.removeEventListener("abort",g)}}},t==null)return o;let h=o;return o={[Symbol.asyncIterator](){return this},next(){return h.next()},throw(u){return h.throw(u),t!=null&&(t(u),t=void 0),{done:!0}},return(){return h.return(),t!=null&&(t(),t=void 0),{done:!0}},push:f,end(u){return h.end(u),t!=null&&(t(u),t=void 0),o},get readableLength(){return h.readableLength},onEmpty:u=>h.onEmpty(u)},o}function un(r){return r[Symbol.asyncIterator]!=null}function fn(...r){let e=[];for(let t of r)un(t)||e.push(t);return e.length===r.length?function*(){for(let t of e)yield*t}():async function*(){let t=K({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(r.map(async n=>{for await(let o of n)t.push(o)})),t.end()}catch(n){t.end(n)}}),yield*t}()}var se=fn;function Ce(r,...e){if(r==null)throw new Error("Empty pipeline");if(rt(r)){let n=r;r=()=>n.source}else if(Nt(r)||Mt(r)){let n=r;r=()=>n}let t=[r,...e];if(t.length>1&&rt(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let n=1;n<t.length-1;n++)rt(t[n])&&(t[n]=hn(t[n]));return ln(...t)}var ln=(...r)=>{let e;for(;r.length>0;)e=r.shift()(e);return e},Mt=r=>r?.[Symbol.asyncIterator]!=null,Nt=r=>r?.[Symbol.iterator]!=null,rt=r=>r==null?!1:r.sink!=null&&r.source!=null,hn=r=>e=>{let t=r.sink(e);if(t?.then!=null){let n=K({objectMode:!0});t.then(()=>{n.end()},i=>{n.end(i)});let o,s=r.source;if(Mt(s))o=async function*(){yield*s,n.end()};else if(Nt(s))o=function*(){yield*s,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return se(n,o())}return r.source};var _=class extends v{child;transform;constructor(e,t){super(),this.child=e,this.transform=t}async put(e,t,n){return await this.child.put(this.transform.convert(e),t,n),e}async get(e,t){return this.child.get(this.transform.convert(e),t)}async has(e,t){return this.child.has(this.transform.convert(e),t)}async delete(e,t){await this.child.delete(this.transform.convert(e),t)}async*putMany(e,t={}){let n=this.transform,o=this.child;yield*Ce(e,async function*(s){yield*M(s,({key:i,value:a})=>({key:n.convert(i),value:a}))},async function*(s){yield*o.putMany(s,t)},async function*(s){yield*M(s,i=>n.invert(i))})}async*getMany(e,t={}){let n=this.transform,o=this.child;yield*Ce(e,async function*(s){yield*M(s,i=>n.convert(i))},async function*(s){yield*o.getMany(s,t)},async function*(s){yield*M(s,({key:i,value:a})=>({key:n.invert(i),value:a}))})}async*deleteMany(e,t={}){let n=this.transform,o=this.child;yield*Ce(e,async function*(s){yield*M(s,i=>n.convert(i))},async function*(s){yield*o.deleteMany(s,t)},async function*(s){yield*M(s,i=>n.invert(i))})}batch(){let e=this.child.batch();return{put:(t,n)=>{e.put(this.transform.convert(t),n)},delete:t=>{e.delete(this.transform.convert(t))},commit:async t=>{await e.commit(t)}}}query(e,t){let n={...e};n.filters=(n.filters??[]).map(s=>({key:i,value:a})=>s({key:this.transform.convert(i),value:a}));let{prefix:o}=e;return o!=null&&o!=="/"&&(delete n.prefix,n.filters.push(({key:s})=>this.transform.invert(s).toString().startsWith(o))),n.orders!=null&&(n.orders=n.orders.map(s=>(i,a)=>s({key:this.transform.invert(i.key),value:i.value},{key:this.transform.invert(a.key),value:a.value}))),M(this.child.query(n,t),({key:s,value:i})=>({key:this.transform.invert(s),value:i}))}queryKeys(e,t){let n={...e};n.filters=(n.filters??[]).map(s=>i=>s(this.transform.convert(i)));let{prefix:o}=e;return o!=null&&o!=="/"&&(delete n.prefix,n.filters.push(s=>this.transform.invert(s).toString().startsWith(o))),n.orders!=null&&(n.orders=n.orders.map(s=>(i,a)=>s(this.transform.invert(i),this.transform.invert(a)))),M(this.child.queryKeys(n,t),s=>this.transform.invert(s))}};var Y=new x(pe),ve=class r extends v{child;shard;constructor(e,t){super(),this.child=new _(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=t}async open(){this.shard=await r.create(this.child,this.shard)}_convertKey(e){let t=e.toString();return t===Y.toString()?e:new x(this.shard.fun(t)).child(e)}_invertKey(e){return e.toString()===Y.toString()?e:x.withNamespaces(e.list().slice(1))}static async create(e,t){if(!await e.has(Y)){if(t==null)throw new be("Shard is required when datastore doesn't have a shard key already");await e.put(Y,new TextEncoder().encode(t.toString()+`
-`))}t==null&&(t=await me("/",e));let o=await me("/",e),s=o.toString(),i=t.toString();if(s!==i)throw new Error(`specified fun ${i} does not match repo shard fun ${s}`);return o}async put(e,t,n){return await this.child.put(e,t,n),e}async get(e,t){return this.child.get(e,t)}async has(e,t){return this.child.has(e,t)}async delete(e,t){await this.child.delete(e,t)}async*putMany(e,t={}){yield*this.child.putMany(e,t)}async*getMany(e,t={}){yield*this.child.getMany(e,t)}async*deleteMany(e,t={}){yield*this.child.deleteMany(e,t)}batch(){return this.child.batch()}query(e,t){let o={...e,filters:[({key:s})=>s.toString()!==Y.toString()].concat(e.filters??[])};return this.child.query(o,t)}queryKeys(e,t){let o={...e,filters:[s=>s.toString()!==Y.toString()].concat(e.filters??[])};return this.child.queryKeys(o,t)}};var Se=class extends v{mounts;constructor(e){super(),this.mounts=e.slice()}_lookup(e){for(let t of this.mounts)if(t.prefix.toString()===e.toString()||t.prefix.isAncestorOf(e))return{datastore:t.datastore,mountpoint:t.prefix}}async put(e,t,n){let o=this._lookup(e);if(o==null)throw new Q("No datastore mounted for this key");return await o.datastore.put(e,t,n),e}async get(e,t={}){let n=this._lookup(e);if(n==null)throw new L("No datastore mounted for this key");return n.datastore.get(e,t)}async has(e,t){let n=this._lookup(e);return n==null?Promise.resolve(!1):n.datastore.has(e,t)}async delete(e,t){let n=this._lookup(e);if(n==null)throw new Z("No datastore mounted for this key");await n.datastore.delete(e,t)}batch(){let e={},t=n=>{let o=this._lookup(n);if(o==null)throw new Error("No datastore mounted for this key");let s=o.mountpoint.toString();return e[s]==null&&(e[s]=o.datastore.batch()),{batch:e[s]}};return{put:(n,o)=>{t(n).batch.put(n,o)},delete:n=>{t(n).batch.delete(n)},commit:async n=>{await Promise.all(Object.keys(e).map(async o=>{await e[o].commit(n)}))}}}query(e,t){let n=this.mounts.map(s=>s.datastore.query({prefix:e.prefix,filters:e.filters},t)),o=se(...n);if(e.filters!=null&&e.filters.forEach(s=>{o=D(o,s)}),e.orders!=null&&e.orders.forEach(s=>{o=X(o,s)}),e.offset!=null){let s=0,i=e.offset;o=D(o,()=>s++>=i)}return e.limit!=null&&(o=H(o,e.limit)),o}queryKeys(e,t){let n=this.mounts.map(s=>s.datastore.queryKeys({prefix:e.prefix,filters:e.filters},t)),o=se(...n);if(e.filters!=null&&e.filters.forEach(s=>{o=D(o,s)}),e.orders!=null&&e.orders.forEach(s=>{o=X(o,s)}),e.offset!=null){let s=0,i=e.offset;o=D(o,()=>s++>=i)}return e.limit!=null&&(o=H(o,e.limit)),o}};function dn(r,e){try{if(typeof r=="string"&&r.length>0)return pn(r);if(typeof r=="number"&&isFinite(r))return e?.long?yn(r):mn(r);throw new Error("Value is not a string or number.")}catch(t){let n=bn(t)?`${t.message}. value=${JSON.stringify(r)}`:"An unknown error has occured.";throw new Error(n)}}function pn(r){if(r=String(r),r.length>100)throw new Error("Value exceeds the maximum length of 100 characters.");let e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!e)return NaN;let t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*315576e5;case"weeks":case"week":case"w":return t*6048e5;case"days":case"day":case"d":return t*864e5;case"hours":case"hour":case"hrs":case"hr":case"h":return t*36e5;case"minutes":case"minute":case"mins":case"min":case"m":return t*6e4;case"seconds":case"second":case"secs":case"sec":case"s":return t*1e3;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:throw new Error(`The unit ${n} was matched, but no matching case exists.`)}}var Fe=dn;function mn(r){let e=Math.abs(r);return e>=864e5?`${Math.round(r/864e5)}d`:e>=36e5?`${Math.round(r/36e5)}h`:e>=6e4?`${Math.round(r/6e4)}m`:e>=1e3?`${Math.round(r/1e3)}s`:`${r}ms`}function yn(r){let e=Math.abs(r);return e>=864e5?Ee(r,e,864e5,"day"):e>=36e5?Ee(r,e,36e5,"hour"):e>=6e4?Ee(r,e,6e4,"minute"):e>=1e3?Ee(r,e,1e3,"second"):`${r} ms`}function Ee(r,e,t,n){let o=e>=t*1.5;return`${Math.round(r/t)} ${n}${o?"s":""}`}function bn(r){return typeof r=="object"&&r!==null&&"message"in r}function nt(r){t.debug=t,t.default=t,t.coerce=l,t.disable=s,t.enable=o,t.enabled=i,t.humanize=Fe,t.destroy=N,Object.keys(r).forEach(c=>{t[c]=r[c]}),t.names=[],t.skips=[],t.formatters={};function e(c){let f=0;for(let p=0;p<c.length;p++)f=(f<<5)-f+c.charCodeAt(p),f|=0;return t.colors[Math.abs(f)%t.colors.length]}t.selectColor=e;function t(c){let f,p=null,z,d;function h(...u){if(!h.enabled)return;let m=h,b=Number(new Date),g=b-(f||b);m.diff=g,m.prev=f,m.curr=b,f=b,u[0]=t.coerce(u[0]),typeof u[0]!="string"&&u.unshift("%O");let w=0;u[0]=u[0].replace(/%([a-zA-Z%])/g,(A,E)=>{if(A==="%%")return"%";w++;let k=t.formatters[E];if(typeof k=="function"){let j=u[w];A=k.call(m,j),u.splice(w,1),w--}return A}),t.formatArgs.call(m,u),(m.log||t.log).apply(m,u)}return h.namespace=c,h.useColors=t.useColors(),h.color=t.selectColor(c),h.extend=n,h.destroy=t.destroy,Object.defineProperty(h,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(z!==t.namespaces&&(z=t.namespaces,d=t.enabled(c)),d),set:u=>{p=u}}),typeof t.init=="function"&&t.init(h),h}function n(c,f){let p=t(this.namespace+(typeof f>"u"?":":f)+c);return p.log=this.log,p}function o(c){t.save(c),t.namespaces=c,t.names=[],t.skips=[];let f,p=(typeof c=="string"?c:"").split(/[\s,]+/),z=p.length;for(f=0;f<z;f++)p[f]&&(c=p[f].replace(/\*/g,".*?"),c[0]==="-"?t.skips.push(new RegExp("^"+c.substr(1)+"$")):t.names.push(new RegExp("^"+c+"$")))}function s(){let c=[...t.names.map(a),...t.skips.map(a).map(f=>"-"+f)].join(",");return t.enable(""),c}function i(c){if(c[c.length-1]==="*")return!0;let f,p;for(f=0,p=t.skips.length;f<p;f++)if(t.skips[f].test(c))return!1;for(f=0,p=t.names.length;f<p;f++)if(t.names[f].test(c))return!0;return!1}function a(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function l(c){return c instanceof Error?c.stack??c.message:c}function N(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.setupFormatters(t.formatters),t.enable(t.load()),t}var Ae=En(),gn=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function wn(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/(edge|trident)\/(\d+)/)!=null?!1:typeof document<"u"&&document.documentElement?.style?.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/firefox\/(\d+)/)!=null&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/applewebkit\/(\d+)/)}function xn(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+Fe(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(n=t))}),r.splice(n,0,e)}var Cn=console.debug??console.log??(()=>{});function vn(r){try{r?Ae?.setItem("debug",r):Ae?.removeItem("debug")}catch{}}function Sn(){let r;try{r=Ae?.getItem("debug")}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=process.env.DEBUG),r}function En(){try{return localStorage}catch{}}function Fn(r){r.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}var Ut=nt({formatArgs:xn,save:vn,load:Sn,useColors:wn,setupFormatters:Fn,colors:gn,storage:Ae,log:Cn});var F=Ut;F.formatters.b=r=>r==null?"undefined":I.baseEncode(r);F.formatters.t=r=>r==null?"undefined":P.baseEncode(r);F.formatters.m=r=>r==null?"undefined":je.baseEncode(r);F.formatters.p=r=>r==null?"undefined":r.toString();F.formatters.c=r=>r==null?"undefined":r.toString();F.formatters.k=r=>r==null?"undefined":r.toString();F.formatters.a=r=>r==null?"undefined":r.toString();function An(r){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=r,e.destroy=()=>!0,e.extend=()=>e,e}function $t(r){let e=An(`${r}:trace`);return F.enabled(`${r}:trace`)&&F.names.map(t=>t.toString()).find(t=>t.includes(":trace"))!=null&&(e=F(`${r}:trace`)),Object.assign(F(r),{error:F(`${r}:error`),trace:e})}var kn=$t("datastore:core:tiered"),ke=class extends v{stores;constructor(e){super(),this.stores=e.slice()}async put(e,t,n){try{return await Promise.all(this.stores.map(async o=>{await o.put(e,t,n)})),e}catch(o){throw new Q(o.message)}}async get(e,t){for(let n of this.stores)try{let o=await n.get(e,t);if(o!=null)return o}catch(o){kn.error(o)}throw new L}async has(e,t){for(let n of this.stores)if(await n.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map(async n=>{await n.delete(e,t)}))}catch(n){throw new Z(n.message)}}async*putMany(e,t={}){let n,o=this.stores.map(s=>{let i=K({objectMode:!0});return G(s.putMany(i,t)).catch(a=>{n=a}),i});try{for await(let s of e){if(n!=null)throw n;o.forEach(i=>i.push(s)),yield s.key}}finally{o.forEach(s=>s.end())}}async*deleteMany(e,t={}){let n,o=this.stores.map(s=>{let i=K({objectMode:!0});return G(s.deleteMany(i,t)).catch(a=>{n=a}),i});try{for await(let s of e){if(n!=null)throw n;o.forEach(i=>i.push(s)),yield s}}finally{o.forEach(s=>s.end())}}batch(){let e=this.stores.map(t=>t.batch());return{put:(t,n)=>{e.forEach(o=>{o.put(t,n)})},delete:t=>{e.forEach(n=>{n.delete(t)})},commit:async t=>{for(let n of e)await n.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}};var Ie=class extends _{iChild;iKey;constructor(e,t){super(e,{convert(n){return t.child(n)},invert(n){if(t.toString()==="/")return n;if(!t.isAncestorOf(n))throw new Error(`Expected prefix: (${t.toString()}) in key: ${n.toString()}`);return new x(n.toString().slice(t.toString().length),!1)}}),this.iChild=e,this.iKey=t}query(e,t){let n={...e};n.filters=(n.filters??[]).map(s=>({key:i,value:a})=>s({key:this.transform.invert(i),value:a}));let{prefix:o}=e;return o!=null&&o!=="/"&&(delete n.prefix,n.filters.push(({key:s})=>this.transform.invert(s).toString().startsWith(o))),n.orders!=null&&(n.orders=n.orders.map(s=>(i,a)=>s({key:this.transform.invert(i.key),value:i.value},{key:this.transform.invert(a.key),value:a.value}))),n.filters.unshift(({key:s})=>this.iKey.isAncestorOf(s)),M(this.iChild.query(n,t),({key:s,value:i})=>({key:this.transform.invert(s),value:i}))}queryKeys(e,t){let n={...e};n.filters=(n.filters??[]).map(s=>i=>s(this.transform.invert(i)));let{prefix:o}=e;return o!=null&&o!=="/"&&(delete n.prefix,n.filters.push(s=>this.transform.invert(s).toString().startsWith(o))),n.orders!=null&&(n.orders=n.orders.map(s=>(i,a)=>s(this.transform.invert(i),this.transform.invert(a)))),n.filters.unshift(s=>this.iKey.isAncestorOf(s)),M(this.iChild.queryKeys(n,t),s=>this.transform.invert(s))}};return _t(In);})();
+"use strict";var DatastoreCore=(()=>{var Ne=Object.defineProperty;var Pt=Object.getOwnPropertyDescriptor;var _t=Object.getOwnPropertyNames;var Kt=Object.prototype.hasOwnProperty;var C=(r,e)=>{for(var t in e)Ne(r,t,{get:e[t],enumerable:!0})},jt=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of _t(e))!Kt.call(r,o)&&o!==t&&Ne(r,o,{get:()=>e[o],enumerable:!(n=Pt(e,o))||n.enumerable});return r};var Bt=r=>jt(Ne({},"__esModule",{value:!0}),r);var Tn={};C(Tn,{BaseDatastore:()=>v,KeyTransformDatastore:()=>P,MemoryDatastore:()=>be,MountDatastore:()=>ve,NamespaceDatastore:()=>Ie,ShardingDatastore:()=>Ce,TieredDatastore:()=>Fe,shard:()=>Ze});var Ze={};C(Ze,{NextToLast:()=>le,PREFIX:()=>ae,Prefix:()=>ce,SHARDING_FN:()=>fe,ShardBase:()=>J,Suffix:()=>ue,parseShardFun:()=>Dt,readShardFun:()=>de});var Ue={};C(Ue,{base10:()=>Xt});var Pn=new Uint8Array(0);function st(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}function R(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function it(r){return new TextEncoder().encode(r)}function at(r){return new TextDecoder().decode(r)}function Vt(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<r.length;o++){var s=r.charAt(o),i=s.charCodeAt(0);if(t[i]!==255)throw new TypeError(s+" is ambiguous");t[i]=o}var a=r.length,d=r.charAt(0),E=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var f=0,c=0,m=0,b=h.length;m!==b&&h[m]===0;)m++,f++;for(var w=(b-m)*u+1>>>0,g=new Uint8Array(w);m!==b;){for(var A=h[m],I=0,F=w-1;(A!==0||I<c)&&F!==-1;F--,I++)A+=256*g[F]>>>0,g[F]=A%a>>>0,A=A/a>>>0;if(A!==0)throw new Error("Non-zero carry");c=I,m++}for(var N=w-c;N!==w&&g[N]===0;)N++;for(var K=d.repeat(f);N<w;++N)K+=r.charAt(g[N]);return K}function p(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var f=0;if(h[f]!==" "){for(var c=0,m=0;h[f]===d;)c++,f++;for(var b=(h.length-f)*E+1>>>0,w=new Uint8Array(b);h[f];){var g=t[h.charCodeAt(f)];if(g===255)return;for(var A=0,I=b-1;(g!==0||A<m)&&I!==-1;I--,A++)g+=a*w[I]>>>0,w[I]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");m=A,f++}if(h[f]!==" "){for(var F=b-m;F!==b&&w[F]===0;)F++;for(var N=new Uint8Array(c+(b-F)),K=c;F!==b;)N[K++]=w[F++];return N}}}function L(h){var f=p(h);if(f)return f;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:p,decode:L}}var Wt=Vt,Jt=Wt,ut=Jt;var ke=class{name;prefix;baseEncode;constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},De=class{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,n){this.name=e,this.prefix=t;let o=t.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return lt(this,e)}},Me=class{decoders;constructor(e){this.decoders=e}or(e){return lt(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function lt(r,e){return new Me({...r.decoders??{[r.prefix]:r},...e.decoders??{[e.prefix]:e}})}var Re=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,n,o){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=o,this.encoder=new ke(e,t,n),this.decoder=new De(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function j({name:r,prefix:e,encode:t,decode:n}){return new Re(r,e,t,n)}function O({name:r,prefix:e,alphabet:t}){let{encode:n,decode:o}=ut(t,r);return j({prefix:e,name:r,encode:n,decode:s=>R(o(s))})}function Gt(r,e,t,n){let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*t/8|0),i=0,a=0,d=0;for(let E=0;E<o;++E){let u=e[r[E]];if(u===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<t|u,i+=t,i>=8&&(i-=8,s[d++]=255&a>>i)}if(i>=t||(255&a<<8-i)!==0)throw new SyntaxError("Unexpected end of data");return s}function Ht(r,e,t){let n=e[e.length-1]==="=",o=(1<<t)-1,s="",i=0,a=0;for(let d=0;d<r.length;++d)for(a=a<<8|r[d],i+=8;i>t;)i-=t,s+=e[o&a>>i];if(i!==0&&(s+=e[o&a<<t-i]),n)for(;(s.length*t&7)!==0;)s+="=";return s}function qt(r){let e={};for(let t=0;t<r.length;++t)e[r[t]]=t;return e}function y({name:r,prefix:e,bitsPerChar:t,alphabet:n}){let o=qt(n);return j({prefix:e,name:r,encode(s){return Ht(s,n,t)},decode(s){return Gt(s,o,t,r)}})}var Xt=O({prefix:"9",name:"base10",alphabet:"0123456789"});var $e={};C($e,{base16:()=>Qt,base16upper:()=>Zt});var Qt=y({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Zt=y({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Le={};C(Le,{base2:()=>Yt});var Yt=y({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Oe={};C(Oe,{base256emoji:()=>or});var ft=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),er=ft.reduce((r,e,t)=>(r[t]=e,r),[]),tr=ft.reduce((r,e,t)=>{let n=e.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${e}`);return r[n]=t,r},[]);function rr(r){return r.reduce((e,t)=>(e+=er[t],e),"")}function nr(r){let e=[];for(let t of r){let n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);let o=tr[n];if(o==null)throw new Error(`Non-base256emoji character: ${t}`);e.push(o)}return new Uint8Array(e)}var or=j({prefix:"\u{1F680}",name:"base256emoji",encode:rr,decode:nr});var Te={};C(Te,{base32:()=>T,base32hex:()=>cr,base32hexpad:()=>lr,base32hexpadupper:()=>fr,base32hexupper:()=>ur,base32pad:()=>ir,base32padupper:()=>ar,base32upper:()=>sr,base32z:()=>dr});var T=y({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),sr=y({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ir=y({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ar=y({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),cr=y({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ur=y({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),lr=y({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fr=y({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),dr=y({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ze={};C(ze,{base36:()=>Q,base36upper:()=>hr});var Q=O({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),hr=O({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Pe={};C(Pe,{base58btc:()=>k,base58flickr:()=>pr});var k=O({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),pr=O({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ke={};C(Ke,{base64:()=>_e,base64pad:()=>mr,base64url:()=>yr,base64urlpad:()=>br});var _e=y({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),mr=y({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),yr=y({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),br=y({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var je={};C(je,{base8:()=>wr});var wr=y({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Be={};C(Be,{identity:()=>gr});var gr=j({prefix:"\0",name:"identity",encode:r=>at(r),decode:r=>it(r)});var to=new TextEncoder,ro=new TextDecoder;var We={};C(We,{identity:()=>jr});var vr=pt,dt=128,Sr=127,Er=~Sr,Ar=Math.pow(2,31);function pt(r,e,t){e=e||[],t=t||0;for(var n=t;r>=Ar;)e[t++]=r&255|dt,r/=128;for(;r&Er;)e[t++]=r&255|dt,r>>>=7;return e[t]=r|0,pt.bytes=t-n+1,e}var Fr=Ve,Ir=128,ht=127;function Ve(r,n){var t=0,n=n||0,o=0,s=n,i,a=r.length;do{if(s>=a)throw Ve.bytes=0,new RangeError("Could not decode varint");i=r[s++],t+=o<28?(i&ht)<<o:(i&ht)*Math.pow(2,o),o+=7}while(i>=Ir);return Ve.bytes=s-n,t}var Nr=Math.pow(2,7),kr=Math.pow(2,14),Dr=Math.pow(2,21),Mr=Math.pow(2,28),Rr=Math.pow(2,35),Ur=Math.pow(2,42),$r=Math.pow(2,49),Lr=Math.pow(2,56),Or=Math.pow(2,63),Tr=function(r){return r<Nr?1:r<kr?2:r<Dr?3:r<Mr?4:r<Rr?5:r<Ur?6:r<$r?7:r<Lr?8:r<Or?9:10},zr={encode:vr,decode:Fr,encodingLength:Tr},Pr=zr,Z=Pr;function Y(r,e=0){return[Z.decode(r,e),Z.decode.bytes]}function B(r,e,t=0){return Z.encode(r,e,t),e}function V(r){return Z.encodingLength(r)}function _(r,e){let t=e.byteLength,n=V(r),o=n+V(t),s=new Uint8Array(o+t);return B(r,s,0),B(t,s,n),s.set(e,o),new W(r,t,e,s)}function mt(r){let e=R(r),[t,n]=Y(e),[o,s]=Y(e.subarray(n)),i=e.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new W(t,o,i,e)}function yt(r,e){if(r===e)return!0;{let t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&st(r.bytes,t.bytes)}}var W=class{code;size;digest;bytes;constructor(e,t,n,o){this.code=e,this.size=t,this.digest=n,this.bytes=o}};var bt=0,_r="identity",wt=R;function Kr(r){return _(bt,wt(r))}var jr={code:bt,name:_r,encode:wt,digest:Kr};var He={};C(He,{sha256:()=>Br,sha512:()=>Vr});function Ge({name:r,code:e,encode:t}){return new Je(r,e,t)}var Je=class{name;code;encode;constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?_(this.code,t):t.then(n=>_(this.code,n))}else throw Error("Unknown type, must be binary type")}};function xt(r){return async e=>new Uint8Array(await crypto.subtle.digest(r,e))}var Br=Ge({name:"sha2-256",code:18,encode:xt("SHA-256")}),Vr=Ge({name:"sha2-512",code:19,encode:xt("SHA-512")});function Ct(r,e){let{bytes:t,version:n}=r;switch(n){case 0:return Jr(t,qe(r),e??k.encoder);default:return Gr(t,qe(r),e??T.encoder)}}var vt=new WeakMap;function qe(r){let e=vt.get(r);if(e==null){let t=new Map;return vt.set(r,t),t}return e}var oe=class r{code;version;multihash;bytes;"/";constructor(e,t,n,o){this.code=t,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:t}=this;if(e!==te)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Hr)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=_(e,t);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return r.equals(this,e)}static equals(e,t){let n=t;return n!=null&&e.code===n.code&&e.version===n.version&&yt(e.multihash,n.multihash)}toString(e){return Ct(this,e)}toJSON(){return{"/":Ct(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let t=e;if(t instanceof r)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){let{version:n,code:o,multihash:s,bytes:i}=t;return new r(n,o,s,i??St(n,o,s.bytes))}else if(t[qr]===!0){let{version:n,multihash:o,code:s}=t,i=mt(o);return r.create(n,s,i)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==te)throw new Error(`Version 0 CID must use dag-pb (code: ${te}) block encoding`);return new r(e,t,n,n.bytes)}case 1:{let o=St(e,t,n.bytes);return new r(e,t,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return r.create(0,te,e)}static createV1(e,t){return r.create(1,e,t)}static decode(e){let[t,n]=r.decodeFirst(e);if(n.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=r.inspectBytes(e),n=t.size-t.multihashSize,o=R(e.subarray(n,n+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");let s=o.subarray(t.multihashSize-t.digestSize),i=new W(t.multihashCode,t.digestSize,s,o);return[t.version===0?r.createV0(i):r.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[l,p]=Y(e.subarray(t));return t+=p,l},o=n(),s=te;if(o===18?(o=0,t=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=t,a=n(),d=n(),E=t+d,u=E-i;return{version:o,codec:s,multihashCode:a,digestSize:d,multihashSize:u,size:E}}static parse(e,t){let[n,o]=Wr(e,t),s=r.decode(o);if(s.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return qe(s).set(n,e),s}};function Wr(r,e){switch(r[0]){case"Q":{let t=e??k;return[k.prefix,t.decode(`${k.prefix}${r}`)]}case k.prefix:{let t=e??k;return[k.prefix,t.decode(r)]}case T.prefix:{let t=e??T;return[T.prefix,t.decode(r)]}case Q.prefix:{let t=e??Q;return[Q.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}}function Jr(r,e,t){let{prefix:n}=t;if(n!==k.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let o=e.get(n);if(o==null){let s=t.encode(r).slice(1);return e.set(n,s),s}else return o}function Gr(r,e,t){let{prefix:n}=t,o=e.get(n);if(o==null){let s=t.encode(r);return e.set(n,s),s}else return o}var te=112,Hr=18;function St(r,e,t){let n=V(r),o=n+V(e),s=new Uint8Array(o+t.byteLength);return B(r,s,0),B(e,s,n),s.set(t,o),s}var qr=Symbol.for("@ipld/js-cid/CID");var Xe={...Be,...Le,...je,...Ue,...$e,...Te,...ze,...Pe,...Ke,...Oe},Ao={...He,...We};function Et(r=0){return new Uint8Array(r)}function Ft(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}var At=Ft("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Qe=Ft("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=Et(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Xr={utf8:At,"utf-8":At,hex:Xe.base16,latin1:Qe,ascii:Qe,binary:Qe,...Xe},se=Xr;function It(r,e="utf8"){let t=se[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return t.decoder.decode(`${t.prefix}${r}`)}function Nt(r,e="utf8"){let t=se[e];if(t==null)throw new Error(`Unsupported encoding "${e}"`);return t.encoder.encode(r).substring(1)}var U="/",kt=new TextEncoder().encode(U),ie=kt[0],x=class r{_buf;constructor(e,t){if(typeof e=="string")this._buf=It(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==ie)throw new Error("Invalid key")}toString(e="utf8"){return Nt(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new r(e.join(U))}static random(){return new r(Math.random().toString().substring(2))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new r(e):typeof e.uint8Array=="function"?new r(e.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=kt),this._buf[0]!==ie){let e=new Uint8Array(this._buf.byteLength+1);e.fill(ie,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===ie;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let o=0;o<t.length;o++){if(n.length<o+1)return!1;let s=t[o],i=n[o];if(s<i)return!0;if(s>i)return!1}return t.length<n.length}reverse(){return r.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(U).slice(1)}type(){return Qr(this.baseNamespace())}name(){return Zr(this.baseNamespace())}instance(e){return new r(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(U)||(e+=U),e+=this.type(),new r(e)}parent(){let e=this.list();return e.length===1?new r(U):new r(e.slice(0,-1).join(U))}child(e){return this.toString()===U?e:e.toString()===U?this:new r(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return r.withNamespaces([...this.namespaces(),...Yr(e.map(t=>t.namespaces()))])}};function Qr(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function Zr(r){let e=r.split(":");return e[e.length-1]}function Yr(r){return[].concat(...r)}var ae="/repo/flatfs/shard/",fe="SHARDING",J=class{param;name;_padding;constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${ae}v1/${this.name}/${this.param}`}},ce=class extends J{constructor(e){super(e),this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}},ue=class extends J{constructor(e){super(e),this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){let t=this._padding+e;return t.slice(t.length-this.param)}},le=class extends J{constructor(e){super(e),this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){let t=this._padding+e,n=t.length-this.param-1;return t.slice(n,n+this.param)}};function Dt(r){if(r=r.trim(),r.length===0)throw new Error("empty shard string");if(!r.startsWith(ae))throw new Error(`invalid or no path prefix: ${r}`);let e=r.slice(ae.length).split("/"),t=e[0];if(t!=="v1")throw new Error(`expect 'v1' version, got '${t}'`);let n=e[1];if(e[2]==null||e[2]==="")throw new Error("missing param");let o=parseInt(e[2],10);switch(n){case"prefix":return new ce(o);case"suffix":return new ue(o);case"next-to-last":return new le(o);default:throw new Error(`unkown sharding function: ${n}`)}}var de=async(r,e)=>{let t=new x(r).child(new x(fe)),o=await(typeof e.getRaw=="function"?e.getRaw.bind(e):e.get.bind(e))(t);return Dt(new TextDecoder().decode(o??"").trim())};function en(r){return r[Symbol.asyncIterator]!=null}function tn(r){if(en(r))return(async()=>{for await(let e of r);})();for(let e of r);}var Ye=tn;function rn(r){let[e,t]=r[Symbol.asyncIterator]!=null?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:o=>{n.push(o)},next:()=>n.length>0?{done:!1,value:n.shift()}:e.next(),[t](){return this}}}var he=rn;function nn(r){return r[Symbol.asyncIterator]!=null}function on(r,e){let t=0;if(nn(r))return async function*(){for await(let d of r)await e(d,t++)&&(yield d)}();let n=he(r),{value:o,done:s}=n.next();if(s===!0)return function*(){}();let i=e(o,t++);if(typeof i.then=="function")return async function*(){await i&&(yield o);for await(let d of n)await e(d,t++)&&(yield d)}();let a=e;return function*(){i===!0&&(yield o);for(let d of n)a(d,t++)&&(yield d)}()}var D=on;function sn(r){return r[Symbol.asyncIterator]!=null}function an(r){if(sn(r))return(async()=>{let t=[];for await(let n of r)t.push(n);return t})();let e=[];for(let t of r)e.push(t);return e}var et=an;function cn(r){return r[Symbol.asyncIterator]!=null}function un(r,e){return cn(r)?async function*(){yield*(await et(r)).sort(e)}():function*(){yield*et(r).sort(e)}()}var G=un;function ln(r){return r[Symbol.asyncIterator]!=null}function fn(r,e){return ln(r)?async function*(){let t=0;if(!(e<1)){for await(let n of r)if(yield n,t++,t===e)return}}():function*(){let t=0;if(!(e<1)){for(let n of r)if(yield n,t++,t===e)return}}()}var H=fn;var v=class{put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:n,value:o}of e)await this.put(n,o,t),yield n}async*getMany(e,t={}){for await(let n of e)yield{key:n,value:await this.get(n,t)}}async*deleteMany(e,t={}){for await(let n of e)await this.delete(n,t),yield n}batch(){let e=[],t=[];return{put(n,o){e.push({key:n,value:o})},delete(n){t.push(n)},commit:async n=>{await Ye(this.putMany(e,n)),e=[],await Ye(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(e.prefix!=null){let o=e.prefix;n=D(n,s=>s.key.toString().startsWith(o))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((o,s)=>D(o,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((o,s)=>G(o,s),n)),e.offset!=null){let o=0,s=e.offset;n=D(n,()=>o++>=s)}return e.limit!=null&&(n=H(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(e.prefix!=null){let o=e.prefix;n=D(n,s=>s.toString().startsWith(o))}if(Array.isArray(e.filters)&&(n=e.filters.reduce((o,s)=>D(o,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((o,s)=>G(o,s),n)),e.offset!=null){let o=e.offset,s=0;n=D(n,()=>s++>=o)}return e.limit!=null&&(n=H(n,e.limit)),n}};var pe=class r extends Error{static name="OpenFailedError";static code="ERR_OPEN_FAILED";name=r.name;code=r.code;constructor(e="Open failed"){super(e)}};var me=class r extends Error{static name="PutFailedError";static code="ERR_PUT_FAILED";name=r.name;code=r.code;constructor(e="Put failed"){super(e)}};var ye=class r extends Error{static name="DeleteFailedError";static code="ERR_DELETE_FAILED";name=r.name;code=r.code;constructor(e="Delete failed"){super(e)}};var z=class r extends Error{static name="NotFoundError";static code="ERR_NOT_FOUND";name=r.name;code=r.code;constructor(e="Not Found"){super(e)}};var be=class extends v{data;constructor(){super(),this.data=new Map}put(e,t,n){return n?.signal?.throwIfAborted(),this.data.set(e.toString(),t),e}get(e,t){t?.signal?.throwIfAborted();let n=this.data.get(e.toString());if(n==null)throw new z;return n}has(e,t){return t?.signal?.throwIfAborted(),this.data.has(e.toString())}delete(e,t){t?.signal?.throwIfAborted(),this.data.delete(e.toString())}*_all(e,t){t?.signal?.throwIfAborted();for(let[n,o]of this.data.entries())yield{key:new x(n),value:o},t?.signal?.throwIfAborted()}*_allKeys(e,t){t?.signal?.throwIfAborted();for(let n of this.data.keys())yield new x(n),t?.signal?.throwIfAborted()}};function dn(r){return r[Symbol.asyncIterator]!=null}function hn(r,e){let t=0;if(dn(r))return async function*(){for await(let d of r)yield e(d,t++)}();let n=he(r),{value:o,done:s}=n.next();if(s===!0)return function*(){}();let i=e(o,t++);if(typeof i.then=="function")return async function*(){yield await i;for await(let d of n)yield e(d,t++)}();let a=e;return function*(){yield i;for(let d of n)yield a(d,t++)}()}var M=hn;function $(){let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r}var we=class{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},q=class{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new we(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let t=this.head;this.head=t.next=new we(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};var tt=class extends Error{type;code;constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}};function Mt(r={}){return pn(t=>{let n=t.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},r)}function pn(r,e){e=e??{};let t=e.onEnd,n=new q,o,s,i,a=$(),d=async()=>{try{return n.isEmpty()?i?{done:!0}:await new Promise((c,m)=>{s=b=>{s=null,n.push(b);try{c(r(n))}catch(w){m(w)}return o}}):r(n)}finally{n.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=$()})}},E=c=>s!=null?s(c):(n.push(c),o),u=c=>(n=new q,s!=null?s({error:c}):(n.push({error:c}),o)),l=c=>{if(i)return o;if(e?.objectMode!==!0&&c?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return E({done:!1,value:c})},p=c=>i?o:(i=!0,c!=null?u(c):E({done:!0})),L=()=>(n=new q,p(),{done:!0}),h=c=>(p(c),{done:!0});if(o={[Symbol.asyncIterator](){return this},next:d,return:L,throw:h,push:l,end:p,get readableLength(){return n.size},onEmpty:async c=>{let m=c?.signal;if(m?.throwIfAborted(),n.isEmpty())return;let b,w;m!=null&&(b=new Promise((g,A)=>{w=()=>{A(new tt)},m.addEventListener("abort",w)}));try{await Promise.race([a.promise,b])}finally{w!=null&&m!=null&&m?.removeEventListener("abort",w)}}},t==null)return o;let f=o;return o={[Symbol.asyncIterator](){return this},next(){return f.next()},throw(c){return f.throw(c),t!=null&&(t(c),t=void 0),{done:!0}},return(){return f.return(),t!=null&&(t(),t=void 0),{done:!0}},push:l,end(c){return f.end(c),t!=null&&(t(c),t=void 0),o},get readableLength(){return f.readableLength},onEmpty:c=>f.onEmpty(c)},o}var ge=class extends Error{type;code;constructor(e,t,n){super(e??"The operation was aborted"),this.type="aborted",this.name=n??"AbortError",this.code=t??"ABORT_ERR"}};async function Rt(r,e,t){if(e==null)return r;if(e.aborted)return r.catch(()=>{}),Promise.reject(new ge(t?.errorMessage,t?.errorCode,t?.errorName));let n,o=new ge(t?.errorMessage,t?.errorCode,t?.errorName);try{return await Promise.race([r,new Promise((s,i)=>{n=()=>{i(o)},e.addEventListener("abort",n)})])}finally{n!=null&&e.removeEventListener("abort",n)}}var rt=class{readNext;haveNext;ended;nextResult;error;constructor(){this.ended=!1,this.readNext=$(),this.haveNext=$()}[Symbol.asyncIterator](){return this}async next(){if(this.nextResult==null&&await this.haveNext.promise,this.nextResult==null)throw new Error("HaveNext promise resolved but nextResult was undefined");let e=this.nextResult;return this.nextResult=void 0,this.readNext.resolve(),this.readNext=$(),e}async throw(e){return this.ended=!0,this.error=e,e!=null&&(this.haveNext.promise.catch(()=>{}),this.haveNext.reject(e)),{done:!0,value:void 0}}async return(){let e={done:!0,value:void 0};return this.ended=!0,this.nextResult=e,this.haveNext.resolve(),e}async push(e,t){await this._push(e,t)}async end(e,t){e!=null?await this.throw(e):await this._push(void 0,t)}async _push(e,t){if(e!=null&&this.ended)throw this.error??new Error("Cannot push value onto an ended pushable");for(;this.nextResult!=null;)await this.readNext.promise;e!=null?this.nextResult={done:!1,value:e}:(this.ended=!0,this.nextResult={done:!0,value:void 0}),this.haveNext.resolve(),this.haveNext=$(),await Rt(this.readNext.promise,t?.signal,t)}};function Ut(){return new rt}function mn(r){return r[Symbol.asyncIterator]!=null}async function yn(r,e,t){try{await Promise.all(r.map(async n=>{for await(let o of n)await e.push(o,{signal:t}),t.throwIfAborted()})),await e.end(void 0,{signal:t})}catch(n){await e.end(n,{signal:t}).catch(()=>{})}}async function*bn(r){let e=new AbortController,t=Ut();yn(r,t,e.signal).catch(()=>{});try{yield*t}finally{e.abort()}}function*wn(r){for(let e of r)yield*e}function gn(...r){let e=[];for(let t of r)mn(t)||e.push(t);return e.length===r.length?wn(e):bn(r)}var re=gn;function xe(r,...e){if(r==null)throw new Error("Empty pipeline");if(nt(r)){let n=r;r=()=>n.source}else if(Lt(r)||$t(r)){let n=r;r=()=>n}let t=[r,...e];if(t.length>1&&nt(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let n=1;n<t.length-1;n++)nt(t[n])&&(t[n]=Cn(t[n]));return xn(...t)}var xn=(...r)=>{let e;for(;r.length>0;)e=r.shift()(e);return e},$t=r=>r?.[Symbol.asyncIterator]!=null,Lt=r=>r?.[Symbol.iterator]!=null,nt=r=>r==null?!1:r.sink!=null&&r.source!=null,Cn=r=>e=>{let t=r.sink(e);if(t?.then!=null){let n=Mt({objectMode:!0});t.then(()=>{n.end()},i=>{n.end(i)});let o,s=r.source;if($t(s))o=async function*(){yield*s,n.end()};else if(Lt(s))o=function*(){yield*s,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return re(n,o())}return r.source};var P=class extends v{child;transform;constructor(e,t){super(),this.child=e,this.transform=t}async put(e,t,n){return await this.child.put(this.transform.convert(e),t,n),e}async get(e,t){return this.child.get(this.transform.convert(e),t)}async has(e,t){return this.child.has(this.transform.convert(e),t)}async delete(e,t){await this.child.delete(this.transform.convert(e),t)}async*putMany(e,t={}){let n=this.transform,o=this.child;yield*xe(e,async function*(s){yield*M(s,({key:i,value:a})=>({key:n.convert(i),value:a}))},async function*(s){yield*o.putMany(s,t)},async function*(s){yield*M(s,i=>n.invert(i))})}async*getMany(e,t={}){let n=this.transform,o=this.child;yield*xe(e,async function*(s){yield*M(s,i=>n.convert(i))},async function*(s){yield*o.getMany(s,t)},async function*(s){yield*M(s,({key:i,value:a})=>({key:n.invert(i),value:a}))})}async*deleteMany(e,t={}){let n=this.transform,o=this.child;yield*xe(e,async function*(s){yield*M(s,i=>n.convert(i))},async function*(s){yield*o.deleteMany(s,t)},async function*(s){yield*M(s,i=>n.invert(i))})}batch(){let e=this.child.batch();return{put:(t,n)=>{e.put(this.transform.convert(t),n)},delete:t=>{e.delete(this.transform.convert(t))},commit:async t=>{await e.commit(t)}}}query(e,t){let n={...e};n.filters=(n.filters??[]).map(s=>({key:i,value:a})=>s({key:this.transform.convert(i),value:a}));let{prefix:o}=e;return o!=null&&o!=="/"&&(delete n.prefix,n.filters.push(({key:s})=>this.transform.invert(s).toString().startsWith(o))),n.orders!=null&&(n.orders=n.orders.map(s=>(i,a)=>s({key:this.transform.invert(i.key),value:i.value},{key:this.transform.invert(a.key),value:a.value}))),M(this.child.query(n,t),({key:s,value:i})=>({key:this.transform.invert(s),value:i}))}queryKeys(e,t){let n={...e};n.filters=(n.filters??[]).map(s=>i=>s(this.transform.convert(i)));let{prefix:o}=e;return o!=null&&o!=="/"&&(delete n.prefix,n.filters.push(s=>this.transform.invert(s).toString().startsWith(o))),n.orders!=null&&(n.orders=n.orders.map(s=>(i,a)=>s(this.transform.invert(i),this.transform.invert(a)))),M(this.child.queryKeys(n,t),s=>this.transform.invert(s))}};var X=new x(fe),Ce=class r extends v{child;shard;constructor(e,t){super(),this.child=new P(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=t}async open(){this.shard=await r.create(this.child,this.shard)}_convertKey(e){let t=e.toString();return t===X.toString()?e:new x(this.shard.fun(t)).child(e)}_invertKey(e){return e.toString()===X.toString()?e:x.withNamespaces(e.list().slice(1))}static async create(e,t){if(!await e.has(X)){if(t==null)throw new pe("Shard is required when datastore doesn't have a shard key already");await e.put(X,new TextEncoder().encode(t.toString()+`
+`))}t==null&&(t=await de("/",e));let o=await de("/",e),s=o.toString(),i=t.toString();if(s!==i)throw new Error(`specified fun ${i} does not match repo shard fun ${s}`);return o}async put(e,t,n){return await this.child.put(e,t,n),e}async get(e,t){return this.child.get(e,t)}async has(e,t){return this.child.has(e,t)}async delete(e,t){await this.child.delete(e,t)}async*putMany(e,t={}){yield*this.child.putMany(e,t)}async*getMany(e,t={}){yield*this.child.getMany(e,t)}async*deleteMany(e,t={}){yield*this.child.deleteMany(e,t)}batch(){return this.child.batch()}query(e,t){let o={...e,filters:[({key:s})=>s.toString()!==X.toString()].concat(e.filters??[])};return this.child.query(o,t)}queryKeys(e,t){let o={...e,filters:[s=>s.toString()!==X.toString()].concat(e.filters??[])};return this.child.queryKeys(o,t)}};var ve=class extends v{mounts;constructor(e){super(),this.mounts=e.slice()}_lookup(e){for(let t of this.mounts)if(t.prefix.toString()===e.toString()||t.prefix.isAncestorOf(e))return{datastore:t.datastore,mountpoint:t.prefix}}async put(e,t,n){let o=this._lookup(e);if(o==null)throw new me("No datastore mounted for this key");return await o.datastore.put(e,t,n),e}async get(e,t={}){let n=this._lookup(e);if(n==null)throw new z("No datastore mounted for this key");return n.datastore.get(e,t)}async has(e,t){let n=this._lookup(e);return n==null?Promise.resolve(!1):n.datastore.has(e,t)}async delete(e,t){let n=this._lookup(e);if(n==null)throw new ye("No datastore mounted for this key");await n.datastore.delete(e,t)}batch(){let e={},t=n=>{let o=this._lookup(n);if(o==null)throw new Error("No datastore mounted for this key");let s=o.mountpoint.toString();return e[s]==null&&(e[s]=o.datastore.batch()),{batch:e[s]}};return{put:(n,o)=>{t(n).batch.put(n,o)},delete:n=>{t(n).batch.delete(n)},commit:async n=>{await Promise.all(Object.keys(e).map(async o=>{await e[o].commit(n)}))}}}query(e,t){let n=this.mounts.map(s=>s.datastore.query({prefix:e.prefix,filters:e.filters},t)),o=re(...n);if(e.filters!=null&&e.filters.forEach(s=>{o=D(o,s)}),e.orders!=null&&e.orders.forEach(s=>{o=G(o,s)}),e.offset!=null){let s=0,i=e.offset;o=D(o,()=>s++>=i)}return e.limit!=null&&(o=H(o,e.limit)),o}queryKeys(e,t){let n=this.mounts.map(s=>s.datastore.queryKeys({prefix:e.prefix,filters:e.filters},t)),o=re(...n);if(e.filters!=null&&e.filters.forEach(s=>{o=D(o,s)}),e.orders!=null&&e.orders.forEach(s=>{o=G(o,s)}),e.offset!=null){let s=0,i=e.offset;o=D(o,()=>s++>=i)}return e.limit!=null&&(o=H(o,e.limit)),o}};function vn(r,e){try{if(typeof r=="string"&&r.length>0)return Sn(r);if(typeof r=="number"&&isFinite(r))return e?.long?An(r):En(r);throw new Error("Value is not a string or number.")}catch(t){let n=Fn(t)?`${t.message}. value=${JSON.stringify(r)}`:"An unknown error has occured.";throw new Error(n)}}function Sn(r){if(r=String(r),r.length>100)throw new Error("Value exceeds the maximum length of 100 characters.");let e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!e)return NaN;let t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*315576e5;case"weeks":case"week":case"w":return t*6048e5;case"days":case"day":case"d":return t*864e5;case"hours":case"hour":case"hrs":case"hr":case"h":return t*36e5;case"minutes":case"minute":case"mins":case"min":case"m":return t*6e4;case"seconds":case"second":case"secs":case"sec":case"s":return t*1e3;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:throw new Error(`The unit ${n} was matched, but no matching case exists.`)}}var Ee=vn;function En(r){let e=Math.abs(r);return e>=864e5?`${Math.round(r/864e5)}d`:e>=36e5?`${Math.round(r/36e5)}h`:e>=6e4?`${Math.round(r/6e4)}m`:e>=1e3?`${Math.round(r/1e3)}s`:`${r}ms`}function An(r){let e=Math.abs(r);return e>=864e5?Se(r,e,864e5,"day"):e>=36e5?Se(r,e,36e5,"hour"):e>=6e4?Se(r,e,6e4,"minute"):e>=1e3?Se(r,e,1e3,"second"):`${r} ms`}function Se(r,e,t,n){let o=e>=t*1.5;return`${Math.round(r/t)} ${n}${o?"s":""}`}function Fn(r){return typeof r=="object"&&r!==null&&"message"in r}function ot(r){t.debug=t,t.default=t,t.coerce=d,t.disable=s,t.enable=o,t.enabled=i,t.humanize=Ee,t.destroy=E,Object.keys(r).forEach(u=>{t[u]=r[u]}),t.names=[],t.skips=[],t.formatters={};function e(u){let l=0;for(let p=0;p<u.length;p++)l=(l<<5)-l+u.charCodeAt(p),l|=0;return t.colors[Math.abs(l)%t.colors.length]}t.selectColor=e;function t(u){let l,p=null,L,h;function f(...c){if(!f.enabled)return;let m=f,b=Number(new Date),w=b-(l||b);m.diff=w,m.prev=l,m.curr=b,l=b,c[0]=t.coerce(c[0]),typeof c[0]!="string"&&c.unshift("%O");let g=0;c[0]=c[0].replace(/%([a-zA-Z%])/g,(I,F)=>{if(I==="%%")return"%";g++;let N=t.formatters[F];if(typeof N=="function"){let K=c[g];I=N.call(m,K),c.splice(g,1),g--}return I}),t.formatArgs.call(m,c),(m.log||t.log).apply(m,c)}return f.namespace=u,f.useColors=t.useColors(),f.color=t.selectColor(u),f.extend=n,f.destroy=t.destroy,Object.defineProperty(f,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(L!==t.namespaces&&(L=t.namespaces,h=t.enabled(u)),h),set:c=>{p=c}}),typeof t.init=="function"&&t.init(f),f}function n(u,l){let p=t(this.namespace+(typeof l>"u"?":":l)+u);return p.log=this.log,p}function o(u){t.save(u),t.namespaces=u,t.names=[],t.skips=[];let l,p=(typeof u=="string"?u:"").split(/[\s,]+/),L=p.length;for(l=0;l<L;l++)p[l]&&(u=p[l].replace(/\*/g,".*?"),u[0]==="-"?t.skips.push(new RegExp("^"+u.substr(1)+"$")):t.names.push(new RegExp("^"+u+"$")))}function s(){let u=[...t.names.map(a),...t.skips.map(a).map(l=>"-"+l)].join(",");return t.enable(""),u}function i(u){if(u[u.length-1]==="*")return!0;let l,p;for(l=0,p=t.skips.length;l<p;l++)if(t.skips[l].test(u))return!1;for(l=0,p=t.names.length;l<p;l++)if(t.names[l].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function d(u){return u instanceof Error?u.stack??u.message:u}function E(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.setupFormatters(t.formatters),t.enable(t.load()),t}var Ae=Un(),In=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Nn(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/(edge|trident)\/(\d+)/)!=null?!1:typeof document<"u"&&document.documentElement?.style?.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/firefox\/(\d+)/)!=null&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/applewebkit\/(\d+)/)}function kn(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+Ee(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,n=0;r[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(n=t))}),r.splice(n,0,e)}var Dn=console.debug??console.log??(()=>{});function Mn(r){try{r?Ae?.setItem("debug",r):Ae?.removeItem("debug")}catch{}}function Rn(){let r;try{r=Ae?.getItem("debug")}catch{}return!r&&typeof globalThis.process<"u"&&"env"in globalThis.process&&(r=globalThis.process.env.DEBUG),r}function Un(){try{return localStorage}catch{}}function $n(r){r.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}var Ot=ot({formatArgs:kn,save:Mn,load:Rn,useColors:Nn,setupFormatters:$n,colors:In,storage:Ae,log:Dn});var S=Ot;S.formatters.b=r=>r==null?"undefined":k.baseEncode(r);S.formatters.t=r=>r==null?"undefined":T.baseEncode(r);S.formatters.m=r=>r==null?"undefined":_e.baseEncode(r);S.formatters.p=r=>r==null?"undefined":r.toString();S.formatters.c=r=>r==null?"undefined":r.toString();S.formatters.k=r=>r==null?"undefined":r.toString();S.formatters.a=r=>r==null?"undefined":r.toString();S.formatters.e=r=>r==null?"undefined":Tt(r.stack)??Tt(r.message)??r.toString();function Ln(r){let e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=r,e.destroy=()=>!0,e.extend=()=>e,e}function zt(r){let e=Ln(`${r}:trace`);return S.enabled(`${r}:trace`)&&S.names.map(t=>t.toString()).find(t=>t.includes(":trace"))!=null&&(e=S(`${r}:trace`)),Object.assign(S(r),{error:S(`${r}:error`),trace:e})}function Tt(r){if(r!=null&&(r=r.trim(),r.length!==0))return r}var On=zt("datastore:core:tiered"),Fe=class extends v{stores;constructor(e){super(),this.stores=e.slice()}async put(e,t,n){return await Promise.all(this.stores.map(async o=>{await o.put(e,t,n)})),e}async get(e,t){let n;for(let o of this.stores)try{let s=await o.get(e,t);if(s!=null)return s}catch(s){n=s,On.error(s)}throw n??new z}async has(e,t){for(let n of this.stores)if(await n.has(e,t))return!0;return!1}async delete(e,t){await Promise.all(this.stores.map(async n=>{await n.delete(e,t)}))}async*putMany(e,t={}){for await(let n of e)await this.put(n.key,n.value,t),yield n.key}async*deleteMany(e,t={}){for await(let n of e)await this.delete(n,t),yield n}batch(){let e=this.stores.map(t=>t.batch());return{put:(t,n)=>{e.forEach(o=>{o.put(t,n)})},delete:t=>{e.forEach(n=>{n.delete(t)})},commit:async t=>{for(let n of e)await n.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}};var Ie=class extends P{iChild;iKey;constructor(e,t){super(e,{convert(n){return t.child(n)},invert(n){if(t.toString()==="/")return n;if(!t.isAncestorOf(n))throw new Error(`Expected prefix: (${t.toString()}) in key: ${n.toString()}`);return new x(n.toString().slice(t.toString().length),!1)}}),this.iChild=e,this.iKey=t}query(e,t){let n={...e};n.filters=(n.filters??[]).map(s=>({key:i,value:a})=>s({key:this.transform.invert(i),value:a}));let{prefix:o}=e;return o!=null&&o!=="/"&&(delete n.prefix,n.filters.push(({key:s})=>this.transform.invert(s).toString().startsWith(o))),n.orders!=null&&(n.orders=n.orders.map(s=>(i,a)=>s({key:this.transform.invert(i.key),value:i.value},{key:this.transform.invert(a.key),value:a.value}))),n.filters.unshift(({key:s})=>this.iKey.isAncestorOf(s)),M(this.iChild.query(n,t),({key:s,value:i})=>({key:this.transform.invert(s),value:i}))}queryKeys(e,t){let n={...e};n.filters=(n.filters??[]).map(s=>i=>s(this.transform.invert(i)));let{prefix:o}=e;return o!=null&&o!=="/"&&(delete n.prefix,n.filters.push(s=>this.transform.invert(s).toString().startsWith(o))),n.orders!=null&&(n.orders=n.orders.map(s=>(i,a)=>s(this.transform.invert(i),this.transform.invert(a)))),n.filters.unshift(s=>this.iKey.isAncestorOf(s)),M(this.iChild.queryKeys(n,t),s=>this.transform.invert(s))}};return Bt(Tn);})();
 return DatastoreCore}));
+//# sourceMappingURL=index.min.js.map
diff --git a/node_modules/datastore-core/dist/index.min.js.map b/node_modules/datastore-core/dist/index.min.js.map
new file mode 100644
index 0000000..bca4ccc
--- /dev/null
+++ b/node_modules/datastore-core/dist/index.min.js.map
@@ -0,0 +1,7 @@
+{
+  "version": 3,
+  "sources": ["../src/index.ts", "../src/shard.ts", "../../../node_modules/multiformats/src/bases/base10.ts", "../../../node_modules/multiformats/src/bytes.ts", "../../../node_modules/multiformats/src/vendor/base-x.js", "../../../node_modules/multiformats/src/bases/base.ts", "../../../node_modules/multiformats/src/bases/base16.ts", "../../../node_modules/multiformats/src/bases/base2.ts", "../../../node_modules/multiformats/src/bases/base256emoji.ts", "../../../node_modules/multiformats/src/bases/base32.ts", "../../../node_modules/multiformats/src/bases/base36.ts", "../../../node_modules/multiformats/src/bases/base58.ts", "../../../node_modules/multiformats/src/bases/base64.ts", "../../../node_modules/multiformats/src/bases/base8.ts", "../../../node_modules/multiformats/src/bases/identity.ts", "../../../node_modules/multiformats/src/codecs/json.ts", "../../../node_modules/multiformats/src/hashes/identity.ts", "../../../node_modules/multiformats/src/vendor/varint.js", "../../../node_modules/multiformats/src/varint.ts", "../../../node_modules/multiformats/src/hashes/digest.ts", "../../../node_modules/multiformats/src/hashes/sha2-browser.ts", "../../../node_modules/multiformats/src/hashes/hasher.ts", "../../../node_modules/multiformats/src/cid.ts", "../../../node_modules/multiformats/src/basics.ts", "../../../node_modules/uint8arrays/src/alloc.ts", "../../../node_modules/uint8arrays/src/util/bases.ts", "../../../node_modules/uint8arrays/src/from-string.ts", "../../../node_modules/uint8arrays/src/to-string.ts", "../../interface-datastore/src/key.ts", "../../../node_modules/it-drain/src/index.ts", "../../../node_modules/it-peekable/src/index.ts", "../../../node_modules/it-filter/src/index.ts", "../../../node_modules/it-all/src/index.ts", "../../../node_modules/it-sort/src/index.ts", "../../../node_modules/it-take/src/index.ts", "../src/base.ts", "../../interface-store/src/errors.ts", "../src/memory.ts", "../../../node_modules/it-map/src/index.ts", "../../../node_modules/p-defer/index.js", "../../../node_modules/it-pushable/src/fifo.ts", "../../../node_modules/it-pushable/src/index.ts", "../../../node_modules/race-signal/src/index.ts", "../../../node_modules/it-queueless-pushable/src/index.ts", "../../../node_modules/it-merge/src/index.ts", "../../../node_modules/it-pipe/src/index.ts", "../src/keytransform.ts", "../src/sharding.ts", "../src/mount.ts", "../../../node_modules/weald/node_modules/ms/dist/index.mjs", "../../../node_modules/weald/src/common.ts", "../../../node_modules/weald/src/browser.ts", "../../../node_modules/weald/src/index.ts", "../../../node_modules/@libp2p/logger/src/index.ts", "../src/tiered.ts", "../src/namespace.ts"],
+  "sourcesContent": ["/**\n * @packageDocumentation\n *\n * Various Datastore implementations are available.\n *\n * ## Implementations\n *\n * - Mount: [`src/mount`](./src/mount.ts)\n * - Keytransform: [`src/keytransform`](./src/keytransform.ts)\n * - Sharding: [`src/sharding`](./src/sharding.ts)\n * - Tiered: [`src/tiered`](./src/tirered.ts)\n * - Namespace: [`src/namespace`](./src/namespace.ts)\n * - BlackHole: [`src/black-hole`](./src/black-hole.ts)\n *\n * @example BaseDatastore\n *\n * An base store is made available to make implementing your own datastore easier:\n *\n * ```javascript\n * import { BaseDatastore } from 'datastore-core'\n *\n * class MyDatastore extends BaseDatastore {\n *   constructor () {\n *     super()\n *   }\n *\n *   async put (key, val) {\n *     // your implementation here\n *   }\n *\n *   async get (key) {\n *     // your implementation here\n *   }\n *\n *   // etc...\n * }\n * ```\n *\n * See the [MemoryDatastore](./src/memory.js) for an example of how it is used.\n *\n * @example Wrapping Stores\n *\n * ```js\n * import { Key } from 'interface-datastore'\n * import {\n *   MemoryStore,\n *   MountStore\n * } from 'datastore-core'\n *\n * const store = new MountStore({prefix: new Key('/a'), datastore: new MemoryStore()})\n * ```\n *\n * @example BlackHoleDatastore\n *\n * A datastore that does not store any data.\n *\n * ```js\n * import { BlackHoleDatastore } from 'datastore-core/black-hole'\n *\n * const store = new BlackHoleDatastore()\n * ```\n */\n\nimport * as shard from './shard.js'\nimport type { Key } from 'interface-datastore'\n\nexport { BaseDatastore } from './base.js'\nexport { MemoryDatastore } from './memory.js'\nexport { KeyTransformDatastore } from './keytransform.js'\nexport { ShardingDatastore } from './sharding.js'\nexport { MountDatastore } from './mount.js'\nexport { TieredDatastore } from './tiered.js'\nexport { NamespaceDatastore } from './namespace.js'\n\nexport { shard }\n\nexport interface Shard {\n  name: string\n  param: number\n  readonly _padding: string\n  fun(s: string): string\n  toString(): string\n}\n\nexport interface KeyTransform {\n  convert(key: Key): Key\n  invert(key: Key): Key\n}\n", "import { Key } from 'interface-datastore/key'\nimport type { Shard } from './index.js'\nimport type { Datastore } from 'interface-datastore'\n\nexport const PREFIX = '/repo/flatfs/shard/'\nexport const SHARDING_FN = 'SHARDING'\n\nexport class ShardBase implements Shard {\n  public param: number\n  public name: string\n  public _padding: string\n\n  constructor (param: number) {\n    this.param = param\n    this.name = 'base'\n    this._padding = ''\n  }\n\n  fun (s: string): string {\n    return 'implement me'\n  }\n\n  toString (): string {\n    return `${PREFIX}v1/${this.name}/${this.param}`\n  }\n}\n\nexport class Prefix extends ShardBase {\n  constructor (prefixLen: number) {\n    super(prefixLen)\n    this._padding = ''.padStart(prefixLen, '_')\n    this.name = 'prefix'\n  }\n\n  fun (noslash: string): string {\n    return (noslash + this._padding).slice(0, this.param)\n  }\n}\n\nexport class Suffix extends ShardBase {\n  constructor (suffixLen: number) {\n    super(suffixLen)\n\n    this._padding = ''.padStart(suffixLen, '_')\n    this.name = 'suffix'\n  }\n\n  fun (noslash: string): string {\n    const s = this._padding + noslash\n    return s.slice(s.length - this.param)\n  }\n}\n\nexport class NextToLast extends ShardBase {\n  constructor (suffixLen: number) {\n    super(suffixLen)\n    this._padding = ''.padStart(suffixLen + 1, '_')\n    this.name = 'next-to-last'\n  }\n\n  fun (noslash: string): string {\n    const s = this._padding + noslash\n    const offset = s.length - this.param - 1\n    return s.slice(offset, offset + this.param)\n  }\n}\n\n/**\n * Convert a given string to the matching sharding function\n */\nexport function parseShardFun (str: string): Shard {\n  str = str.trim()\n\n  if (str.length === 0) {\n    throw new Error('empty shard string')\n  }\n\n  if (!str.startsWith(PREFIX)) {\n    throw new Error(`invalid or no path prefix: ${str}`)\n  }\n\n  const parts = str.slice(PREFIX.length).split('/')\n  const version = parts[0]\n\n  if (version !== 'v1') {\n    throw new Error(`expect 'v1' version, got '${version}'`)\n  }\n\n  const name = parts[1]\n\n  if (parts[2] == null || parts[2] === '') {\n    throw new Error('missing param')\n  }\n\n  const param = parseInt(parts[2], 10)\n\n  switch (name) {\n    case 'prefix':\n      return new Prefix(param)\n    case 'suffix':\n      return new Suffix(param)\n    case 'next-to-last':\n      return new NextToLast(param)\n    default:\n      throw new Error(`unkown sharding function: ${name}`)\n  }\n}\n\nexport const readShardFun = async (path: string | Uint8Array, store: Datastore): Promise<Shard> => {\n  const key = new Key(path).child(new Key(SHARDING_FN))\n  // @ts-expect-error not all stores have this\n  const get = typeof store.getRaw === 'function' ? store.getRaw.bind(store) : store.get.bind(store)\n  const res = await get(key)\n  return parseShardFun(new TextDecoder().decode(res ?? '').trim())\n}\n", "import { baseX } from './base.js'\n\nexport const base10 = baseX({\n  prefix: '9',\n  name: 'base10',\n  alphabet: '0123456789'\n})\n", "export const empty = new Uint8Array(0)\n\nexport function toHex (d: Uint8Array): string {\n  return d.reduce((hex, byte) => hex + byte.toString(16).padStart(2, '0'), '')\n}\n\nexport function fromHex (hex: string): Uint8Array {\n  const hexes = hex.match(/../g)\n  return hexes != null ? new Uint8Array(hexes.map(b => parseInt(b, 16))) : empty\n}\n\nexport function equals (aa: Uint8Array, bb: Uint8Array): boolean {\n  if (aa === bb) { return true }\n  if (aa.byteLength !== bb.byteLength) {\n    return false\n  }\n\n  for (let ii = 0; ii < aa.byteLength; ii++) {\n    if (aa[ii] !== bb[ii]) {\n      return false\n    }\n  }\n\n  return true\n}\n\nexport function coerce (o: ArrayBufferView | ArrayBuffer | Uint8Array): Uint8Array {\n  if (o instanceof Uint8Array && o.constructor.name === 'Uint8Array') { return o }\n  if (o instanceof ArrayBuffer) { return new Uint8Array(o) }\n  if (ArrayBuffer.isView(o)) {\n    return new Uint8Array(o.buffer, o.byteOffset, o.byteLength)\n  }\n  throw new Error('Unknown type, must be binary type')\n}\n\nexport function isBinary (o: unknown): o is ArrayBuffer | ArrayBufferView {\n  return o instanceof ArrayBuffer || ArrayBuffer.isView(o)\n}\n\nexport function fromString (str: string): Uint8Array {\n  return new TextEncoder().encode(str)\n}\n\nexport function toString (b: Uint8Array): string {\n  return new TextDecoder().decode(b)\n}\n", "/* eslint-disable */\n// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\n/**\n * @param {string} ALPHABET\n * @param {any} name\n */\nfunction base (ALPHABET, name) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256);\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i);\n    var xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i;\n  }\n  var BASE = ALPHABET.length;\n  var LEADER = ALPHABET.charAt(0);\n  var FACTOR = Math.log(BASE) / Math.log(256); // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n  /**\n   * @param {any[] | Iterable<number>} source\n   */\n  function encode (source) {\n    // @ts-ignore\n    if (source instanceof Uint8Array) ; else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength);\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source);\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0;\n    var length = 0;\n    var pbegin = 0;\n    var pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    var b58 = new Uint8Array(size);\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin];\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0;\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = (carry % BASE) >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      pbegin++;\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]); }\n    return str\n  }\n  /**\n   * @param {string | string[]} source\n   */\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0;\n        // Skip leading spaces.\n    if (source[psz] === ' ') { return }\n        // Skip and count leading '1's.\n    var zeroes = 0;\n    var length = 0;\n    while (source[psz] === LEADER) {\n      zeroes++;\n      psz++;\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0; // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size);\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)];\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0;\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0;\n        b256[it3] = (carry % 256) >>> 0;\n        carry = (carry / 256) >>> 0;\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i;\n      psz++;\n    }\n        // Skip trailing spaces.\n    if (source[psz] === ' ') { return }\n        // Skip leading zeroes in b256.\n    var it4 = size - length;\n    while (it4 !== size && b256[it4] === 0) {\n      it4++;\n    }\n    var vch = new Uint8Array(zeroes + (size - it4));\n    var j = zeroes;\n    while (it4 !== size) {\n      vch[j++] = b256[it4++];\n    }\n    return vch\n  }\n  /**\n   * @param {string | string[]} string\n   */\n  function decode (string) {\n    var buffer = decodeUnsafe(string);\n    if (buffer) { return buffer }\n    throw new Error(`Non-${name} character`)\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nvar src = base;\n\nvar _brrp__multiformats_scope_baseX = src;\n\nexport default _brrp__multiformats_scope_baseX;\n", "import { coerce } from '../bytes.js'\nimport basex from '../vendor/base-x.js'\nimport type { BaseCodec, BaseDecoder, BaseEncoder, CombobaseDecoder, Multibase, MultibaseCodec, MultibaseDecoder, MultibaseEncoder, UnibaseDecoder } from './interface.js'\n\ninterface EncodeFn { (bytes: Uint8Array): string }\ninterface DecodeFn { (text: string): Uint8Array }\n\n/**\n * Class represents both BaseEncoder and MultibaseEncoder meaning it\n * can be used to encode to multibase or base encode without multibase\n * prefix.\n */\nclass Encoder<Base extends string, Prefix extends string> implements MultibaseEncoder<Prefix>, BaseEncoder {\n  readonly name: Base\n  readonly prefix: Prefix\n  readonly baseEncode: EncodeFn\n\n  constructor (name: Base, prefix: Prefix, baseEncode: EncodeFn) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n  }\n\n  encode (bytes: Uint8Array): Multibase<Prefix> {\n    if (bytes instanceof Uint8Array) {\n      return `${this.prefix}${this.baseEncode(bytes)}`\n    } else {\n      throw Error('Unknown type, must be binary type')\n    }\n  }\n}\n\n/**\n * Class represents both BaseDecoder and MultibaseDecoder so it could be used\n * to decode multibases (with matching prefix) or just base decode strings\n * with corresponding base encoding.\n */\nclass Decoder<Base extends string, Prefix extends string> implements MultibaseDecoder<Prefix>, UnibaseDecoder<Prefix>, BaseDecoder {\n  readonly name: Base\n  readonly prefix: Prefix\n  readonly baseDecode: DecodeFn\n  private readonly prefixCodePoint: number\n\n  constructor (name: Base, prefix: Prefix, baseDecode: DecodeFn) {\n    this.name = name\n    this.prefix = prefix\n    const prefixCodePoint = prefix.codePointAt(0)\n    /* c8 ignore next 3 */\n    if (prefixCodePoint === undefined) {\n      throw new Error('Invalid prefix character')\n    }\n    this.prefixCodePoint = prefixCodePoint\n    this.baseDecode = baseDecode\n  }\n\n  decode (text: string): Uint8Array {\n    if (typeof text === 'string') {\n      if (text.codePointAt(0) !== this.prefixCodePoint) {\n        throw Error(`Unable to decode multibase string ${JSON.stringify(text)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)\n      }\n      return this.baseDecode(text.slice(this.prefix.length))\n    } else {\n      throw Error('Can only multibase decode strings')\n    }\n  }\n\n  or<OtherPrefix extends string> (decoder: UnibaseDecoder<OtherPrefix> | ComposedDecoder<OtherPrefix>): ComposedDecoder<Prefix | OtherPrefix> {\n    return or(this, decoder)\n  }\n}\n\ntype Decoders<Prefix extends string> = Record<Prefix, UnibaseDecoder<Prefix>>\n\nclass ComposedDecoder<Prefix extends string> implements MultibaseDecoder<Prefix>, CombobaseDecoder<Prefix> {\n  readonly decoders: Decoders<Prefix>\n\n  constructor (decoders: Decoders<Prefix>) {\n    this.decoders = decoders\n  }\n\n  or <OtherPrefix extends string> (decoder: UnibaseDecoder<OtherPrefix> | ComposedDecoder<OtherPrefix>): ComposedDecoder<Prefix | OtherPrefix> {\n    return or(this, decoder)\n  }\n\n  decode (input: string): Uint8Array {\n    const prefix = input[0] as Prefix\n    const decoder = this.decoders[prefix]\n    if (decoder != null) {\n      return decoder.decode(input)\n    } else {\n      throw RangeError(`Unable to decode multibase string ${JSON.stringify(input)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)\n    }\n  }\n}\n\nexport function or <L extends string, R extends string> (left: UnibaseDecoder<L> | CombobaseDecoder<L>, right: UnibaseDecoder<R> | CombobaseDecoder<R>): ComposedDecoder<L | R> {\n  return new ComposedDecoder({\n    ...(left.decoders ?? { [(left as UnibaseDecoder<L>).prefix]: left }),\n    ...(right.decoders ?? { [(right as UnibaseDecoder<R>).prefix]: right })\n  } as Decoders<L | R>)\n}\n\nexport class Codec<Base extends string, Prefix extends string> implements MultibaseCodec<Prefix>, MultibaseEncoder<Prefix>, MultibaseDecoder<Prefix>, BaseCodec, BaseEncoder, BaseDecoder {\n  readonly name: Base\n  readonly prefix: Prefix\n  readonly baseEncode: EncodeFn\n  readonly baseDecode: DecodeFn\n  readonly encoder: Encoder<Base, Prefix>\n  readonly decoder: Decoder<Base, Prefix>\n\n  constructor (name: Base, prefix: Prefix, baseEncode: EncodeFn, baseDecode: DecodeFn) {\n    this.name = name\n    this.prefix = prefix\n    this.baseEncode = baseEncode\n    this.baseDecode = baseDecode\n    this.encoder = new Encoder(name, prefix, baseEncode)\n    this.decoder = new Decoder(name, prefix, baseDecode)\n  }\n\n  encode (input: Uint8Array): string {\n    return this.encoder.encode(input)\n  }\n\n  decode (input: string): Uint8Array {\n    return this.decoder.decode(input)\n  }\n}\n\nexport function from <Base extends string, Prefix extends string> ({ name, prefix, encode, decode }: { name: Base, prefix: Prefix, encode: EncodeFn, decode: DecodeFn }): Codec<Base, Prefix> {\n  return new Codec(name, prefix, encode, decode)\n}\n\nexport function baseX <Base extends string, Prefix extends string> ({ name, prefix, alphabet }: { name: Base, prefix: Prefix, alphabet: string }): Codec<Base, Prefix> {\n  const { encode, decode } = basex(alphabet, name)\n  return from({\n    prefix,\n    name,\n    encode,\n    decode: (text: string): Uint8Array => coerce(decode(text))\n  })\n}\n\nfunction decode (string: string, alphabetIdx: Record<string, number>, bitsPerChar: number, name: string): Uint8Array {\n  // Count the padding bytes:\n  let end = string.length\n  while (string[end - 1] === '=') {\n    --end\n  }\n\n  // Allocate the output:\n  const out = new Uint8Array((end * bitsPerChar / 8) | 0)\n\n  // Parse the data:\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  let written = 0 // Next byte to write\n  for (let i = 0; i < end; ++i) {\n    // Read one character from the string:\n    const value = alphabetIdx[string[i]]\n    if (value === undefined) {\n      throw new SyntaxError(`Non-${name} character`)\n    }\n\n    // Append the bits to the buffer:\n    buffer = (buffer << bitsPerChar) | value\n    bits += bitsPerChar\n\n    // Write out some bits if the buffer has a byte's worth:\n    if (bits >= 8) {\n      bits -= 8\n      out[written++] = 0xff & (buffer >> bits)\n    }\n  }\n\n  // Verify that we have received just enough bits:\n  if (bits >= bitsPerChar || (0xff & (buffer << (8 - bits))) !== 0) {\n    throw new SyntaxError('Unexpected end of data')\n  }\n\n  return out\n}\n\nfunction encode (data: Uint8Array, alphabet: string, bitsPerChar: number): string {\n  const pad = alphabet[alphabet.length - 1] === '='\n  const mask = (1 << bitsPerChar) - 1\n  let out = ''\n\n  let bits = 0 // Number of bits currently in the buffer\n  let buffer = 0 // Bits waiting to be written out, MSB first\n  for (let i = 0; i < data.length; ++i) {\n    // Slurp data into the buffer:\n    buffer = (buffer << 8) | data[i]\n    bits += 8\n\n    // Write out as much as we can:\n    while (bits > bitsPerChar) {\n      bits -= bitsPerChar\n      out += alphabet[mask & (buffer >> bits)]\n    }\n  }\n\n  // Partial character:\n  if (bits !== 0) {\n    out += alphabet[mask & (buffer << (bitsPerChar - bits))]\n  }\n\n  // Add padding characters until we hit a byte boundary:\n  if (pad) {\n    while (((out.length * bitsPerChar) & 7) !== 0) {\n      out += '='\n    }\n  }\n\n  return out\n}\n\nfunction createAlphabetIdx (alphabet: string): Record<string, number> {\n  // Build the character lookup table:\n  const alphabetIdx: Record<string, number> = {}\n  for (let i = 0; i < alphabet.length; ++i) {\n    alphabetIdx[alphabet[i]] = i\n  }\n  return alphabetIdx\n}\n\n/**\n * RFC4648 Factory\n */\nexport function rfc4648 <Base extends string, Prefix extends string> ({ name, prefix, bitsPerChar, alphabet }: { name: Base, prefix: Prefix, bitsPerChar: number, alphabet: string }): Codec<Base, Prefix> {\n  const alphabetIdx = createAlphabetIdx(alphabet)\n  return from({\n    prefix,\n    name,\n    encode (input: Uint8Array): string {\n      return encode(input, alphabet, bitsPerChar)\n    },\n    decode (input: string): Uint8Array {\n      return decode(input, alphabetIdx, bitsPerChar, name)\n    }\n  })\n}\n", "import { rfc4648 } from './base.js'\n\nexport const base16 = rfc4648({\n  prefix: 'f',\n  name: 'base16',\n  alphabet: '0123456789abcdef',\n  bitsPerChar: 4\n})\n\nexport const base16upper = rfc4648({\n  prefix: 'F',\n  name: 'base16upper',\n  alphabet: '0123456789ABCDEF',\n  bitsPerChar: 4\n})\n", "import { rfc4648 } from './base.js'\n\nexport const base2 = rfc4648({\n  prefix: '0',\n  name: 'base2',\n  alphabet: '01',\n  bitsPerChar: 1\n})\n", "import { from } from './base.js'\n\nconst alphabet = Array.from('\uD83D\uDE80\uD83E\uDE90\u2604\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\u2600\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\u2764\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\u263A\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\u270C\u2728\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\u2763\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\u270B\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\u2B50\u2705\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\u2714\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\u2639\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\u261D\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\u26BD\uD83E\uDD19\u2615\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\u26A1\uD83C\uDF1E\uD83C\uDF88\u274C\u270A\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\u2708\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\u25B6\u27A1\u2753\uD83D\uDC8E\uD83D\uDCB8\u2B07\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\u26A0\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\u260E\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\u2744\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42')\nconst alphabetBytesToChars: string[] = (alphabet.reduce<string[]>((p, c, i) => { p[i] = c; return p }, ([])))\nconst alphabetCharsToBytes: number[] = (alphabet.reduce<number[]>((p, c, i) => {\n  const codePoint = c.codePointAt(0)\n  if (codePoint == null) {\n    throw new Error(`Invalid character: ${c}`)\n  }\n  p[codePoint] = i\n  return p\n}, ([])))\n\nfunction encode (data: Uint8Array): string {\n  return data.reduce((p, c) => {\n    p += alphabetBytesToChars[c]\n    return p\n  }, '')\n}\n\nfunction decode (str: string): Uint8Array {\n  const byts = []\n  for (const char of str) {\n    const codePoint = char.codePointAt(0)\n    if (codePoint == null) {\n      throw new Error(`Invalid character: ${char}`)\n    }\n    const byt = alphabetCharsToBytes[codePoint]\n    if (byt == null) {\n      throw new Error(`Non-base256emoji character: ${char}`)\n    }\n    byts.push(byt)\n  }\n  return new Uint8Array(byts)\n}\n\nexport const base256emoji = from({\n  prefix: '\uD83D\uDE80',\n  name: 'base256emoji',\n  encode,\n  decode\n})\n", "import { rfc4648 } from './base.js'\n\nexport const base32 = rfc4648({\n  prefix: 'b',\n  name: 'base32',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567',\n  bitsPerChar: 5\n})\n\nexport const base32upper = rfc4648({\n  prefix: 'B',\n  name: 'base32upper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567',\n  bitsPerChar: 5\n})\n\nexport const base32pad = rfc4648({\n  prefix: 'c',\n  name: 'base32pad',\n  alphabet: 'abcdefghijklmnopqrstuvwxyz234567=',\n  bitsPerChar: 5\n})\n\nexport const base32padupper = rfc4648({\n  prefix: 'C',\n  name: 'base32padupper',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=',\n  bitsPerChar: 5\n})\n\nexport const base32hex = rfc4648({\n  prefix: 'v',\n  name: 'base32hex',\n  alphabet: '0123456789abcdefghijklmnopqrstuv',\n  bitsPerChar: 5\n})\n\nexport const base32hexupper = rfc4648({\n  prefix: 'V',\n  name: 'base32hexupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV',\n  bitsPerChar: 5\n})\n\nexport const base32hexpad = rfc4648({\n  prefix: 't',\n  name: 'base32hexpad',\n  alphabet: '0123456789abcdefghijklmnopqrstuv=',\n  bitsPerChar: 5\n})\n\nexport const base32hexpadupper = rfc4648({\n  prefix: 'T',\n  name: 'base32hexpadupper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUV=',\n  bitsPerChar: 5\n})\n\nexport const base32z = rfc4648({\n  prefix: 'h',\n  name: 'base32z',\n  alphabet: 'ybndrfg8ejkmcpqxot1uwisza345h769',\n  bitsPerChar: 5\n})\n", "import { baseX } from './base.js'\n\nexport const base36 = baseX({\n  prefix: 'k',\n  name: 'base36',\n  alphabet: '0123456789abcdefghijklmnopqrstuvwxyz'\n})\n\nexport const base36upper = baseX({\n  prefix: 'K',\n  name: 'base36upper',\n  alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n})\n", "import { baseX } from './base.js'\n\nexport const base58btc = baseX({\n  name: 'base58btc',\n  prefix: 'z',\n  alphabet: '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n})\n\nexport const base58flickr = baseX({\n  name: 'base58flickr',\n  prefix: 'Z',\n  alphabet: '123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'\n})\n", "import { rfc4648 } from './base.js'\n\nexport const base64 = rfc4648({\n  prefix: 'm',\n  name: 'base64',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n  bitsPerChar: 6\n})\n\nexport const base64pad = rfc4648({\n  prefix: 'M',\n  name: 'base64pad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n  bitsPerChar: 6\n})\n\nexport const base64url = rfc4648({\n  prefix: 'u',\n  name: 'base64url',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_',\n  bitsPerChar: 6\n})\n\nexport const base64urlpad = rfc4648({\n  prefix: 'U',\n  name: 'base64urlpad',\n  alphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=',\n  bitsPerChar: 6\n})\n", "import { rfc4648 } from './base.js'\n\nexport const base8 = rfc4648({\n  prefix: '7',\n  name: 'base8',\n  alphabet: '01234567',\n  bitsPerChar: 3\n})\n", "import { fromString, toString } from '../bytes.js'\nimport { from } from './base.js'\n\nexport const identity = from({\n  prefix: '\\x00',\n  name: 'identity',\n  encode: (buf) => toString(buf),\n  decode: (str) => fromString(str)\n})\n", "import type { ArrayBufferView, ByteView } from './interface.js'\n\nconst textEncoder = new TextEncoder()\nconst textDecoder = new TextDecoder()\n\nexport const name = 'json'\nexport const code = 0x0200\n\nexport function encode <T> (node: T): ByteView<T> {\n  return textEncoder.encode(JSON.stringify(node))\n}\n\nexport function decode <T> (data: ByteView<T> | ArrayBufferView<T>): T {\n  return JSON.parse(textDecoder.decode(data))\n}\n", "import { coerce } from '../bytes.js'\nimport * as Digest from './digest.js'\n\nconst code: 0x0 = 0x0\nconst name = 'identity'\n\nconst encode: (input: Uint8Array) => Uint8Array = coerce\n\nfunction digest (input: Uint8Array): Digest.Digest<typeof code, number> {\n  return Digest.create(code, encode(input))\n}\n\nexport const identity = { code, name, encode, digest }\n", "/* eslint-disable */\nvar encode_1 = encode;\n\nvar MSB = 0x80\n  , REST = 0x7F\n  , MSBALL = ~REST\n  , INT = Math.pow(2, 31);\n\n/**\n * @param {number} num\n * @param {number[]} out\n * @param {number} offset\n */\nfunction encode(num, out, offset) {\n  out = out || [];\n  offset = offset || 0;\n  var oldOffset = offset;\n\n  while(num >= INT) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num /= 128;\n  }\n  while(num & MSBALL) {\n    out[offset++] = (num & 0xFF) | MSB;\n    num >>>= 7;\n  }\n  out[offset] = num | 0;\n  \n  // @ts-ignore\n  encode.bytes = offset - oldOffset + 1;\n  \n  return out\n}\n\nvar decode = read;\n\nvar MSB$1 = 0x80\n  , REST$1 = 0x7F;\n\n/**\n * @param {string | any[]} buf\n * @param {number} offset\n */\nfunction read(buf, offset) {\n  var res    = 0\n    , offset = offset || 0\n    , shift  = 0\n    , counter = offset\n    , b\n    , l = buf.length;\n\n  do {\n    if (counter >= l) {\n      // @ts-ignore\n      read.bytes = 0;\n      throw new RangeError('Could not decode varint')\n    }\n    b = buf[counter++];\n    res += shift < 28\n      ? (b & REST$1) << shift\n      : (b & REST$1) * Math.pow(2, shift);\n    shift += 7;\n  } while (b >= MSB$1)\n\n  // @ts-ignore\n  read.bytes = counter - offset;\n\n  return res\n}\n\nvar N1 = Math.pow(2,  7);\nvar N2 = Math.pow(2, 14);\nvar N3 = Math.pow(2, 21);\nvar N4 = Math.pow(2, 28);\nvar N5 = Math.pow(2, 35);\nvar N6 = Math.pow(2, 42);\nvar N7 = Math.pow(2, 49);\nvar N8 = Math.pow(2, 56);\nvar N9 = Math.pow(2, 63);\n\nvar length = function (/** @type {number} */ value) {\n  return (\n    value < N1 ? 1\n  : value < N2 ? 2\n  : value < N3 ? 3\n  : value < N4 ? 4\n  : value < N5 ? 5\n  : value < N6 ? 6\n  : value < N7 ? 7\n  : value < N8 ? 8\n  : value < N9 ? 9\n  :              10\n  )\n};\n\nvar varint = {\n    encode: encode_1\n  , decode: decode\n  , encodingLength: length\n};\n\nvar _brrp_varint = varint;\n\nexport default _brrp_varint;\n", "import varint from './vendor/varint.js'\n\nexport function decode (data: Uint8Array, offset = 0): [number, number] {\n  const code = varint.decode(data, offset)\n  return [code, varint.decode.bytes]\n}\n\nexport function encodeTo (int: number, target: Uint8Array, offset = 0): Uint8Array {\n  varint.encode(int, target, offset)\n  return target\n}\n\nexport function encodingLength (int: number): number {\n  return varint.encodingLength(int)\n}\n", "import { coerce, equals as equalBytes } from '../bytes.js'\nimport * as varint from '../varint.js'\nimport type { MultihashDigest } from './interface.js'\n\n/**\n * Creates a multihash digest.\n */\nexport function create <Code extends number> (code: Code, digest: Uint8Array): Digest<Code, number> {\n  const size = digest.byteLength\n  const sizeOffset = varint.encodingLength(code)\n  const digestOffset = sizeOffset + varint.encodingLength(size)\n\n  const bytes = new Uint8Array(digestOffset + size)\n  varint.encodeTo(code, bytes, 0)\n  varint.encodeTo(size, bytes, sizeOffset)\n  bytes.set(digest, digestOffset)\n\n  return new Digest(code, size, digest, bytes)\n}\n\n/**\n * Turns bytes representation of multihash digest into an instance.\n */\nexport function decode (multihash: Uint8Array): MultihashDigest {\n  const bytes = coerce(multihash)\n  const [code, sizeOffset] = varint.decode(bytes)\n  const [size, digestOffset] = varint.decode(bytes.subarray(sizeOffset))\n  const digest = bytes.subarray(sizeOffset + digestOffset)\n\n  if (digest.byteLength !== size) {\n    throw new Error('Incorrect length')\n  }\n\n  return new Digest(code, size, digest, bytes)\n}\n\nexport function equals (a: MultihashDigest, b: unknown): b is MultihashDigest {\n  if (a === b) {\n    return true\n  } else {\n    const data = b as { code?: unknown, size?: unknown, bytes?: unknown }\n\n    return (\n      a.code === data.code &&\n      a.size === data.size &&\n      data.bytes instanceof Uint8Array &&\n      equalBytes(a.bytes, data.bytes)\n    )\n  }\n}\n\n/**\n * Represents a multihash digest which carries information about the\n * hashing algorithm and an actual hash digest.\n */\nexport class Digest<Code extends number, Size extends number> implements MultihashDigest {\n  readonly code: Code\n  readonly size: Size\n  readonly digest: Uint8Array\n  readonly bytes: Uint8Array\n\n  /**\n   * Creates a multihash digest.\n   */\n  constructor (code: Code, size: Size, digest: Uint8Array, bytes: Uint8Array) {\n    this.code = code\n    this.size = size\n    this.digest = digest\n    this.bytes = bytes\n  }\n}\n\n/**\n * Used to check that the passed multihash has the passed code\n */\nexport function hasCode <T extends number> (digest: MultihashDigest, code: T): digest is MultihashDigest<T> {\n  return digest.code === code\n}\n", "/* global crypto */\n\nimport { from } from './hasher.js'\n\nfunction sha (name: AlgorithmIdentifier): (data: Uint8Array) => Promise<Uint8Array> {\n  return async data => new Uint8Array(await crypto.subtle.digest(name, data))\n}\n\nexport const sha256 = from({\n  name: 'sha2-256',\n  code: 0x12,\n  encode: sha('SHA-256')\n})\n\nexport const sha512 = from({\n  name: 'sha2-512',\n  code: 0x13,\n  encode: sha('SHA-512')\n})\n", "import * as Digest from './digest.js'\nimport type { MultihashHasher } from './interface.js'\n\ntype Await<T> = Promise<T> | T\n\nexport function from <Name extends string, Code extends number> ({ name, code, encode }: { name: Name, code: Code, encode(input: Uint8Array): Await<Uint8Array> }): Hasher<Name, Code> {\n  return new Hasher(name, code, encode)\n}\n\n/**\n * Hasher represents a hashing algorithm implementation that produces as\n * `MultihashDigest`.\n */\nexport class Hasher<Name extends string, Code extends number> implements MultihashHasher<Code> {\n  readonly name: Name\n  readonly code: Code\n  readonly encode: (input: Uint8Array) => Await<Uint8Array>\n\n  constructor (name: Name, code: Code, encode: (input: Uint8Array) => Await<Uint8Array>) {\n    this.name = name\n    this.code = code\n    this.encode = encode\n  }\n\n  digest (input: Uint8Array): Await<Digest.Digest<Code, number>> {\n    if (input instanceof Uint8Array) {\n      const result = this.encode(input)\n      return result instanceof Uint8Array\n        ? Digest.create(this.code, result)\n        /* c8 ignore next 1 */\n        : result.then(digest => Digest.create(this.code, digest))\n    } else {\n      throw Error('Unknown type, must be binary type')\n      /* c8 ignore next 1 */\n    }\n  }\n}\n", "import { base32 } from './bases/base32.js'\nimport { base36 } from './bases/base36.js'\nimport { base58btc } from './bases/base58.js'\nimport { coerce } from './bytes.js'\nimport * as Digest from './hashes/digest.js'\nimport * as varint from './varint.js'\nimport type * as API from './link/interface.js'\n\n// This way TS will also expose all the types from module\nexport * from './link/interface.js'\n\nexport function format <T extends API.Link<unknown, number, number, API.Version>, Prefix extends string> (link: T, base?: API.MultibaseEncoder<Prefix>): API.ToString<T, Prefix> {\n  const { bytes, version } = link\n  switch (version) {\n    case 0:\n      return toStringV0(\n        bytes,\n        baseCache(link),\n        base as API.MultibaseEncoder<'z'> ?? base58btc.encoder\n      )\n    default:\n      return toStringV1(\n        bytes,\n        baseCache(link),\n        (base ?? base32.encoder) as API.MultibaseEncoder<Prefix>\n      )\n  }\n}\n\nexport function toJSON <Link extends API.UnknownLink> (link: Link): API.LinkJSON<Link> {\n  return {\n    '/': format(link)\n  }\n}\n\nexport function fromJSON <Link extends API.UnknownLink> (json: API.LinkJSON<Link>): CID<unknown, number, number, API.Version> {\n  return CID.parse(json['/'])\n}\n\nconst cache = new WeakMap<API.UnknownLink, Map<string, string>>()\n\nfunction baseCache (cid: API.UnknownLink): Map<string, string> {\n  const baseCache = cache.get(cid)\n  if (baseCache == null) {\n    const baseCache = new Map()\n    cache.set(cid, baseCache)\n    return baseCache\n  }\n  return baseCache\n}\n\nexport class CID<Data = unknown, Format extends number = number, Alg extends number = number, Version extends API.Version = API.Version> implements API.Link<Data, Format, Alg, Version> {\n  readonly code: Format\n  readonly version: Version\n  readonly multihash: API.MultihashDigest<Alg>\n  readonly bytes: Uint8Array\n  readonly '/': Uint8Array\n\n  /**\n   * @param version - Version of the CID\n   * @param code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param multihash - (Multi)hash of the of the content.\n   */\n  constructor (version: Version, code: Format, multihash: API.MultihashDigest<Alg>, bytes: Uint8Array) {\n    this.code = code\n    this.version = version\n    this.multihash = multihash\n    this.bytes = bytes\n\n    // flag to serializers that this is a CID and\n    // should be treated specially\n    this['/'] = bytes\n  }\n\n  /**\n   * Signalling `cid.asCID === cid` has been replaced with `cid['/'] === cid.bytes`\n   * please either use `CID.asCID(cid)` or switch to new signalling mechanism\n   *\n   * @deprecated\n   */\n  get asCID (): this {\n    return this\n  }\n\n  // ArrayBufferView\n  get byteOffset (): number {\n    return this.bytes.byteOffset\n  }\n\n  // ArrayBufferView\n  get byteLength (): number {\n    return this.bytes.byteLength\n  }\n\n  toV0 (): CID<Data, API.DAG_PB, API.SHA_256, 0> {\n    switch (this.version) {\n      case 0: {\n        return this as CID<Data, API.DAG_PB, API.SHA_256, 0>\n      }\n      case 1: {\n        const { code, multihash } = this\n\n        if (code !== DAG_PB_CODE) {\n          throw new Error('Cannot convert a non dag-pb CID to CIDv0')\n        }\n\n        // sha2-256\n        if (multihash.code !== SHA_256_CODE) {\n          throw new Error('Cannot convert non sha2-256 multihash CID to CIDv0')\n        }\n\n        return (\n          CID.createV0(\n            multihash as API.MultihashDigest<API.SHA_256>\n          )\n        )\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 0. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  toV1 (): CID<Data, Format, Alg, 1> {\n    switch (this.version) {\n      case 0: {\n        const { code, digest } = this.multihash\n        const multihash = Digest.create(code, digest)\n        return (\n          CID.createV1(this.code, multihash)\n        )\n      }\n      case 1: {\n        return this as CID<Data, Format, Alg, 1>\n      }\n      default: {\n        throw Error(\n          `Can not convert CID version ${this.version} to version 1. This is a bug please report`\n        )\n      }\n    }\n  }\n\n  equals (other: unknown): other is CID<Data, Format, Alg, Version> {\n    return CID.equals(this, other)\n  }\n\n  static equals <Data, Format extends number, Alg extends number, Version extends API.Version>(self: API.Link<Data, Format, Alg, Version>, other: unknown): other is CID {\n    const unknown = other as { code?: unknown, version?: unknown, multihash?: unknown }\n    return (\n      unknown != null &&\n      self.code === unknown.code &&\n      self.version === unknown.version &&\n      Digest.equals(self.multihash, unknown.multihash)\n    )\n  }\n\n  toString (base?: API.MultibaseEncoder<string>): string {\n    return format(this, base)\n  }\n\n  toJSON (): API.LinkJSON<this> {\n    return { '/': format(this) }\n  }\n\n  link (): this {\n    return this\n  }\n\n  readonly [Symbol.toStringTag] = 'CID';\n\n  // Legacy\n\n  [Symbol.for('nodejs.util.inspect.custom')] (): string {\n    return `CID(${this.toString()})`\n  }\n\n  /**\n   * Takes any input `value` and returns a `CID` instance if it was\n   * a `CID` otherwise returns `null`. If `value` is instanceof `CID`\n   * it will return value back. If `value` is not instance of this CID\n   * class, but is compatible CID it will return new instance of this\n   * `CID` class. Otherwise returns null.\n   *\n   * This allows two different incompatible versions of CID library to\n   * co-exist and interop as long as binary interface is compatible.\n   */\n  static asCID <Data, Format extends number, Alg extends number, Version extends API.Version, U>(input: API.Link<Data, Format, Alg, Version> | U): CID<Data, Format, Alg, Version> | null {\n    if (input == null) {\n      return null\n    }\n\n    const value = input as any\n    if (value instanceof CID) {\n      // If value is instance of CID then we're all set.\n      return value\n    } else if ((value['/'] != null && value['/'] === value.bytes) || value.asCID === value) {\n      // If value isn't instance of this CID class but `this.asCID === this` or\n      // `value['/'] === value.bytes` is true it is CID instance coming from a\n      // different implementation (diff version or duplicate). In that case we\n      // rebase it to this `CID` implementation so caller is guaranteed to get\n      // instance with expected API.\n      const { version, code, multihash, bytes } = value\n      return new CID(\n        version,\n        code,\n        multihash as API.MultihashDigest<Alg>,\n        bytes ?? encodeCID(version, code, multihash.bytes)\n      )\n    } else if (value[cidSymbol] === true) {\n      // If value is a CID from older implementation that used to be tagged via\n      // symbol we still rebase it to the this `CID` implementation by\n      // delegating that to a constructor.\n      const { version, multihash, code } = value\n      const digest = Digest.decode(multihash) as API.MultihashDigest<Alg>\n      return CID.create(version, code, digest)\n    } else {\n      // Otherwise value is not a CID (or an incompatible version of it) in\n      // which case we return `null`.\n      return null\n    }\n  }\n\n  /**\n   * @param version - Version of the CID\n   * @param code - Code of the codec content is encoded in, see https://github.com/multiformats/multicodec/blob/master/table.csv\n   * @param digest - (Multi)hash of the of the content.\n   */\n  static create <Data, Format extends number, Alg extends number, Version extends API.Version>(version: Version, code: Format, digest: API.MultihashDigest<Alg>): CID<Data, Format, Alg, Version> {\n    if (typeof code !== 'number') {\n      throw new Error('String codecs are no longer supported')\n    }\n\n    if (!(digest.bytes instanceof Uint8Array)) {\n      throw new Error('Invalid digest')\n    }\n\n    switch (version) {\n      case 0: {\n        if (code !== DAG_PB_CODE) {\n          throw new Error(\n            `Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`\n          )\n        } else {\n          return new CID(version, code, digest, digest.bytes)\n        }\n      }\n      case 1: {\n        const bytes = encodeCID(version, code, digest.bytes)\n        return new CID(version, code, digest, bytes)\n      }\n      default: {\n        throw new Error('Invalid version')\n      }\n    }\n  }\n\n  /**\n   * Simplified version of `create` for CIDv0.\n   */\n  static createV0 <T = unknown>(digest: API.MultihashDigest<typeof SHA_256_CODE>): CID<T, typeof DAG_PB_CODE, typeof SHA_256_CODE, 0> {\n    return CID.create(0, DAG_PB_CODE, digest)\n  }\n\n  /**\n   * Simplified version of `create` for CIDv1.\n   *\n   * @param code - Content encoding format code.\n   * @param digest - Multihash of the content.\n   */\n  static createV1 <Data, Code extends number, Alg extends number>(code: Code, digest: API.MultihashDigest<Alg>): CID<Data, Code, Alg, 1> {\n    return CID.create(1, code, digest)\n  }\n\n  /**\n   * Decoded a CID from its binary representation. The byte array must contain\n   * only the CID with no additional bytes.\n   *\n   * An error will be thrown if the bytes provided do not contain a valid\n   * binary representation of a CID.\n   */\n  static decode <Data, Code extends number, Alg extends number, Version extends API.Version>(bytes: API.ByteView<API.Link<Data, Code, Alg, Version>>): CID<Data, Code, Alg, Version> {\n    const [cid, remainder] = CID.decodeFirst(bytes)\n    if (remainder.length !== 0) {\n      throw new Error('Incorrect length')\n    }\n    return cid\n  }\n\n  /**\n   * Decoded a CID from its binary representation at the beginning of a byte\n   * array.\n   *\n   * Returns an array with the first element containing the CID and the second\n   * element containing the remainder of the original byte array. The remainder\n   * will be a zero-length byte array if the provided bytes only contained a\n   * binary CID representation.\n   */\n  static decodeFirst <T, C extends number, A extends number, V extends API.Version>(bytes: API.ByteView<API.Link<T, C, A, V>>): [CID<T, C, A, V>, Uint8Array] {\n    const specs = CID.inspectBytes(bytes)\n    const prefixSize = specs.size - specs.multihashSize\n    const multihashBytes = coerce(\n      bytes.subarray(prefixSize, prefixSize + specs.multihashSize)\n    )\n    if (multihashBytes.byteLength !== specs.multihashSize) {\n      throw new Error('Incorrect length')\n    }\n    const digestBytes = multihashBytes.subarray(\n      specs.multihashSize - specs.digestSize\n    )\n    const digest = new Digest.Digest(\n      specs.multihashCode,\n      specs.digestSize,\n      digestBytes,\n      multihashBytes\n    )\n    const cid =\n      specs.version === 0\n        ? CID.createV0(digest as API.MultihashDigest<API.SHA_256>)\n        : CID.createV1(specs.codec, digest)\n    return [cid as CID<T, C, A, V>, bytes.subarray(specs.size)]\n  }\n\n  /**\n   * Inspect the initial bytes of a CID to determine its properties.\n   *\n   * Involves decoding up to 4 varints. Typically this will require only 4 to 6\n   * bytes but for larger multicodec code values and larger multihash digest\n   * lengths these varints can be quite large. It is recommended that at least\n   * 10 bytes be made available in the `initialBytes` argument for a complete\n   * inspection.\n   */\n  static inspectBytes <T, C extends number, A extends number, V extends API.Version>(initialBytes: API.ByteView<API.Link<T, C, A, V>>): { version: V, codec: C, multihashCode: A, digestSize: number, multihashSize: number, size: number } {\n    let offset = 0\n    const next = (): number => {\n      const [i, length] = varint.decode(initialBytes.subarray(offset))\n      offset += length\n      return i\n    }\n\n    let version = next() as V\n    let codec = DAG_PB_CODE as C\n    if (version as number === 18) {\n      // CIDv0\n      version = 0 as V\n      offset = 0\n    } else {\n      codec = next() as C\n    }\n\n    if (version !== 0 && version !== 1) {\n      throw new RangeError(`Invalid CID version ${version}`)\n    }\n\n    const prefixSize = offset\n    const multihashCode = next() as A // multihash code\n    const digestSize = next() // multihash length\n    const size = offset + digestSize\n    const multihashSize = size - prefixSize\n\n    return { version, codec, multihashCode, digestSize, multihashSize, size }\n  }\n\n  /**\n   * Takes cid in a string representation and creates an instance. If `base`\n   * decoder is not provided will use a default from the configuration. It will\n   * throw an error if encoding of the CID is not compatible with supplied (or\n   * a default decoder).\n   */\n  static parse <Prefix extends string, Data, Code extends number, Alg extends number, Version extends API.Version>(source: API.ToString<API.Link<Data, Code, Alg, Version>, Prefix>, base?: API.MultibaseDecoder<Prefix>): CID<Data, Code, Alg, Version> {\n    const [prefix, bytes] = parseCIDtoBytes(source, base)\n\n    const cid = CID.decode(bytes)\n\n    if (cid.version === 0 && source[0] !== 'Q') {\n      throw Error('Version 0 CID string must not include multibase prefix')\n    }\n\n    // Cache string representation to avoid computing it on `this.toString()`\n    baseCache(cid).set(prefix, source)\n\n    return cid\n  }\n}\n\nfunction parseCIDtoBytes <Prefix extends string, Data, Code extends number, Alg extends number, Version extends API.Version> (source: API.ToString<API.Link<Data, Code, Alg, Version>, Prefix>, base?: API.MultibaseDecoder<Prefix>): [Prefix, API.ByteView<API.Link<Data, Code, Alg, Version>>] {\n  switch (source[0]) {\n    // CIDv0 is parsed differently\n    case 'Q': {\n      const decoder = base ?? base58btc\n      return [\n        base58btc.prefix as Prefix,\n        decoder.decode(`${base58btc.prefix}${source}`)\n      ]\n    }\n    case base58btc.prefix: {\n      const decoder = base ?? base58btc\n      return [base58btc.prefix as Prefix, decoder.decode(source)]\n    }\n    case base32.prefix: {\n      const decoder = base ?? base32\n      return [base32.prefix as Prefix, decoder.decode(source)]\n    }\n    case base36.prefix: {\n      const decoder = base ?? base36\n      return [base36.prefix as Prefix, decoder.decode(source)]\n    }\n    default: {\n      if (base == null) {\n        throw Error(\n          'To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided'\n        )\n      }\n      return [source[0] as Prefix, base.decode(source)]\n    }\n  }\n}\n\nfunction toStringV0 (bytes: Uint8Array, cache: Map<string, string>, base: API.MultibaseEncoder<'z'>): string {\n  const { prefix } = base\n  if (prefix !== base58btc.prefix) {\n    throw Error(`Cannot string encode V0 in ${base.name} encoding`)\n  }\n\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes).slice(1)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\nfunction toStringV1 <Prefix extends string> (bytes: Uint8Array, cache: Map<string, string>, base: API.MultibaseEncoder<Prefix>): string {\n  const { prefix } = base\n  const cid = cache.get(prefix)\n  if (cid == null) {\n    const cid = base.encode(bytes)\n    cache.set(prefix, cid)\n    return cid\n  } else {\n    return cid\n  }\n}\n\nconst DAG_PB_CODE = 0x70\nconst SHA_256_CODE = 0x12\n\nfunction encodeCID (version: API.Version, code: number, multihash: Uint8Array): Uint8Array {\n  const codeOffset = varint.encodingLength(version)\n  const hashOffset = codeOffset + varint.encodingLength(code)\n  const bytes = new Uint8Array(hashOffset + multihash.byteLength)\n  varint.encodeTo(version, bytes, 0)\n  varint.encodeTo(code, bytes, codeOffset)\n  bytes.set(multihash, hashOffset)\n  return bytes\n}\n\nconst cidSymbol = Symbol.for('@ipld/js-cid/CID')\n", "import * as base10 from './bases/base10.js'\nimport * as base16 from './bases/base16.js'\nimport * as base2 from './bases/base2.js'\nimport * as base256emoji from './bases/base256emoji.js'\nimport * as base32 from './bases/base32.js'\nimport * as base36 from './bases/base36.js'\nimport * as base58 from './bases/base58.js'\nimport * as base64 from './bases/base64.js'\nimport * as base8 from './bases/base8.js'\nimport * as identityBase from './bases/identity.js'\nimport * as json from './codecs/json.js'\nimport * as raw from './codecs/raw.js'\nimport * as identity from './hashes/identity.js'\nimport * as sha2 from './hashes/sha2.js'\nimport { CID, hasher, digest, varint, bytes } from './index.js'\n\nexport const bases = { ...identityBase, ...base2, ...base8, ...base10, ...base16, ...base32, ...base36, ...base58, ...base64, ...base256emoji }\nexport const hashes = { ...sha2, ...identity }\nexport const codecs = { raw, json }\n\nexport { CID, hasher, digest, varint, bytes }\n", "/**\n * Returns a `Uint8Array` of the requested size. Referenced memory will\n * be initialized to 0.\n */\nexport function alloc (size: number = 0): Uint8Array {\n  return new Uint8Array(size)\n}\n\n/**\n * Where possible returns a Uint8Array of the requested size that references\n * uninitialized memory. Only use if you are certain you will immediately\n * overwrite every value in the returned `Uint8Array`.\n */\nexport function allocUnsafe (size: number = 0): Uint8Array {\n  return new Uint8Array(size)\n}\n", "import { bases } from 'multiformats/basics'\nimport type { MultibaseCodec } from 'multiformats'\nimport { allocUnsafe } from '#alloc'\n\nfunction createCodec (name: string, prefix: string, encode: (buf: Uint8Array) => string, decode: (str: string) => Uint8Array): MultibaseCodec<any> {\n  return {\n    name,\n    prefix,\n    encoder: {\n      name,\n      prefix,\n      encode\n    },\n    decoder: {\n      decode\n    }\n  }\n}\n\nconst string = createCodec('utf8', 'u', (buf) => {\n  const decoder = new TextDecoder('utf8')\n  return 'u' + decoder.decode(buf)\n}, (str) => {\n  const encoder = new TextEncoder()\n  return encoder.encode(str.substring(1))\n})\n\nconst ascii = createCodec('ascii', 'a', (buf) => {\n  let string = 'a'\n\n  for (let i = 0; i < buf.length; i++) {\n    string += String.fromCharCode(buf[i])\n  }\n  return string\n}, (str) => {\n  str = str.substring(1)\n  const buf = allocUnsafe(str.length)\n\n  for (let i = 0; i < str.length; i++) {\n    buf[i] = str.charCodeAt(i)\n  }\n\n  return buf\n})\n\nexport type SupportedEncodings = 'utf8' | 'utf-8' | 'hex' | 'latin1' | 'ascii' | 'binary' | keyof typeof bases\n\nconst BASES: Record<SupportedEncodings, MultibaseCodec<any>> = {\n  utf8: string,\n  'utf-8': string,\n  hex: bases.base16,\n  latin1: ascii,\n  ascii,\n  binary: ascii,\n\n  ...bases\n}\n\nexport default BASES\n", "import bases, { type SupportedEncodings } from './util/bases.js'\n\nexport type { SupportedEncodings }\n\n/**\n * Create a `Uint8Array` from the passed string\n *\n * Supports `utf8`, `utf-8`, `hex`, and any encoding supported by the multiformats module.\n *\n * Also `ascii` which is similar to node's 'binary' encoding.\n */\nexport function fromString (string: string, encoding: SupportedEncodings = 'utf8'): Uint8Array {\n  const base = bases[encoding]\n\n  if (base == null) {\n    throw new Error(`Unsupported encoding \"${encoding}\"`)\n  }\n\n  // add multibase prefix\n  return base.decoder.decode(`${base.prefix}${string}`) // eslint-disable-line @typescript-eslint/restrict-template-expressions\n}\n", "import bases, { type SupportedEncodings } from './util/bases.js'\n\nexport type { SupportedEncodings }\n\n/**\n * Turns a `Uint8Array` into a string.\n *\n * Supports `utf8`, `utf-8` and any encoding supported by the multibase module.\n *\n * Also `ascii` which is similar to node's 'binary' encoding.\n */\nexport function toString (array: Uint8Array, encoding: SupportedEncodings = 'utf8'): string {\n  const base = bases[encoding]\n\n  if (base == null) {\n    throw new Error(`Unsupported encoding \"${encoding}\"`)\n  }\n\n  // strip multibase prefix\n  return base.encoder.encode(array).substring(1)\n}\n", "import { fromString as uint8ArrayFromString } from 'uint8arrays/from-string'\nimport { toString as uint8ArrayToString } from 'uint8arrays/to-string'\nimport type { SupportedEncodings } from 'uint8arrays/to-string'\n\nconst pathSepS = '/'\nconst pathSepB = new TextEncoder().encode(pathSepS)\nconst pathSep = pathSepB[0]\n\n/**\n * A Key represents the unique identifier of an object.\n * Our Key scheme is inspired by file systems and Google App Engine key model.\n * Keys are meant to be unique across a system. Keys are hierarchical,\n * incorporating more and more specific namespaces. Thus keys can be deemed\n * 'children' or 'ancestors' of other keys:\n * - `new Key('/Comedy')`\n * - `new Key('/Comedy/MontyPython')`\n * Also, every namespace can be parametrized to embed relevant object\n * information. For example, the Key `name` (most specific namespace) could\n * include the object type:\n * - `new Key('/Comedy/MontyPython/Actor:JohnCleese')`\n * - `new Key('/Comedy/MontyPython/Sketch:CheeseShop')`\n * - `new Key('/Comedy/MontyPython/Sketch:CheeseShop/Character:Mousebender')`\n *\n */\nexport class Key {\n  private _buf: Uint8Array\n\n  /**\n   * @param {string | Uint8Array} s\n   * @param {boolean} [clean]\n   */\n  constructor (s: string | Uint8Array, clean?: boolean) {\n    if (typeof s === 'string') {\n      this._buf = uint8ArrayFromString(s)\n    } else if (s instanceof Uint8Array) {\n      this._buf = s\n    } else {\n      throw new Error('Invalid key, should be String of Uint8Array')\n    }\n\n    if (clean == null) {\n      clean = true\n    }\n\n    if (clean) {\n      this.clean()\n    }\n\n    if (this._buf.byteLength === 0 || this._buf[0] !== pathSep) {\n      throw new Error('Invalid key')\n    }\n  }\n\n  /**\n   * Convert to the string representation\n   *\n   * @param {import('uint8arrays/to-string').SupportedEncodings} [encoding] - The encoding to use.\n   * @returns {string}\n   */\n  toString (encoding: SupportedEncodings = 'utf8'): string {\n    return uint8ArrayToString(this._buf, encoding)\n  }\n\n  /**\n   * Return the Uint8Array representation of the key\n   *\n   * @returns {Uint8Array}\n   */\n  uint8Array (): Uint8Array {\n    return this._buf\n  }\n\n  /**\n   * Return string representation of the key\n   *\n   * @returns {string}\n   */\n  get [Symbol.toStringTag] (): string {\n    return `Key(${this.toString()})`\n  }\n\n  /**\n   * Constructs a key out of a namespace array.\n   *\n   * @param {Array<string>} list - The array of namespaces\n   * @returns {Key}\n   *\n   * @example\n   * ```js\n   * Key.withNamespaces(['one', 'two'])\n   * // => Key('/one/two')\n   * ```\n   */\n  static withNamespaces (list: string[]): Key {\n    return new Key(list.join(pathSepS))\n  }\n\n  /**\n   * Returns a randomly (uuid) generated key.\n   *\n   * @returns {Key}\n   *\n   * @example\n   * ```js\n   * Key.random()\n   * // => Key('/344502982398')\n   * ```\n   */\n  static random (): Key {\n    return new Key(Math.random().toString().substring(2))\n  }\n\n  /**\n   * @param {*} other\n   */\n  static asKey (other: any): Key | null {\n    if (other instanceof Uint8Array || typeof other === 'string') {\n      // we can create a key from this\n      return new Key(other)\n    }\n\n    if (typeof other.uint8Array === 'function') {\n      // this is an older version or may have crossed the esm/cjs boundary\n      return new Key(other.uint8Array())\n    }\n\n    return null\n  }\n\n  /**\n   * Cleanup the current key\n   *\n   * @returns {void}\n   */\n  clean (): void {\n    if (this._buf == null || this._buf.byteLength === 0) {\n      this._buf = pathSepB\n    }\n\n    if (this._buf[0] !== pathSep) {\n      const bytes = new Uint8Array(this._buf.byteLength + 1)\n      bytes.fill(pathSep, 0, 1)\n      bytes.set(this._buf, 1)\n      this._buf = bytes\n    }\n\n    // normalize does not remove trailing slashes\n    while (this._buf.byteLength > 1 && this._buf[this._buf.byteLength - 1] === pathSep) {\n      this._buf = this._buf.subarray(0, -1)\n    }\n  }\n\n  /**\n   * Check if the given key is sorted lower than ourself.\n   *\n   * @param {Key} key - The other Key to check against\n   * @returns {boolean}\n   */\n  less (key: Key): boolean {\n    const list1 = this.list()\n    const list2 = key.list()\n\n    for (let i = 0; i < list1.length; i++) {\n      if (list2.length < i + 1) {\n        return false\n      }\n\n      const c1 = list1[i]\n      const c2 = list2[i]\n\n      if (c1 < c2) {\n        return true\n      } else if (c1 > c2) {\n        return false\n      }\n    }\n\n    return list1.length < list2.length\n  }\n\n  /**\n   * Returns the key with all parts in reversed order.\n   *\n   * @returns {Key}\n   *\n   * @example\n   * ```js\n   * new Key('/Comedy/MontyPython/Actor:JohnCleese').reverse()\n   * // => Key('/Actor:JohnCleese/MontyPython/Comedy')\n   * ```\n   */\n  reverse (): Key {\n    return Key.withNamespaces(this.list().slice().reverse())\n  }\n\n  /**\n   * Returns the `namespaces` making up this Key.\n   *\n   * @returns {Array<string>}\n   */\n  namespaces (): string[] {\n    return this.list()\n  }\n\n  /**\n   * Returns the \"base\" namespace of this key.\n   *\n   * @returns {string}\n   *\n   * @example\n   * ```js\n   * new Key('/Comedy/MontyPython/Actor:JohnCleese').baseNamespace()\n   * // => 'Actor:JohnCleese'\n   * ```\n   */\n  baseNamespace (): string {\n    const ns = this.namespaces()\n    return ns[ns.length - 1]\n  }\n\n  /**\n   * Returns the `list` representation of this key.\n   *\n   * @returns {Array<string>}\n   *\n   * @example\n   * ```js\n   * new Key('/Comedy/MontyPython/Actor:JohnCleese').list()\n   * // => ['Comedy', 'MontyPythong', 'Actor:JohnCleese']\n   * ```\n   */\n  list (): string[] {\n    return this.toString().split(pathSepS).slice(1)\n  }\n\n  /**\n   * Returns the \"type\" of this key (value of last namespace).\n   *\n   * @returns {string}\n   *\n   * @example\n   * ```js\n   * new Key('/Comedy/MontyPython/Actor:JohnCleese').type()\n   * // => 'Actor'\n   * ```\n   */\n  type (): string {\n    return namespaceType(this.baseNamespace())\n  }\n\n  /**\n   * Returns the \"name\" of this key (field of last namespace).\n   *\n   * @returns {string}\n   *\n   * @example\n   * ```js\n   * new Key('/Comedy/MontyPython/Actor:JohnCleese').name()\n   * // => 'JohnCleese'\n   * ```\n   */\n  name (): string {\n    return namespaceValue(this.baseNamespace())\n  }\n\n  /**\n   * Returns an \"instance\" of this type key (appends value to namespace).\n   *\n   * @param {string} s - The string to append.\n   * @returns {Key}\n   *\n   * @example\n   * ```js\n   * new Key('/Comedy/MontyPython/Actor').instance('JohnClesse')\n   * // => Key('/Comedy/MontyPython/Actor:JohnCleese')\n   * ```\n   */\n  instance (s: string): Key {\n    return new Key(this.toString() + ':' + s)\n  }\n\n  /**\n   * Returns the \"path\" of this key (parent + type).\n   *\n   * @returns {Key}\n   *\n   * @example\n   * ```js\n   * new Key('/Comedy/MontyPython/Actor:JohnCleese').path()\n   * // => Key('/Comedy/MontyPython/Actor')\n   * ```\n   */\n  path (): Key {\n    let p = this.parent().toString()\n    if (!p.endsWith(pathSepS)) {\n      p += pathSepS\n    }\n    p += this.type()\n    return new Key(p)\n  }\n\n  /**\n   * Returns the `parent` Key of this Key.\n   *\n   * @returns {Key}\n   *\n   * @example\n   * ```js\n   * new Key(\"/Comedy/MontyPython/Actor:JohnCleese\").parent()\n   * // => Key(\"/Comedy/MontyPython\")\n   * ```\n   */\n  parent (): Key {\n    const list = this.list()\n    if (list.length === 1) {\n      return new Key(pathSepS)\n    }\n\n    return new Key(list.slice(0, -1).join(pathSepS))\n  }\n\n  /**\n   * Returns the `child` Key of this Key.\n   *\n   * @param {Key} key - The child Key to add\n   * @returns {Key}\n   *\n   * @example\n   * ```js\n   * new Key('/Comedy/MontyPython').child(new Key('Actor:JohnCleese'))\n   * // => Key('/Comedy/MontyPython/Actor:JohnCleese')\n   * ```\n   */\n  child (key: Key): Key {\n    if (this.toString() === pathSepS) {\n      return key\n    } else if (key.toString() === pathSepS) {\n      return this\n    }\n\n    return new Key(this.toString() + key.toString(), false)\n  }\n\n  /**\n   * Returns whether this key is a prefix of `other`\n   *\n   * @param {Key} other - The other key to test against\n   * @returns {boolean}\n   *\n   * @example\n   * ```js\n   * new Key('/Comedy').isAncestorOf('/Comedy/MontyPython')\n   * // => true\n   * ```\n   */\n  isAncestorOf (other: Key): boolean {\n    if (other.toString() === this.toString()) {\n      return false\n    }\n\n    return other.toString().startsWith(this.toString())\n  }\n\n  /**\n   * Returns whether this key is a contains another as prefix.\n   *\n   * @param {Key} other - The other Key to test against\n   * @returns {boolean}\n   *\n   * @example\n   * ```js\n   * new Key('/Comedy/MontyPython').isDecendantOf('/Comedy')\n   * // => true\n   * ```\n   */\n  isDecendantOf (other: Key): boolean {\n    if (other.toString() === this.toString()) {\n      return false\n    }\n\n    return this.toString().startsWith(other.toString())\n  }\n\n  /**\n   * Checks if this key has only one namespace.\n   *\n   * @returns {boolean}\n   */\n  isTopLevel (): boolean {\n    return this.list().length === 1\n  }\n\n  /**\n   * Concats one or more Keys into one new Key.\n   *\n   * @param {Array<Key>} keys - The array of keys to concatenate\n   * @returns {Key}\n   */\n  concat (...keys: Key[]): Key {\n    return Key.withNamespaces([...this.namespaces(), ...flatten(keys.map(key => key.namespaces()))])\n  }\n}\n\n/**\n * The first component of a namespace. `foo` in `foo:bar`\n *\n * @param {string} ns\n * @returns {string}\n */\nfunction namespaceType (ns: string): string {\n  const parts = ns.split(':')\n  if (parts.length < 2) {\n    return ''\n  }\n  return parts.slice(0, -1).join(':')\n}\n\n/**\n * The last component of a namespace, `baz` in `foo:bar:baz`.\n *\n * @param {string} ns\n * @returns {string}\n */\nfunction namespaceValue (ns: string): string {\n  const parts = ns.split(':')\n  return parts[parts.length - 1]\n}\n\n/**\n * Flatten array of arrays (only one level)\n *\n * @template T\n * @param {Array<any>} arr\n * @returns {T[]}\n */\nfunction flatten (arr: any[]): string[] {\n  return ([]).concat(...arr)\n}\n", "/**\n * @packageDocumentation\n *\n * Mostly useful for tests or when you want to be explicit about consuming an iterable without doing anything with any yielded values.\n *\n * @example\n *\n * ```javascript\n * import drain from 'it-drain'\n *\n * // This can also be an iterator, generator, etc\n * const values = [0, 1, 2, 3, 4]\n *\n * drain(values)\n * ```\n *\n * Async sources must be awaited:\n *\n * ```javascript\n * import drain from 'it-drain'\n *\n * const values = async function * {\n *   yield * [0, 1, 2, 3, 4]\n * }\n *\n * await drain(values())\n * ```\n */\n\nfunction isAsyncIterable <T> (thing: any): thing is AsyncIterable<T> {\n  return thing[Symbol.asyncIterator] != null\n}\n\n/**\n * Drains an (async) iterable discarding its' content and does not return\n * anything\n */\nfunction drain (source: Iterable<unknown>): void\nfunction drain (source: Iterable<unknown> | AsyncIterable<unknown>): Promise<void>\nfunction drain (source: Iterable<unknown> | AsyncIterable<unknown>): Promise<void> | void {\n  if (isAsyncIterable(source)) {\n    return (async () => {\n      for await (const _ of source) { } // eslint-disable-line no-unused-vars,no-empty,@typescript-eslint/no-unused-vars\n    })()\n  } else {\n    for (const _ of source) { } // eslint-disable-line no-unused-vars,no-empty,@typescript-eslint/no-unused-vars\n  }\n}\n\nexport default drain\n", "/**\n * @packageDocumentation\n *\n * Lets you look at the contents of an async iterator and decide what to do\n *\n * @example\n *\n * ```javascript\n * import peekable from 'it-peekable'\n *\n * // This can also be an iterator, generator, etc\n * const values = [0, 1, 2, 3, 4]\n *\n * const it = peekable(value)\n *\n * const first = it.peek()\n *\n * console.info(first) // 0\n *\n * it.push(first)\n *\n * console.info([...it])\n * // [ 0, 1, 2, 3, 4 ]\n * ```\n *\n * Async sources must be awaited:\n *\n * ```javascript\n * import peekable from 'it-peekable'\n *\n * const values = async function * () {\n *   yield * [0, 1, 2, 3, 4]\n * }\n *\n * const it = peekable(values())\n *\n * const first = await it.peek()\n *\n * console.info(first) // 0\n *\n * it.push(first)\n *\n * console.info(await all(it))\n * // [ 0, 1, 2, 3, 4 ]\n * ```\n */\n\nexport interface Peek <T> {\n  peek(): IteratorResult<T, undefined>\n}\n\nexport interface AsyncPeek <T> {\n  peek(): Promise<IteratorResult<T, undefined>>\n}\n\nexport interface Push <T> {\n  push(value: T): void\n}\n\nexport type Peekable <T> = Iterable<T> & Peek<T> & Push<T> & Iterator<T>\n\nexport type AsyncPeekable <T> = AsyncIterable<T> & AsyncPeek<T> & Push<T> & AsyncIterator<T>\n\nfunction peekable <T> (iterable: Iterable<T>): Peekable<T>\nfunction peekable <T> (iterable: AsyncIterable<T>): AsyncPeekable<T>\nfunction peekable <T> (iterable: Iterable<T> | AsyncIterable<T>): Peekable<T> | AsyncPeekable<T> {\n  // @ts-expect-error can't use Symbol.asyncIterator to index iterable since it might be Iterable\n  const [iterator, symbol] = iterable[Symbol.asyncIterator] != null\n    // @ts-expect-error can't use Symbol.asyncIterator to index iterable since it might be Iterable\n    ? [iterable[Symbol.asyncIterator](), Symbol.asyncIterator]\n    // @ts-expect-error can't use Symbol.iterator to index iterable since it might be AsyncIterable\n    : [iterable[Symbol.iterator](), Symbol.iterator]\n\n  const queue: any[] = []\n\n  // @ts-expect-error can't use symbol to index peekable\n  return {\n    peek: () => {\n      return iterator.next()\n    },\n    push: (value: any) => {\n      queue.push(value)\n    },\n    next: () => {\n      if (queue.length > 0) {\n        return {\n          done: false,\n          value: queue.shift()\n        }\n      }\n\n      return iterator.next()\n    },\n    [symbol] () {\n      return this\n    }\n  }\n}\n\nexport default peekable\n", "/**\n * @packageDocumentation\n *\n * Filter values out of an (async)iterable\n *\n * @example\n *\n * ```javascript\n * import all from 'it-all'\n * import filter from 'it-filter'\n *\n * // This can also be an iterator, generator, etc\n * const values = [0, 1, 2, 3, 4]\n *\n * const fn = (val, index) => val > 2 // Return boolean to keep item\n *\n * const arr = all(filter(values, fn))\n *\n * console.info(arr) // 3, 4\n * ```\n *\n * Async sources and filter functions must be awaited:\n *\n * ```javascript\n * import all from 'it-all'\n * import filter from 'it-filter'\n *\n * const values = async function * () {\n *   yield * [0, 1, 2, 3, 4]\n * }\n *\n * const fn = async val => (val, index) > 2 // Return boolean or promise of boolean to keep item\n *\n * const arr = await all(filter(values, fn))\n *\n * console.info(arr) // 3, 4\n * ```\n */\n\nimport peek from 'it-peekable'\n\nfunction isAsyncIterable <T> (thing: any): thing is AsyncIterable<T> {\n  return thing[Symbol.asyncIterator] != null\n}\n\n/**\n * Filters the passed (async) iterable by using the filter function\n */\nfunction filter <T> (source: Iterable<T>, fn: (val: T, index: number) => Promise<boolean>): AsyncGenerator<T, void, undefined>\nfunction filter <T> (source: Iterable<T>, fn: (val: T, index: number) => boolean): Generator<T, void, undefined>\nfunction filter <T> (source: Iterable<T> | AsyncIterable<T>, fn: (val: T, index: number) => boolean | Promise<boolean>): AsyncGenerator<T, void, undefined>\nfunction filter <T> (source: Iterable<T> | AsyncIterable<T>, fn: (val: T, index: number) => boolean | Promise<boolean>): Generator<T, void, undefined> | AsyncGenerator<T, void, undefined> {\n  let index = 0\n\n  if (isAsyncIterable(source)) {\n    return (async function * () {\n      for await (const entry of source) {\n        if (await fn(entry, index++)) {\n          yield entry\n        }\n      }\n    })()\n  }\n\n  // if mapping function returns a promise we have to return an async generator\n  const peekable = peek(source)\n  const { value, done } = peekable.next()\n\n  if (done === true) {\n    return (function * () {}())\n  }\n\n  const res = fn(value, index++)\n\n  // @ts-expect-error .then is not present on O\n  if (typeof res.then === 'function') {\n    return (async function * () {\n      if (await res) {\n        yield value\n      }\n\n      for await (const entry of peekable) {\n        if (await fn(entry, index++)) {\n          yield entry\n        }\n      }\n    })()\n  }\n\n  const func = fn as (val: T, index: number) => boolean\n\n  return (function * () {\n    if (res === true) {\n      yield value\n    }\n\n    for (const entry of peekable) {\n      if (func(entry, index++)) {\n        yield entry\n      }\n    }\n  })()\n}\n\nexport default filter\n", "/**\n * @packageDocumentation\n *\n * For when you need a one-liner to collect iterable values.\n *\n * @example\n *\n * ```javascript\n * import all from 'it-all'\n *\n * // This can also be an iterator, etc\n * const values = function * () {\n *   yield * [0, 1, 2, 3, 4]\n * }\n *\n * const arr = all(values)\n *\n * console.info(arr) // 0, 1, 2, 3, 4\n * ```\n *\n * Async sources must be awaited:\n *\n * ```javascript\n * const values = async function * () {\n *   yield * [0, 1, 2, 3, 4]\n * }\n *\n * const arr = await all(values())\n *\n * console.info(arr) // 0, 1, 2, 3, 4\n * ```\n */\n\nfunction isAsyncIterable <T> (thing: any): thing is AsyncIterable<T> {\n  return thing[Symbol.asyncIterator] != null\n}\n\n/**\n * Collects all values from an (async) iterable and returns them as an array\n */\nfunction all <T> (source: Iterable<T>): T[]\nfunction all <T> (source: Iterable<T> | AsyncIterable<T>): Promise<T[]>\nfunction all <T> (source: Iterable<T> | AsyncIterable<T>): Promise<T[]> | T[] {\n  if (isAsyncIterable(source)) {\n    return (async () => {\n      const arr = []\n\n      for await (const entry of source) {\n        arr.push(entry)\n      }\n\n      return arr\n    })()\n  }\n\n  const arr = []\n\n  for (const entry of source) {\n    arr.push(entry)\n  }\n\n  return arr\n}\n\nexport default all\n", "/**\n * @packageDocumentation\n *\n * Consumes all values from an (async)iterable and returns them sorted by the passed sort function.\n *\n * @example\n *\n * ```javascript\n * import sort from 'it-sort'\n * import all from 'it-all'\n *\n * const sorter = (a, b) => {\n *   return a.localeCompare(b)\n * }\n *\n * // This can also be an iterator, generator, etc\n * const values = ['foo', 'bar']\n *\n * const arr = all(sort(values, sorter))\n *\n * console.info(arr) // 'bar', 'foo'\n * ```\n *\n * Async sources must be awaited:\n *\n * ```javascript\n * import sort from 'it-sort'\n * import all from 'it-all'\n *\n * const sorter = (a, b) => {\n *   return a.localeCompare(b)\n * }\n *\n * const values = async function * () {\n *   yield * ['foo', 'bar']\n * }\n *\n * const arr = await all(sort(values, sorter))\n *\n * console.info(arr) // 'bar', 'foo'\n * ```\n */\n\nimport all from 'it-all'\n\nfunction isAsyncIterable <T> (thing: any): thing is AsyncIterable<T> {\n  return thing[Symbol.asyncIterator] != null\n}\n\nexport interface CompareFunction<T> {\n  (a: T, b: T): number\n}\n\n/**\n * Collects all values from an async iterator, sorts them\n * using the passed function and yields them\n */\nfunction sort <T> (source: Iterable<T>, sorter: CompareFunction<T>): Generator<T, void, undefined>\nfunction sort <T> (source: Iterable<T> | AsyncIterable<T>, sorter: CompareFunction<T>): AsyncGenerator<T, void, undefined>\nfunction sort <T> (source: Iterable<T> | AsyncIterable<T>, sorter: CompareFunction<T>): AsyncGenerator<T, void, undefined> | Generator<T, void, undefined> {\n  if (isAsyncIterable(source)) {\n    return (async function * () {\n      const arr = await all(source)\n\n      yield * arr.sort(sorter)\n    })()\n  }\n\n  return (function * () {\n    const arr = all(source)\n\n    yield * arr.sort(sorter)\n  })()\n}\n\nexport default sort\n", "/**\n * @packageDocumentation\n *\n * For when you only want a few values out of an (async)iterable.\n *\n * @example\n *\n * ```javascript\n * import take from 'it-take'\n * import all from 'it-all'\n *\n * // This can also be an iterator, generator, etc\n * const values = [0, 1, 2, 3, 4]\n *\n * const arr = all(take(values, 2))\n *\n * console.info(arr) // 0, 1\n * ```\n *\n * Async sources must be awaited:\n *\n * ```javascript\n * import take from 'it-take'\n * import all from 'it-all'\n *\n * const values = async function * () {\n *   yield * [0, 1, 2, 3, 4]\n * }\n *\n * const arr = await all(take(values(), 2))\n *\n * console.info(arr) // 0, 1\n * ```\n */\n\nfunction isAsyncIterable <T> (thing: any): thing is AsyncIterable<T> {\n  return thing[Symbol.asyncIterator] != null\n}\n\n/**\n * Stop iteration after n items have been received\n */\nfunction take <T> (source: Iterable<T>, limit: number): Generator<T, void, undefined>\nfunction take <T> (source: Iterable<T> | AsyncIterable<T>, limit: number): AsyncGenerator<T, void, undefined>\nfunction take <T> (source: Iterable<T> | AsyncIterable<T>, limit: number): AsyncGenerator<T, void, undefined> | Generator<T, void, undefined> {\n  if (isAsyncIterable(source)) {\n    return (async function * () {\n      let items = 0\n\n      if (limit < 1) {\n        return\n      }\n\n      for await (const entry of source) {\n        yield entry\n\n        items++\n\n        if (items === limit) {\n          return\n        }\n      }\n    })()\n  }\n\n  return (function * () {\n    let items = 0\n\n    if (limit < 1) {\n      return\n    }\n\n    for (const entry of source) {\n      yield entry\n\n      items++\n\n      if (items === limit) {\n        return\n      }\n    }\n  })()\n}\n\nexport default take\n", "import drain from 'it-drain'\nimport filter from 'it-filter'\nimport sort from 'it-sort'\nimport take from 'it-take'\nimport type { Batch, Datastore, Key, KeyQuery, Pair, Query } from 'interface-datastore'\nimport type { AbortOptions, Await, AwaitIterable } from 'interface-store'\n\nexport class BaseDatastore implements Datastore {\n  put (key: Key, val: Uint8Array, options?: AbortOptions): Await<Key> {\n    return Promise.reject(new Error('.put is not implemented'))\n  }\n\n  get (key: Key, options?: AbortOptions): Await<Uint8Array> {\n    return Promise.reject(new Error('.get is not implemented'))\n  }\n\n  has (key: Key, options?: AbortOptions): Await<boolean> {\n    return Promise.reject(new Error('.has is not implemented'))\n  }\n\n  delete (key: Key, options?: AbortOptions): Await<void> {\n    return Promise.reject(new Error('.delete is not implemented'))\n  }\n\n  async * putMany (source: AwaitIterable<Pair>, options: AbortOptions = {}): AwaitIterable<Key> {\n    for await (const { key, value } of source) {\n      await this.put(key, value, options)\n      yield key\n    }\n  }\n\n  async * getMany (source: AwaitIterable<Key>, options: AbortOptions = {}): AwaitIterable<Pair> {\n    for await (const key of source) {\n      yield {\n        key,\n        value: await this.get(key, options)\n      }\n    }\n  }\n\n  async * deleteMany (source: AwaitIterable<Key>, options: AbortOptions = {}): AwaitIterable<Key> {\n    for await (const key of source) {\n      await this.delete(key, options)\n      yield key\n    }\n  }\n\n  batch (): Batch {\n    let puts: Pair[] = []\n    let dels: Key[] = []\n\n    return {\n      put (key, value) {\n        puts.push({ key, value })\n      },\n\n      delete (key) {\n        dels.push(key)\n      },\n      commit: async (options) => {\n        await drain(this.putMany(puts, options))\n        puts = []\n        await drain(this.deleteMany(dels, options))\n        dels = []\n      }\n    }\n  }\n\n  /**\n   * Extending classes should override `query` or implement this method\n   */\n  // eslint-disable-next-line require-yield\n  async * _all (q: Query, options?: AbortOptions): AwaitIterable<Pair> {\n    throw new Error('._all is not implemented')\n  }\n\n  /**\n   * Extending classes should override `queryKeys` or implement this method\n   */\n  // eslint-disable-next-line require-yield\n  async * _allKeys (q: KeyQuery, options?: AbortOptions): AwaitIterable<Key> {\n    throw new Error('._allKeys is not implemented')\n  }\n\n  query (q: Query, options?: AbortOptions): AwaitIterable<Pair> {\n    let it = this._all(q, options)\n\n    if (q.prefix != null) {\n      const prefix = q.prefix\n      it = filter(it, (e) => e.key.toString().startsWith(prefix))\n    }\n\n    if (Array.isArray(q.filters)) {\n      it = q.filters.reduce((it, f) => filter(it, f), it)\n    }\n\n    if (Array.isArray(q.orders)) {\n      it = q.orders.reduce((it, f) => sort(it, f), it)\n    }\n\n    if (q.offset != null) {\n      let i = 0\n      const offset = q.offset\n      it = filter(it, () => i++ >= offset)\n    }\n\n    if (q.limit != null) {\n      it = take(it, q.limit)\n    }\n\n    return it\n  }\n\n  queryKeys (q: KeyQuery, options?: AbortOptions): AwaitIterable<Key> {\n    let it = this._allKeys(q, options)\n\n    if (q.prefix != null) {\n      const prefix = q.prefix\n      it = filter(it, (key) =>\n        key.toString().startsWith(prefix)\n      )\n    }\n\n    if (Array.isArray(q.filters)) {\n      it = q.filters.reduce((it, f) => filter(it, f), it)\n    }\n\n    if (Array.isArray(q.orders)) {\n      it = q.orders.reduce((it, f) => sort(it, f), it)\n    }\n\n    if (q.offset != null) {\n      const offset = q.offset\n      let i = 0\n      it = filter(it, () => i++ >= offset)\n    }\n\n    if (q.limit != null) {\n      it = take(it, q.limit)\n    }\n\n    return it\n  }\n}\n", "export class OpenFailedError extends Error {\n  static name = 'OpenFailedError'\n  static code = 'ERR_OPEN_FAILED'\n  name = OpenFailedError.name\n  code = OpenFailedError.code\n\n  constructor (message = 'Open failed') {\n    super(message)\n  }\n}\n\nexport class CloseFailedError extends Error {\n  static name = 'CloseFailedError'\n  static code = 'ERR_CLOSE_FAILED'\n  name = CloseFailedError.name\n  code = CloseFailedError.code\n\n  constructor (message = 'Close failed') {\n    super(message)\n  }\n}\n\nexport class PutFailedError extends Error {\n  static name = 'PutFailedError'\n  static code = 'ERR_PUT_FAILED'\n  name = PutFailedError.name\n  code = PutFailedError.code\n\n  constructor (message = 'Put failed') {\n    super(message)\n  }\n}\n\nexport class GetFailedError extends Error {\n  static name = 'GetFailedError'\n  static code = 'ERR_GET_FAILED'\n  name = GetFailedError.name\n  code = GetFailedError.code\n\n  constructor (message = 'Get failed') {\n    super(message)\n  }\n}\n\nexport class DeleteFailedError extends Error {\n  static name = 'DeleteFailedError'\n  static code = 'ERR_DELETE_FAILED'\n  name = DeleteFailedError.name\n  code = DeleteFailedError.code\n\n  constructor (message = 'Delete failed') {\n    super(message)\n  }\n}\n\nexport class HasFailedError extends Error {\n  static name = 'HasFailedError'\n  static code = 'ERR_HAS_FAILED'\n  name = HasFailedError.name\n  code = HasFailedError.code\n\n  constructor (message = 'Has failed') {\n    super(message)\n  }\n}\n\nexport class NotFoundError extends Error {\n  static name = 'NotFoundError'\n  static code = 'ERR_NOT_FOUND'\n  name = NotFoundError.name\n  code = NotFoundError.code\n\n  constructor (message = 'Not Found') {\n    super(message)\n  }\n}\n\nexport class AbortError extends Error {\n  static name = 'AbortError'\n  static code = 'ERR_ABORTED'\n  name = AbortError.name\n  code = AbortError.code\n\n  constructor (message = 'Aborted') {\n    super(message)\n  }\n}\n", "import { Key } from 'interface-datastore/key'\nimport { NotFoundError } from 'interface-store'\nimport { BaseDatastore } from './base.js'\nimport type { KeyQuery, Pair, Query } from 'interface-datastore'\nimport type { AbortOptions, Await, AwaitIterable } from 'interface-store'\n\nexport class MemoryDatastore extends BaseDatastore {\n  private readonly data: Map<string, Uint8Array>\n\n  constructor () {\n    super()\n\n    this.data = new Map()\n  }\n\n  put (key: Key, val: Uint8Array, options?: AbortOptions): Await<Key> {\n    options?.signal?.throwIfAborted()\n\n    this.data.set(key.toString(), val)\n\n    return key\n  }\n\n  get (key: Key, options?: AbortOptions): Await<Uint8Array> {\n    options?.signal?.throwIfAborted()\n\n    const result = this.data.get(key.toString())\n\n    if (result == null) {\n      throw new NotFoundError()\n    }\n\n    return result\n  }\n\n  has (key: Key, options?: AbortOptions): Await<boolean> {\n    options?.signal?.throwIfAborted()\n    return this.data.has(key.toString())\n  }\n\n  delete (key: Key, options?: AbortOptions): Await<void> {\n    options?.signal?.throwIfAborted()\n    this.data.delete(key.toString())\n  }\n\n  * _all (q: Query, options?: AbortOptions): AwaitIterable<Pair> {\n    options?.signal?.throwIfAborted()\n    for (const [key, value] of this.data.entries()) {\n      yield { key: new Key(key), value }\n      options?.signal?.throwIfAborted()\n    }\n  }\n\n  * _allKeys (q: KeyQuery, options?: AbortOptions): AwaitIterable<Key> {\n    options?.signal?.throwIfAborted()\n    for (const key of this.data.keys()) {\n      yield new Key(key)\n      options?.signal?.throwIfAborted()\n    }\n  }\n}\n", "/**\n * @packageDocumentation\n *\n * Convert one value from an (async)iterator into another.\n *\n * @example\n *\n * ```javascript\n * import map from 'it-map'\n *\n * // This can also be an iterator, generator, etc\n * const values = [0, 1, 2, 3, 4]\n *\n * const result = map(values, (val, index) => val++)\n *\n * console.info(result) // [1, 2, 3, 4, 5]\n * ```\n *\n * Async sources and transforms must be awaited:\n *\n * ```javascript\n * import map from 'it-map'\n *\n * const values = async function * () {\n *   yield * [0, 1, 2, 3, 4]\n * }\n *\n * const result = await map(values(), async (val, index) => val++)\n *\n * console.info(result) // [1, 2, 3, 4, 5]\n * ```\n */\n\nimport peek from 'it-peekable'\n\nfunction isAsyncIterable <T> (thing: any): thing is AsyncIterable<T> {\n  return thing[Symbol.asyncIterator] != null\n}\n\n/**\n * Takes an (async) iterable and returns one with each item mapped by the passed\n * function\n */\nfunction map <I, O> (source: Iterable<I>, func: (val: I, index: number) => Promise<O>): AsyncGenerator<O, void, undefined>\nfunction map <I, O> (source: Iterable<I>, func: (val: I, index: number) => O): Generator<O, void, undefined>\nfunction map <I, O> (source: AsyncIterable<I> | Iterable<I>, func: (val: I, index: number) => O | Promise<O>): AsyncGenerator<O, void, undefined>\nfunction map <I, O> (source: AsyncIterable<I> | Iterable<I>, func: (val: I, index: number) => O | Promise<O>): AsyncGenerator<O, void, undefined> | Generator<O, void, undefined> {\n  let index = 0\n\n  if (isAsyncIterable(source)) {\n    return (async function * () {\n      for await (const val of source) {\n        yield func(val, index++)\n      }\n    })()\n  }\n\n  // if mapping function returns a promise we have to return an async generator\n  const peekable = peek(source)\n  const { value, done } = peekable.next()\n\n  if (done === true) {\n    return (function * () {}())\n  }\n\n  const res = func(value, index++)\n\n  // @ts-expect-error .then is not present on O\n  if (typeof res.then === 'function') {\n    return (async function * () {\n      yield await res\n\n      for await (const val of peekable) {\n        yield func(val, index++)\n      }\n    })()\n  }\n\n  const fn = func as (val: I, index: number) => O\n\n  return (function * () {\n    yield res as O\n\n    for (const val of peekable) {\n      yield fn(val, index++)\n    }\n  })()\n}\n\nexport default map\n", "export default function pDefer() {\n\tconst deferred = {};\n\n\tdeferred.promise = new Promise((resolve, reject) => {\n\t\tdeferred.resolve = resolve;\n\t\tdeferred.reject = reject;\n\t});\n\n\treturn deferred;\n}\n", "// ported from https://www.npmjs.com/package/fast-fifo\n\nexport interface Next<T> {\n  done?: boolean\n  error?: Error\n  value?: T\n}\n\nclass FixedFIFO<T> {\n  public buffer: Array<Next<T> | undefined>\n  private readonly mask: number\n  private top: number\n  private btm: number\n  public next: FixedFIFO<T> | null\n\n  constructor (hwm: number) {\n    if (!(hwm > 0) || ((hwm - 1) & hwm) !== 0) {\n      throw new Error('Max size for a FixedFIFO should be a power of two')\n    }\n\n    this.buffer = new Array(hwm)\n    this.mask = hwm - 1\n    this.top = 0\n    this.btm = 0\n    this.next = null\n  }\n\n  push (data: Next<T>): boolean {\n    if (this.buffer[this.top] !== undefined) {\n      return false\n    }\n\n    this.buffer[this.top] = data\n    this.top = (this.top + 1) & this.mask\n\n    return true\n  }\n\n  shift (): Next<T> | undefined {\n    const last = this.buffer[this.btm]\n\n    if (last === undefined) {\n      return undefined\n    }\n\n    this.buffer[this.btm] = undefined\n    this.btm = (this.btm + 1) & this.mask\n    return last\n  }\n\n  isEmpty (): boolean {\n    return this.buffer[this.btm] === undefined\n  }\n}\n\nexport interface FIFOOptions {\n  /**\n   * When the queue reaches this size, it will be split into head/tail parts\n   */\n  splitLimit?: number\n}\n\nexport class FIFO<T> {\n  public size: number\n  private readonly hwm: number\n  private head: FixedFIFO<T>\n  private tail: FixedFIFO<T>\n\n  constructor (options: FIFOOptions = {}) {\n    this.hwm = options.splitLimit ?? 16\n    this.head = new FixedFIFO<T>(this.hwm)\n    this.tail = this.head\n    this.size = 0\n  }\n\n  calculateSize (obj: any): number {\n    if (obj?.byteLength != null) {\n      return obj.byteLength\n    }\n\n    return 1\n  }\n\n  push (val: Next<T>): void {\n    if (val?.value != null) {\n      this.size += this.calculateSize(val.value)\n    }\n\n    if (!this.head.push(val)) {\n      const prev = this.head\n      this.head = prev.next = new FixedFIFO<T>(2 * this.head.buffer.length)\n      this.head.push(val)\n    }\n  }\n\n  shift (): Next<T> | undefined {\n    let val = this.tail.shift()\n\n    if (val === undefined && (this.tail.next != null)) {\n      const next = this.tail.next\n      this.tail.next = null\n      this.tail = next\n      val = this.tail.shift()\n    }\n\n    if (val?.value != null) {\n      this.size -= this.calculateSize(val.value)\n    }\n\n    return val\n  }\n\n  isEmpty (): boolean {\n    return this.head.isEmpty()\n  }\n}\n", "/**\n * @packageDocumentation\n *\n * An iterable that you can push values into.\n *\n * @example\n *\n * ```js\n * import { pushable } from 'it-pushable'\n *\n * const source = pushable()\n *\n * setTimeout(() => source.push('hello'), 100)\n * setTimeout(() => source.push('world'), 200)\n * setTimeout(() => source.end(), 300)\n *\n * const start = Date.now()\n *\n * for await (const value of source) {\n *   console.log(`got \"${value}\" after ${Date.now() - start}ms`)\n * }\n * console.log(`done after ${Date.now() - start}ms`)\n *\n * // Output:\n * // got \"hello\" after 105ms\n * // got \"world\" after 207ms\n * // done after 309ms\n * ```\n *\n * @example\n *\n * ```js\n * import { pushableV } from 'it-pushable'\n * import all from 'it-all'\n *\n * const source = pushableV()\n *\n * source.push(1)\n * source.push(2)\n * source.push(3)\n * source.end()\n *\n * console.info(await all(source))\n *\n * // Output:\n * // [ [1, 2, 3] ]\n * ```\n */\n\nimport deferred from 'p-defer'\nimport { FIFO, type Next } from './fifo.js'\n\nexport class AbortError extends Error {\n  type: string\n  code: string\n\n  constructor (message?: string, code?: string) {\n    super(message ?? 'The operation was aborted')\n    this.type = 'aborted'\n    this.code = code ?? 'ABORT_ERR'\n  }\n}\n\nexport interface AbortOptions {\n  signal?: AbortSignal\n}\n\ninterface BasePushable<T> {\n  /**\n   * End the iterable after all values in the buffer (if any) have been yielded. If an\n   * error is passed the buffer is cleared immediately and the next iteration will\n   * throw the passed error\n   */\n  end(err?: Error): this\n\n  /**\n   * Push a value into the iterable. Values are yielded from the iterable in the order\n   * they are pushed. Values not yet consumed from the iterable are buffered.\n   */\n  push(value: T): this\n\n  /**\n   * Returns a promise that resolves when the underlying queue becomes empty (e.g.\n   * this.readableLength === 0).\n   *\n   * If an AbortSignal is passed as an option and that signal aborts, it only\n   * causes the returned promise to reject - it does not end the pushable.\n   */\n  onEmpty(options?: AbortOptions): Promise<void>\n\n  /**\n   * This property contains the number of bytes (or objects) in the queue ready to be read.\n   *\n   * If `objectMode` is true, this is the number of objects in the queue, if false it's the\n   * total number of bytes in the queue.\n   */\n  readableLength: number\n}\n\n/**\n * An iterable that you can push values into.\n */\nexport interface Pushable<T, R = void, N = unknown> extends AsyncGenerator<T, R, N>, BasePushable<T> {}\n\n/**\n * Similar to `pushable`, except it yields multiple buffered chunks at a time. All values yielded from the iterable will be arrays.\n */\nexport interface PushableV<T, R = void, N = unknown> extends AsyncGenerator<T[], R, N>, BasePushable<T> {}\n\nexport interface Options {\n  /**\n   * A boolean value that means non-`Uint8Array`s will be passed to `.push`, default: `false`\n   */\n  objectMode?: boolean\n\n  /**\n   * A function called after *all* values have been yielded from the iterator (including\n   * buffered values). In the case when the iterator is ended with an error it will be\n   * passed the error as a parameter.\n   */\n  onEnd?(err?: Error): void\n}\n\nexport interface DoneResult { done: true }\nexport interface ValueResult<T> { done: false, value: T }\nexport type NextResult<T> = ValueResult<T> | DoneResult\n\ninterface getNext<T, V = T> { (buffer: FIFO<T>): NextResult<V> }\n\nexport interface ObjectPushableOptions extends Options {\n  objectMode: true\n}\n\nexport interface BytePushableOptions extends Options {\n  objectMode?: false\n}\n\n/**\n * Create a new async iterable. The values yielded from calls to `.next()`\n * or when used in a `for await of`loop are \"pushed\" into the iterable.\n * Returns an async iterable object with additional methods.\n */\nexport function pushable<T extends { byteLength: number } = Uint8Array> (options?: BytePushableOptions): Pushable<T>\nexport function pushable<T> (options: ObjectPushableOptions): Pushable<T>\nexport function pushable<T> (options: Options = {}): Pushable<T> {\n  const getNext = (buffer: FIFO<T>): NextResult<T> => {\n    const next: Next<T> | undefined = buffer.shift()\n\n    if (next == null) {\n      return { done: true }\n    }\n\n    if (next.error != null) {\n      throw next.error\n    }\n\n    return {\n      done: next.done === true,\n      // @ts-expect-error if done is false, value will be present\n      value: next.value\n    }\n  }\n\n  return _pushable<T, T, Pushable<T>>(getNext, options)\n}\n\nexport function pushableV<T extends { byteLength: number } = Uint8Array> (options?: BytePushableOptions): PushableV<T>\nexport function pushableV<T> (options: ObjectPushableOptions): PushableV<T>\nexport function pushableV<T> (options: Options = {}): PushableV<T> {\n  const getNext = (buffer: FIFO<T>): NextResult<T[]> => {\n    let next: Next<T> | undefined\n    const values: T[] = []\n\n    while (!buffer.isEmpty()) {\n      next = buffer.shift()\n\n      if (next == null) {\n        break\n      }\n\n      if (next.error != null) {\n        throw next.error\n      }\n\n      if (next.done === false) {\n        // @ts-expect-error if done is false value should be pushed\n        values.push(next.value)\n      }\n    }\n\n    if (next == null) {\n      return { done: true }\n    }\n\n    return {\n      done: next.done === true,\n      value: values\n    }\n  }\n\n  return _pushable<T, T[], PushableV<T>>(getNext, options)\n}\n\nfunction _pushable<PushType, ValueType, ReturnType> (getNext: getNext<PushType, ValueType>, options?: Options): ReturnType {\n  options = options ?? {}\n  let onEnd = options.onEnd\n  let buffer = new FIFO<PushType>()\n  let pushable: any\n  let onNext: ((next: Next<PushType>) => ReturnType) | null\n  let ended: boolean\n  let drain = deferred()\n\n  const waitNext = async (): Promise<NextResult<ValueType>> => {\n    try {\n      if (!buffer.isEmpty()) {\n        return getNext(buffer)\n      }\n\n      if (ended) {\n        return { done: true }\n      }\n\n      return await new Promise<NextResult<ValueType>>((resolve, reject) => {\n        onNext = (next: Next<PushType>) => {\n          onNext = null\n          buffer.push(next)\n\n          try {\n            resolve(getNext(buffer))\n          } catch (err) {\n            reject(err)\n          }\n\n          return pushable\n        }\n      })\n    } finally {\n      if (buffer.isEmpty()) {\n        // settle promise in the microtask queue to give consumers a chance to\n        // await after calling .push\n        queueMicrotask(() => {\n          drain.resolve()\n          drain = deferred()\n        })\n      }\n    }\n  }\n\n  const bufferNext = (next: Next<PushType>): ReturnType => {\n    if (onNext != null) {\n      return onNext(next)\n    }\n\n    buffer.push(next)\n    return pushable\n  }\n\n  const bufferError = (err: Error): ReturnType => {\n    buffer = new FIFO()\n\n    if (onNext != null) {\n      return onNext({ error: err })\n    }\n\n    buffer.push({ error: err })\n    return pushable\n  }\n\n  const push = (value: PushType): ReturnType => {\n    if (ended) {\n      return pushable\n    }\n\n    // @ts-expect-error `byteLength` is not declared on PushType\n    if (options?.objectMode !== true && value?.byteLength == null) {\n      throw new Error('objectMode was not true but tried to push non-Uint8Array value')\n    }\n\n    return bufferNext({ done: false, value })\n  }\n  const end = (err?: Error): ReturnType => {\n    if (ended) return pushable\n    ended = true\n\n    return (err != null) ? bufferError(err) : bufferNext({ done: true })\n  }\n  const _return = (): DoneResult => {\n    buffer = new FIFO()\n    end()\n\n    return { done: true }\n  }\n  const _throw = (err: Error): DoneResult => {\n    end(err)\n\n    return { done: true }\n  }\n\n  pushable = {\n    [Symbol.asyncIterator] () { return this },\n    next: waitNext,\n    return: _return,\n    throw: _throw,\n    push,\n    end,\n    get readableLength (): number {\n      return buffer.size\n    },\n    onEmpty: async (options?: AbortOptions) => {\n      const signal = options?.signal\n      signal?.throwIfAborted()\n\n      if (buffer.isEmpty()) {\n        return\n      }\n\n      let cancel: Promise<void> | undefined\n      let listener: (() => void) | undefined\n\n      if (signal != null) {\n        cancel = new Promise((resolve, reject) => {\n          listener = () => {\n            reject(new AbortError())\n          }\n\n          signal.addEventListener('abort', listener)\n        })\n      }\n\n      try {\n        await Promise.race([\n          drain.promise,\n          cancel\n        ])\n      } finally {\n        if (listener != null && signal != null) {\n          signal?.removeEventListener('abort', listener)\n        }\n      }\n    }\n  }\n\n  if (onEnd == null) {\n    return pushable\n  }\n\n  const _pushable = pushable\n\n  pushable = {\n    [Symbol.asyncIterator] () { return this },\n    next () {\n      return _pushable.next()\n    },\n    throw (err: Error) {\n      _pushable.throw(err)\n\n      if (onEnd != null) {\n        onEnd(err)\n        onEnd = undefined\n      }\n\n      return { done: true }\n    },\n    return () {\n      _pushable.return()\n\n      if (onEnd != null) {\n        onEnd()\n        onEnd = undefined\n      }\n\n      return { done: true }\n    },\n    push,\n    end (err: Error) {\n      _pushable.end(err)\n\n      if (onEnd != null) {\n        onEnd(err)\n        onEnd = undefined\n      }\n\n      return pushable\n    },\n    get readableLength () {\n      return _pushable.readableLength\n    },\n    onEmpty: (opts?: AbortOptions) => {\n      return _pushable.onEmpty(opts)\n    }\n  }\n\n  return pushable\n}\n", "/**\n * An abort error class that extends error\n */\nexport class AbortError extends Error {\n  public type: string\n  public code: string | string\n\n  constructor (message?: string, code?: string, name?: string) {\n    super(message ?? 'The operation was aborted')\n    this.type = 'aborted'\n    this.name = name ?? 'AbortError'\n    this.code = code ?? 'ABORT_ERR'\n  }\n}\n\nexport interface RaceSignalOptions {\n  /**\n   * The message for the error thrown if the signal aborts\n   */\n  errorMessage?: string\n\n  /**\n   * The code for the error thrown if the signal aborts\n   */\n  errorCode?: string\n\n  /**\n   * The name for the error thrown if the signal aborts\n   */\n  errorName?: string\n}\n\n/**\n * Race a promise against an abort signal\n */\nexport async function raceSignal <T> (promise: Promise<T>, signal?: AbortSignal, opts?: RaceSignalOptions): Promise<T> {\n  if (signal == null) {\n    return promise\n  }\n\n  if (signal.aborted) {\n    // the passed promise may yet resolve or reject but the use has signalled\n    // they are no longer interested so smother the error\n    promise.catch(() => {})\n    return Promise.reject(new AbortError(opts?.errorMessage, opts?.errorCode, opts?.errorName))\n  }\n\n  let listener\n\n  // create the error here so we have more context in the stack trace\n  const error = new AbortError(opts?.errorMessage, opts?.errorCode, opts?.errorName)\n\n  try {\n    return await Promise.race([\n      promise,\n      new Promise<T>((resolve, reject) => {\n        listener = () => {\n          reject(error)\n        }\n        signal.addEventListener('abort', listener)\n      })\n    ])\n  } finally {\n    if (listener != null) {\n      signal.removeEventListener('abort', listener)\n    }\n  }\n}\n", "/**\n * @packageDocumentation\n *\n * A pushable async generator that waits until the current value is consumed\n * before allowing a new value to be pushed.\n *\n * Useful for when you don't want to keep memory usage under control and/or\n * allow a downstream consumer to dictate how fast data flows through a pipe,\n * but you want to be able to apply a transform to that data.\n *\n * @example\n *\n * ```typescript\n * import { queuelessPushable } from 'it-queueless-pushable'\n *\n * const pushable = queuelessPushable<string>()\n *\n * // run asynchronously\n * Promise.resolve().then(async () => {\n *   // push a value - the returned promise will not resolve until the value is\n *   // read from the pushable\n *   await pushable.push('hello')\n * })\n *\n * // read a value\n * const result = await pushable.next()\n * console.info(result) // { done: false, value: 'hello' }\n * ```\n */\n\nimport deferred from 'p-defer'\nimport { raceSignal } from 'race-signal'\nimport type { AbortOptions } from 'abort-error'\nimport type { DeferredPromise } from 'p-defer'\nimport type { RaceSignalOptions } from 'race-signal'\n\nexport interface Pushable<T> extends AsyncGenerator<T, void, unknown> {\n  /**\n   * End the iterable after all values in the buffer (if any) have been yielded. If an\n   * error is passed the buffer is cleared immediately and the next iteration will\n   * throw the passed error\n   */\n  end(err?: Error, options?: AbortOptions & RaceSignalOptions): Promise<void>\n\n  /**\n   * Push a value into the iterable. Values are yielded from the iterable in the order\n   * they are pushed. Values not yet consumed from the iterable are buffered.\n   */\n  push(value: T, options?: AbortOptions & RaceSignalOptions): Promise<void>\n}\n\nclass QueuelessPushable <T> implements Pushable<T> {\n  private readNext: DeferredPromise<void>\n  private haveNext: DeferredPromise<void>\n  private ended: boolean\n  private nextResult: IteratorResult<T> | undefined\n  private error?: Error\n\n  constructor () {\n    this.ended = false\n\n    this.readNext = deferred()\n    this.haveNext = deferred()\n  }\n\n  [Symbol.asyncIterator] (): AsyncGenerator<T, void, unknown> {\n    return this\n  }\n\n  async next (): Promise<IteratorResult<T, void>> {\n    if (this.nextResult == null) {\n      // wait for the supplier to push a value\n      await this.haveNext.promise\n    }\n\n    if (this.nextResult == null) {\n      throw new Error('HaveNext promise resolved but nextResult was undefined')\n    }\n\n    const nextResult = this.nextResult\n    this.nextResult = undefined\n\n    // signal to the supplier that we read the value\n    this.readNext.resolve()\n    this.readNext = deferred()\n\n    return nextResult\n  }\n\n  async throw (err?: Error): Promise<IteratorReturnResult<undefined>> {\n    this.ended = true\n    this.error = err\n\n    if (err != null) {\n      // this can cause unhandled promise rejections if nothing is awaiting the\n      // next value so attach a dummy catch listener to the promise\n      this.haveNext.promise.catch(() => {})\n      this.haveNext.reject(err)\n    }\n\n    const result: IteratorReturnResult<undefined> = {\n      done: true,\n      value: undefined\n    }\n\n    return result\n  }\n\n  async return (): Promise<IteratorResult<T>> {\n    const result: IteratorReturnResult<undefined> = {\n      done: true,\n      value: undefined\n    }\n\n    this.ended = true\n    this.nextResult = result\n\n    // let the consumer know we have a new value\n    this.haveNext.resolve()\n\n    return result\n  }\n\n  async push (value: T, options?: AbortOptions & RaceSignalOptions): Promise<void> {\n    await this._push(value, options)\n  }\n\n  async end (err?: Error, options?: AbortOptions & RaceSignalOptions): Promise<void> {\n    if (err != null) {\n      await this.throw(err)\n    } else {\n      // abortable return\n      await this._push(undefined, options)\n    }\n  }\n\n  private async _push (value?: T, options?: AbortOptions & RaceSignalOptions): Promise<void> {\n    if (value != null && this.ended) {\n      throw this.error ?? new Error('Cannot push value onto an ended pushable')\n    }\n\n    // wait for all values to be read\n    while (this.nextResult != null) {\n      await this.readNext.promise\n    }\n\n    if (value != null) {\n      this.nextResult = { done: false, value }\n    } else {\n      this.ended = true\n      this.nextResult = { done: true, value: undefined }\n    }\n\n    // let the consumer know we have a new value\n    this.haveNext.resolve()\n    this.haveNext = deferred()\n\n    // wait for the consumer to have finished processing the value and requested\n    // the next one or for the passed signal to abort the waiting\n    await raceSignal(\n      this.readNext.promise,\n      options?.signal,\n      options\n    )\n  }\n}\n\nexport function queuelessPushable <T> (): Pushable<T> {\n  return new QueuelessPushable<T>()\n}\n", "/**\n * @packageDocumentation\n *\n * Merge several (async)iterables into one, yield values as they arrive.\n *\n * Nb. sources are iterated over in parallel so the order of emitted items is not guaranteed.\n *\n * @example\n *\n * ```javascript\n * import merge from 'it-merge'\n * import all from 'it-all'\n *\n * // This can also be an iterator, generator, etc\n * const values1 = [0, 1, 2, 3, 4]\n * const values2 = [5, 6, 7, 8, 9]\n *\n * const arr = all(merge(values1, values2))\n *\n * console.info(arr) // 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\n * ```\n *\n * Async sources must be awaited:\n *\n * ```javascript\n * import merge from 'it-merge'\n * import all from 'it-all'\n *\n * // This can also be an iterator, async iterator, generator, etc\n * const values1 = async function * () {\n *   yield * [0, 1, 2, 3, 4]\n * }\n * const values2 = async function * () {\n *   yield * [5, 6, 7, 8, 9]\n * }\n *\n * const arr = await all(merge(values1(), values2()))\n *\n * console.info(arr) // 0, 1, 5, 6, 2, 3, 4, 7, 8, 9  <- nb. order is not guaranteed\n * ```\n */\n\nimport { queuelessPushable } from 'it-queueless-pushable'\nimport type { Pushable } from 'it-queueless-pushable'\n\nfunction isAsyncIterable <T> (thing: any): thing is AsyncIterable<T> {\n  return thing[Symbol.asyncIterator] != null\n}\n\nasync function addAllToPushable <T> (sources: Array<AsyncIterable<T> | Iterable<T>>, output: Pushable<T>, signal: AbortSignal): Promise<void> {\n  try {\n    await Promise.all(\n      sources.map(async (source) => {\n        for await (const item of source) {\n          await output.push(item, {\n            signal\n          })\n          signal.throwIfAborted()\n        }\n      })\n    )\n\n    await output.end(undefined, {\n      signal\n    })\n  } catch (err: any) {\n    await output.end(err, {\n      signal\n    })\n      .catch(() => {})\n  }\n}\n\nasync function * mergeSources <T> (sources: Array<AsyncIterable<T> | Iterable<T>>): AsyncGenerator<T, void, undefined> {\n  const controller = new AbortController()\n  const output = queuelessPushable<T>()\n\n  addAllToPushable(sources, output, controller.signal)\n    .catch(() => {})\n\n  try {\n    yield * output\n  } finally {\n    controller.abort()\n  }\n}\n\nfunction * mergeSyncSources <T> (syncSources: Array<Iterable<T>>): Generator<T, void, undefined> {\n  for (const source of syncSources) {\n    yield * source\n  }\n}\n\n/**\n * Treat one or more iterables as a single iterable.\n *\n * Nb. sources are iterated over in parallel so the\n * order of emitted items is not guaranteed.\n */\nfunction merge <T> (...sources: Array<Iterable<T>>): Generator<T, void, undefined>\nfunction merge <T> (...sources: Array<AsyncIterable<T> | Iterable<T>>): AsyncGenerator<T, void, undefined>\nfunction merge <T> (...sources: Array<AsyncIterable<T> | Iterable<T>>): AsyncGenerator<T, void, undefined> | Generator<T, void, undefined> {\n  const syncSources: Array<Iterable<T>> = []\n\n  for (const source of sources) {\n    if (!isAsyncIterable(source)) {\n      syncSources.push(source)\n    }\n  }\n\n  if (syncSources.length === sources.length) {\n    // all sources are synchronous\n    return mergeSyncSources(syncSources)\n  }\n\n  return mergeSources(sources)\n}\n\nexport default merge\n", "import { pushable } from 'it-pushable'\nimport merge from 'it-merge'\nimport type { Duplex, Transform, Sink } from 'it-stream-types'\n\ninterface SourceFn<A = any> { (): A }\n\ntype PipeSource<A = any> =\n  Iterable<A> |\n  AsyncIterable<A> |\n  SourceFn<A> |\n  Duplex<A, any, any>\n\ntype PipeTransform<A = any, B = any> =\n  Transform<A, B> |\n  Duplex<B, A>\n\ntype PipeSink<A = any, B = any> =\n  Sink<A, B> |\n  Duplex<any, A, B>\n\ntype PipeOutput<A> =\n  A extends Sink<any> ? ReturnType<A> :\n    A extends Duplex<any, any, any> ? ReturnType<A['sink']> :\n      never\n\n// single item pipe output includes pipe source types\ntype SingleItemPipeOutput<A> =\n  A extends Iterable<any> ? A :\n    A extends AsyncIterable<any> ? A :\n      A extends SourceFn ? ReturnType<A> :\n        A extends Duplex<any, any, any> ? A['source'] :\n          PipeOutput<A>\n\ntype PipeFnInput<A> =\n  A extends Iterable<any> ? A :\n    A extends AsyncIterable<any> ? A :\n      A extends SourceFn ? ReturnType<A> :\n        A extends Transform<any, any> ? ReturnType<A> :\n          A extends Duplex<any, any, any> ? A['source'] :\n            never\n\n// one item, just a pass-through\nexport function pipe<\n  A extends PipeSource\n> (\n  source: A\n): SingleItemPipeOutput<A>\n\n// two items, source to sink\nexport function pipe<\n  A extends PipeSource,\n  B extends PipeSink<PipeFnInput<A>>\n> (\n  source: A,\n  sink: B\n): PipeOutput<B>\n\n// three items, source to sink with transform(s) in between\nexport function pipe<\n  A extends PipeSource,\n  B extends PipeTransform<PipeFnInput<A>>,\n  C extends PipeSink<PipeFnInput<B>>\n> (\n  source: A,\n  transform1: B,\n  sink: C\n): PipeOutput<C>\n\n// many items, source to sink with transform(s) in between\nexport function pipe<\n  A extends PipeSource,\n  B extends PipeTransform<PipeFnInput<A>>,\n  C extends PipeTransform<PipeFnInput<B>>,\n  D extends PipeSink<PipeFnInput<C>>\n> (\n  source: A,\n  transform1: B,\n  transform2: C,\n  sink: D\n): PipeOutput<D>\n\n// lots of items, source to sink with transform(s) in between\nexport function pipe<\n  A extends PipeSource,\n  B extends PipeTransform<PipeFnInput<A>>,\n  C extends PipeTransform<PipeFnInput<B>>,\n  D extends PipeTransform<PipeFnInput<C>>,\n  E extends PipeSink<PipeFnInput<D>>\n> (\n  source: A,\n  transform1: B,\n  transform2: C,\n  transform3: D,\n  sink: E\n): PipeOutput<E>\n\n// lots of items, source to sink with transform(s) in between\nexport function pipe<\n  A extends PipeSource,\n  B extends PipeTransform<PipeFnInput<A>>,\n  C extends PipeTransform<PipeFnInput<B>>,\n  D extends PipeTransform<PipeFnInput<C>>,\n  E extends PipeTransform<PipeFnInput<D>>,\n  F extends PipeSink<PipeFnInput<E>>\n> (\n  source: A,\n  transform1: B,\n  transform2: C,\n  transform3: D,\n  transform4: E,\n  sink: F\n): PipeOutput<F>\n\n// lots of items, source to sink with transform(s) in between\nexport function pipe<\n  A extends PipeSource,\n  B extends PipeTransform<PipeFnInput<A>>,\n  C extends PipeTransform<PipeFnInput<B>>,\n  D extends PipeTransform<PipeFnInput<C>>,\n  E extends PipeTransform<PipeFnInput<D>>,\n  F extends PipeTransform<PipeFnInput<E>>,\n  G extends PipeSink<PipeFnInput<F>>\n> (\n  source: A,\n  transform1: B,\n  transform2: C,\n  transform3: D,\n  transform4: E,\n  transform5: F,\n  sink: G\n): PipeOutput<G>\n\n// lots of items, source to sink with transform(s) in between\nexport function pipe<\n  A extends PipeSource,\n  B extends PipeTransform<PipeFnInput<A>>,\n  C extends PipeTransform<PipeFnInput<B>>,\n  D extends PipeTransform<PipeFnInput<C>>,\n  E extends PipeTransform<PipeFnInput<D>>,\n  F extends PipeTransform<PipeFnInput<E>>,\n  G extends PipeTransform<PipeFnInput<F>>,\n  H extends PipeSink<PipeFnInput<G>>\n> (\n  source: A,\n  transform1: B,\n  transform2: C,\n  transform3: D,\n  transform4: E,\n  transform5: F,\n  transform6: G,\n  sink: H\n): PipeOutput<H>\n\n// lots of items, source to sink with transform(s) in between\nexport function pipe<\n  A extends PipeSource,\n  B extends PipeTransform<PipeFnInput<A>>,\n  C extends PipeTransform<PipeFnInput<B>>,\n  D extends PipeTransform<PipeFnInput<C>>,\n  E extends PipeTransform<PipeFnInput<D>>,\n  F extends PipeTransform<PipeFnInput<E>>,\n  G extends PipeTransform<PipeFnInput<F>>,\n  H extends PipeTransform<PipeFnInput<G>>,\n  I extends PipeSink<PipeFnInput<H>>\n> (\n  source: A,\n  transform1: B,\n  transform2: C,\n  transform3: D,\n  transform4: E,\n  transform5: F,\n  transform6: G,\n  transform7: H,\n  sink: I\n): PipeOutput<I>\n\n// lots of items, source to sink with transform(s) in between\nexport function pipe<\n  A extends PipeSource,\n  B extends PipeTransform<PipeFnInput<A>>,\n  C extends PipeTransform<PipeFnInput<B>>,\n  D extends PipeTransform<PipeFnInput<C>>,\n  E extends PipeTransform<PipeFnInput<D>>,\n  F extends PipeTransform<PipeFnInput<E>>,\n  G extends PipeTransform<PipeFnInput<F>>,\n  H extends PipeTransform<PipeFnInput<G>>,\n  I extends PipeTransform<PipeFnInput<H>>,\n  J extends PipeSink<PipeFnInput<I>>\n> (\n  source: A,\n  transform1: B,\n  transform2: C,\n  transform3: D,\n  transform4: E,\n  transform5: F,\n  transform6: G,\n  transform7: H,\n  transform8: I,\n  sink: J\n): PipeOutput<J>\n\n// lots of items, source to sink with transform(s) in between\nexport function pipe<\n  A extends PipeSource,\n  B extends PipeTransform<PipeFnInput<A>>,\n  C extends PipeTransform<PipeFnInput<B>>,\n  D extends PipeTransform<PipeFnInput<C>>,\n  E extends PipeTransform<PipeFnInput<D>>,\n  F extends PipeTransform<PipeFnInput<E>>,\n  G extends PipeTransform<PipeFnInput<F>>,\n  H extends PipeTransform<PipeFnInput<G>>,\n  I extends PipeTransform<PipeFnInput<H>>,\n  J extends PipeTransform<PipeFnInput<I>>,\n  K extends PipeSink<PipeFnInput<J>>\n> (\n  source: A,\n  transform1: B,\n  transform2: C,\n  transform3: D,\n  transform4: E,\n  transform5: F,\n  transform6: G,\n  transform7: H,\n  transform8: I,\n  transform9: J,\n  sink: K\n): PipeOutput<K>\n\n// lots of items, source to sink with transform(s) in between\nexport function pipe<\n  A extends PipeSource,\n  B extends PipeTransform<PipeFnInput<A>>,\n  C extends PipeTransform<PipeFnInput<B>>,\n  D extends PipeTransform<PipeFnInput<C>>,\n  E extends PipeTransform<PipeFnInput<D>>,\n  F extends PipeTransform<PipeFnInput<E>>,\n  G extends PipeTransform<PipeFnInput<F>>,\n  H extends PipeTransform<PipeFnInput<G>>,\n  I extends PipeTransform<PipeFnInput<H>>,\n  J extends PipeTransform<PipeFnInput<I>>,\n  K extends PipeTransform<PipeFnInput<J>>,\n  L extends PipeSink<PipeFnInput<K>>\n> (\n  source: A,\n  transform1: B,\n  transform2: C,\n  transform3: D,\n  transform4: E,\n  transform5: F,\n  transform6: G,\n  transform7: H,\n  transform8: I,\n  transform9: J,\n  transform10: K,\n  sink: L\n): PipeOutput<L>\n\nexport function pipe (first: any, ...rest: any[]): any {\n  if (first == null) {\n    throw new Error('Empty pipeline')\n  }\n\n  // Duplex at start: wrap in function and return duplex source\n  if (isDuplex(first)) {\n    const duplex = first\n    first = () => duplex.source\n  // Iterable at start: wrap in function\n  } else if (isIterable(first) || isAsyncIterable(first)) {\n    const source = first\n    first = () => source\n  }\n\n  const fns = [first, ...rest]\n\n  if (fns.length > 1) {\n    // Duplex at end: use duplex sink\n    if (isDuplex(fns[fns.length - 1])) {\n      fns[fns.length - 1] = fns[fns.length - 1].sink\n    }\n  }\n\n  if (fns.length > 2) {\n    // Duplex in the middle, consume source with duplex sink and return duplex source\n    for (let i = 1; i < fns.length - 1; i++) {\n      if (isDuplex(fns[i])) {\n        fns[i] = duplexPipelineFn(fns[i])\n      }\n    }\n  }\n\n  return rawPipe(...fns)\n}\n\nexport const rawPipe = (...fns: any): any => {\n  let res\n  while (fns.length > 0) {\n    res = fns.shift()(res)\n  }\n  return res\n}\n\nconst isAsyncIterable = (obj: any): obj is AsyncIterable<unknown> => {\n  return obj?.[Symbol.asyncIterator] != null\n}\n\nconst isIterable = (obj: any): obj is Iterable<unknown> => {\n  return obj?.[Symbol.iterator] != null\n}\n\nconst isDuplex = (obj: any): obj is Duplex => {\n  if (obj == null) {\n    return false\n  }\n\n  return obj.sink != null && obj.source != null\n}\n\nconst duplexPipelineFn = (duplex: Duplex<any, any, any>) => {\n  return (source: any) => {\n    const p = duplex.sink(source)\n\n    if (p?.then != null) {\n      const stream = pushable<any>({\n        objectMode: true\n      })\n      p.then(() => {\n        stream.end()\n      }, (err: Error) => {\n        stream.end(err)\n      })\n\n      let sourceWrap: () => Iterable<any> | AsyncIterable<any>\n      const source = duplex.source\n\n      if (isAsyncIterable(source)) {\n        sourceWrap = async function * () {\n          yield * source\n          stream.end()\n        }\n      } else if (isIterable(source)) {\n        sourceWrap = function * () {\n          yield * source\n          stream.end()\n        }\n      } else {\n        throw new Error('Unknown duplex source type - must be Iterable or AsyncIterable')\n      }\n\n      return merge(stream, sourceWrap())\n    }\n\n    return duplex.source\n  }\n}\n", "import map from 'it-map'\nimport { pipe } from 'it-pipe'\nimport { BaseDatastore } from './base.js'\nimport type { KeyTransform } from './index.js'\nimport type { Batch, Datastore, Key, KeyQuery, Pair, Query } from 'interface-datastore'\nimport type { AbortOptions, AwaitIterable } from 'interface-store'\n\n/**\n * A datastore shim, that wraps around a given datastore, changing\n * the way keys look to the user, for example namespacing\n * keys, reversing them, etc.\n */\nexport class KeyTransformDatastore extends BaseDatastore {\n  private readonly child: Datastore\n  public transform: KeyTransform\n\n  constructor (child: Datastore, transform: KeyTransform) {\n    super()\n\n    this.child = child\n    this.transform = transform\n  }\n\n  async put (key: Key, val: Uint8Array, options?: AbortOptions): Promise<Key> {\n    await this.child.put(this.transform.convert(key), val, options)\n\n    return key\n  }\n\n  async get (key: Key, options?: AbortOptions): Promise<Uint8Array> {\n    return this.child.get(this.transform.convert(key), options)\n  }\n\n  async has (key: Key, options?: AbortOptions): Promise<boolean> {\n    return this.child.has(this.transform.convert(key), options)\n  }\n\n  async delete (key: Key, options?: AbortOptions): Promise<void> {\n    await this.child.delete(this.transform.convert(key), options)\n  }\n\n  async * putMany (source: AwaitIterable<Pair>, options: AbortOptions = {}): AsyncIterable<Key> {\n    const transform = this.transform\n    const child = this.child\n\n    yield * pipe(\n      source,\n      async function * (source) {\n        yield * map(source, ({ key, value }) => ({\n          key: transform.convert(key),\n          value\n        }))\n      },\n      async function * (source) {\n        yield * child.putMany(source, options)\n      },\n      async function * (source) {\n        yield * map(source, key => transform.invert(key))\n      }\n    )\n  }\n\n  async * getMany (source: AwaitIterable<Key>, options: AbortOptions = {}): AsyncIterable<Pair> {\n    const transform = this.transform\n    const child = this.child\n\n    yield * pipe(\n      source,\n      async function * (source) {\n        yield * map(source, key => transform.convert(key))\n      },\n      async function * (source) {\n        yield * child.getMany(source, options)\n      },\n      async function * (source) {\n        yield * map(source, ({ key, value }) => ({\n          key: transform.invert(key),\n          value\n        }))\n      }\n    )\n  }\n\n  async * deleteMany (source: AwaitIterable<Key>, options: AbortOptions = {}): AsyncIterable<Key> {\n    const transform = this.transform\n    const child = this.child\n\n    yield * pipe(\n      source,\n      async function * (source) {\n        yield * map(source, key => transform.convert(key))\n      },\n      async function * (source) {\n        yield * child.deleteMany(source, options)\n      },\n      async function * (source) {\n        yield * map(source, key => transform.invert(key))\n      }\n    )\n  }\n\n  batch (): Batch {\n    const b = this.child.batch()\n    return {\n      put: (key, value) => {\n        b.put(this.transform.convert(key), value)\n      },\n      delete: (key) => {\n        b.delete(this.transform.convert(key))\n      },\n      commit: async (options) => {\n        await b.commit(options)\n      }\n    }\n  }\n\n  query (q: Query, options?: AbortOptions): AsyncIterable<Pair> {\n    const query: Query = {\n      ...q\n    }\n\n    query.filters = (query.filters ?? []).map(filter => {\n      return ({ key, value }) => filter({ key: this.transform.convert(key), value })\n    })\n\n    const { prefix } = q\n    if (prefix != null && prefix !== '/') {\n      delete query.prefix\n      query.filters.push(({ key }) => {\n        return this.transform.invert(key).toString().startsWith(prefix)\n      })\n    }\n\n    if (query.orders != null) {\n      query.orders = query.orders.map(order => {\n        return (a, b) => order(\n          { key: this.transform.invert(a.key), value: a.value },\n          { key: this.transform.invert(b.key), value: b.value }\n        )\n      })\n    }\n\n    return map(this.child.query(query, options), ({ key, value }) => {\n      return {\n        key: this.transform.invert(key),\n        value\n      }\n    })\n  }\n\n  queryKeys (q: KeyQuery, options?: AbortOptions): AsyncIterable<Key> {\n    const query = {\n      ...q\n    }\n\n    query.filters = (query.filters ?? []).map(filter => {\n      return (key) => filter(this.transform.convert(key))\n    })\n\n    const { prefix } = q\n    if (prefix != null && prefix !== '/') {\n      delete query.prefix\n      query.filters.push((key) => {\n        return this.transform.invert(key).toString().startsWith(prefix)\n      })\n    }\n\n    if (query.orders != null) {\n      query.orders = query.orders.map(order => {\n        return (a, b) => order(\n          this.transform.invert(a),\n          this.transform.invert(b)\n        )\n      })\n    }\n\n    return map(this.child.queryKeys(query, options), key => {\n      return this.transform.invert(key)\n    })\n  }\n}\n", "import { Key } from 'interface-datastore'\nimport { OpenFailedError } from 'interface-store'\nimport { BaseDatastore } from './base.js'\nimport { KeyTransformDatastore } from './keytransform.js'\nimport {\n  readShardFun,\n  SHARDING_FN\n} from './shard.js'\nimport type { Shard } from './index.js'\nimport type { Batch, KeyQuery, KeyQueryFilter, Pair, Query, QueryFilter, Datastore } from 'interface-datastore'\nimport type { AbortOptions, AwaitIterable } from 'interface-store'\n\nconst shardKey = new Key(SHARDING_FN)\n\n/**\n * Backend independent abstraction of go-ds-flatfs.\n *\n * Wraps another datastore such that all values are stored\n * sharded according to the given sharding function.\n */\nexport class ShardingDatastore extends BaseDatastore {\n  private readonly child: KeyTransformDatastore\n  private shard: Shard\n\n  constructor (store: Datastore, shard: Shard) {\n    super()\n\n    this.child = new KeyTransformDatastore(store, {\n      convert: this._convertKey.bind(this),\n      invert: this._invertKey.bind(this)\n    })\n    this.shard = shard\n  }\n\n  async open (): Promise<void> {\n    this.shard = await ShardingDatastore.create(this.child, this.shard)\n  }\n\n  _convertKey (key: Key): Key {\n    const s = key.toString()\n    if (s === shardKey.toString()) {\n      return key\n    }\n\n    const parent = new Key(this.shard.fun(s))\n    return parent.child(key)\n  }\n\n  _invertKey (key: Key): Key {\n    const s = key.toString()\n    if (s === shardKey.toString()) {\n      return key\n    }\n    return Key.withNamespaces(key.list().slice(1))\n  }\n\n  static async create (store: Datastore, shard?: Shard): Promise<Shard> {\n    const hasShard = await store.has(shardKey)\n\n    if (!hasShard) {\n      if (shard == null) {\n        throw new OpenFailedError('Shard is required when datastore doesn\\'t have a shard key already')\n      }\n\n      await store.put(shardKey, new TextEncoder().encode(shard.toString() + '\\n'))\n    }\n\n    if (shard == null) {\n      shard = await readShardFun('/', store)\n    }\n\n    // test shards\n    const diskShard = await readShardFun('/', store)\n    const a = diskShard.toString()\n    const b = shard.toString()\n\n    if (a !== b) {\n      throw new Error(`specified fun ${b} does not match repo shard fun ${a}`)\n    }\n\n    return diskShard\n  }\n\n  async put (key: Key, val: Uint8Array, options?: AbortOptions): Promise<Key> {\n    await this.child.put(key, val, options)\n\n    return key\n  }\n\n  async get (key: Key, options?: AbortOptions): Promise<Uint8Array> {\n    return this.child.get(key, options)\n  }\n\n  async has (key: Key, options?: AbortOptions): Promise<boolean> {\n    return this.child.has(key, options)\n  }\n\n  async delete (key: Key, options?: AbortOptions): Promise<void> {\n    await this.child.delete(key, options)\n  }\n\n  async * putMany (source: AwaitIterable<Pair>, options: AbortOptions = {}): AsyncIterable<Key> {\n    yield * this.child.putMany(source, options)\n  }\n\n  async * getMany (source: AwaitIterable<Key>, options: AbortOptions = {}): AsyncIterable<Pair> {\n    yield * this.child.getMany(source, options)\n  }\n\n  async * deleteMany (source: AwaitIterable<Key>, options: AbortOptions = {}): AsyncIterable<Key> {\n    yield * this.child.deleteMany(source, options)\n  }\n\n  batch (): Batch {\n    return this.child.batch()\n  }\n\n  query (q: Query, options?: AbortOptions): AsyncIterable<Pair> {\n    const omitShard: QueryFilter = ({ key }) => key.toString() !== shardKey.toString()\n\n    const tq: Query = {\n      ...q,\n      filters: [\n        omitShard\n      ].concat(q.filters ?? [])\n    }\n\n    return this.child.query(tq, options)\n  }\n\n  queryKeys (q: KeyQuery, options?: AbortOptions): AsyncIterable<Key> {\n    const omitShard: KeyQueryFilter = (key) => key.toString() !== shardKey.toString()\n\n    const tq: KeyQuery = {\n      ...q,\n      filters: [\n        omitShard\n      ].concat(q.filters ?? [])\n    }\n\n    return this.child.queryKeys(tq, options)\n  }\n}\n", "import { DeleteFailedError, NotFoundError, PutFailedError } from 'interface-store'\nimport filter from 'it-filter'\nimport merge from 'it-merge'\nimport sort from 'it-sort'\nimport take from 'it-take'\nimport { BaseDatastore } from './base.js'\nimport type { Batch, Datastore, Key, KeyQuery, Pair, Query } from 'interface-datastore'\nimport type { AbortOptions } from 'interface-store'\n\n/**\n * A datastore that can combine multiple stores inside various\n * key prefixes\n */\nexport class MountDatastore extends BaseDatastore {\n  private readonly mounts: Array<{ prefix: Key, datastore: Datastore }>\n\n  constructor (mounts: Array<{ prefix: Key, datastore: Datastore }>) {\n    super()\n\n    this.mounts = mounts.slice()\n  }\n\n  /**\n   * Lookup the matching datastore for the given key\n   */\n  private _lookup (key: Key): { datastore: Datastore, mountpoint: Key } | undefined {\n    for (const mount of this.mounts) {\n      if (mount.prefix.toString() === key.toString() || mount.prefix.isAncestorOf(key)) {\n        return {\n          datastore: mount.datastore,\n          mountpoint: mount.prefix\n        }\n      }\n    }\n  }\n\n  async put (key: Key, value: Uint8Array, options?: AbortOptions): Promise<Key> {\n    const match = this._lookup(key)\n    if (match == null) {\n      throw new PutFailedError('No datastore mounted for this key')\n    }\n\n    await match.datastore.put(key, value, options)\n\n    return key\n  }\n\n  /**\n   * @param {Key} key\n   * @param {Options} [options]\n   */\n  async get (key: Key, options: AbortOptions = {}): Promise<Uint8Array> {\n    const match = this._lookup(key)\n    if (match == null) {\n      throw new NotFoundError('No datastore mounted for this key')\n    }\n    return match.datastore.get(key, options)\n  }\n\n  async has (key: Key, options?: AbortOptions): Promise<boolean> {\n    const match = this._lookup(key)\n    if (match == null) {\n      return Promise.resolve(false)\n    }\n    return match.datastore.has(key, options)\n  }\n\n  async delete (key: Key, options?: AbortOptions): Promise<void> {\n    const match = this._lookup(key)\n    if (match == null) {\n      throw new DeleteFailedError('No datastore mounted for this key')\n    }\n\n    await match.datastore.delete(key, options)\n  }\n\n  batch (): Batch {\n    const batchMounts: Record<string, Batch> = {}\n\n    const lookup = (key: Key): { batch: Batch } => {\n      const match = this._lookup(key)\n      if (match == null) {\n        throw new Error('No datastore mounted for this key')\n      }\n\n      const m = match.mountpoint.toString()\n      if (batchMounts[m] == null) {\n        batchMounts[m] = match.datastore.batch()\n      }\n\n      return {\n        batch: batchMounts[m]\n      }\n    }\n\n    return {\n      put: (key, value) => {\n        const match = lookup(key)\n        match.batch.put(key, value)\n      },\n      delete: (key) => {\n        const match = lookup(key)\n        match.batch.delete(key)\n      },\n      commit: async (options) => {\n        await Promise.all(Object.keys(batchMounts).map(async p => { await batchMounts[p].commit(options) }))\n      }\n    }\n  }\n\n  query (q: Query, options?: AbortOptions): AsyncIterable<Pair> {\n    const qs = this.mounts.map(m => {\n      return m.datastore.query({\n        prefix: q.prefix,\n        filters: q.filters\n      }, options)\n    })\n\n    let it = merge(...qs)\n    if (q.filters != null) { q.filters.forEach(f => { it = filter(it, f) }) }\n    if (q.orders != null) { q.orders.forEach(o => { it = sort(it, o) }) }\n    if (q.offset != null) {\n      let i = 0\n      const offset = q.offset\n      it = filter(it, () => i++ >= offset)\n    }\n    if (q.limit != null) { it = take(it, q.limit) }\n\n    return it\n  }\n\n  queryKeys (q: KeyQuery, options?: AbortOptions): AsyncIterable<Key> {\n    const qs = this.mounts.map(m => {\n      return m.datastore.queryKeys({\n        prefix: q.prefix,\n        filters: q.filters\n      }, options)\n    })\n\n    /** @type AsyncIterable<Key> */\n    let it = merge(...qs)\n    if (q.filters != null) { q.filters.forEach(f => { it = filter(it, f) }) }\n    if (q.orders != null) { q.orders.forEach(o => { it = sort(it, o) }) }\n    if (q.offset != null) {\n      let i = 0\n      const offset = q.offset\n      it = filter(it, () => i++ >= offset)\n    }\n    if (q.limit != null) { it = take(it, q.limit) }\n\n    return it\n  }\n}\n", "// Helpers.\nconst s = 1000;\nconst m = s * 60;\nconst h = m * 60;\nconst d = h * 24;\nconst w = d * 7;\nconst y = d * 365.25;\nfunction ms(value, options) {\n    try {\n        if (typeof value === 'string' && value.length > 0) {\n            return parse(value);\n        }\n        else if (typeof value === 'number' && isFinite(value)) {\n            return options?.long ? fmtLong(value) : fmtShort(value);\n        }\n        throw new Error('Value is not a string or number.');\n    }\n    catch (error) {\n        const message = isError(error)\n            ? `${error.message}. value=${JSON.stringify(value)}`\n            : 'An unknown error has occured.';\n        throw new Error(message);\n    }\n}\n/**\n * Parse the given `str` and return milliseconds.\n */\nfunction parse(str) {\n    str = String(str);\n    if (str.length > 100) {\n        throw new Error('Value exceeds the maximum length of 100 characters.');\n    }\n    const match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(str);\n    if (!match) {\n        return NaN;\n    }\n    const n = parseFloat(match[1]);\n    const type = (match[2] || 'ms').toLowerCase();\n    switch (type) {\n        case 'years':\n        case 'year':\n        case 'yrs':\n        case 'yr':\n        case 'y':\n            return n * y;\n        case 'weeks':\n        case 'week':\n        case 'w':\n            return n * w;\n        case 'days':\n        case 'day':\n        case 'd':\n            return n * d;\n        case 'hours':\n        case 'hour':\n        case 'hrs':\n        case 'hr':\n        case 'h':\n            return n * h;\n        case 'minutes':\n        case 'minute':\n        case 'mins':\n        case 'min':\n        case 'm':\n            return n * m;\n        case 'seconds':\n        case 'second':\n        case 'secs':\n        case 'sec':\n        case 's':\n            return n * s;\n        case 'milliseconds':\n        case 'millisecond':\n        case 'msecs':\n        case 'msec':\n        case 'ms':\n            return n;\n        default:\n            // This should never occur.\n            throw new Error(`The unit ${type} was matched, but no matching case exists.`);\n    }\n}\nexport default ms;\n/**\n * Short format for `ms`.\n */\nfunction fmtShort(ms) {\n    const msAbs = Math.abs(ms);\n    if (msAbs >= d) {\n        return `${Math.round(ms / d)}d`;\n    }\n    if (msAbs >= h) {\n        return `${Math.round(ms / h)}h`;\n    }\n    if (msAbs >= m) {\n        return `${Math.round(ms / m)}m`;\n    }\n    if (msAbs >= s) {\n        return `${Math.round(ms / s)}s`;\n    }\n    return `${ms}ms`;\n}\n/**\n * Long format for `ms`.\n */\nfunction fmtLong(ms) {\n    const msAbs = Math.abs(ms);\n    if (msAbs >= d) {\n        return plural(ms, msAbs, d, 'day');\n    }\n    if (msAbs >= h) {\n        return plural(ms, msAbs, h, 'hour');\n    }\n    if (msAbs >= m) {\n        return plural(ms, msAbs, m, 'minute');\n    }\n    if (msAbs >= s) {\n        return plural(ms, msAbs, s, 'second');\n    }\n    return `${ms} ms`;\n}\n/**\n * Pluralization helper.\n */\nfunction plural(ms, msAbs, n, name) {\n    const isPlural = msAbs >= n * 1.5;\n    return `${Math.round(ms / n)} ${name}${isPlural ? 's' : ''}`;\n}\n/**\n * A type guard for errors.\n */\nfunction isError(error) {\n    return typeof error === 'object' && error !== null && 'message' in error;\n}\n", "/* eslint-disable no-console */\n/* eslint-disable @typescript-eslint/strict-boolean-expressions */\n\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\nimport humanize from 'ms'\nimport type { Debug, Debugger } from './index.js'\n\nexport default function setup (env: any): Debug {\n  createDebug.debug = createDebug\n  createDebug.default = createDebug\n  createDebug.coerce = coerce\n  createDebug.disable = disable\n  createDebug.enable = enable\n  createDebug.enabled = enabled\n  createDebug.humanize = humanize\n  createDebug.destroy = destroy\n\n  Object.keys(env).forEach(key => {\n    // @ts-expect-error cannot use string to index type\n    createDebug[key] = env[key]\n  })\n\n  /**\n   * The currently active debug mode names, and names to skip.\n   */\n\n  createDebug.names = [] as any[]\n  createDebug.skips = [] as any[]\n\n  /**\n   * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n   *\n   * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n   */\n  createDebug.formatters = {} satisfies Record<string, any>\n\n  /**\n   * Selects a color for a debug namespace\n   *\n   * @param {string} namespace - The namespace string for the debug instance to be colored\n   * @returns {number | string} An ANSI color code for the given namespace\n   */\n  function selectColor (namespace: string): number | string {\n    let hash = 0\n\n    for (let i = 0; i < namespace.length; i++) {\n      hash = ((hash << 5) - hash) + namespace.charCodeAt(i)\n      hash |= 0 // Convert to 32bit integer\n    }\n\n    // @ts-expect-error colors is not in the types\n    return createDebug.colors[Math.abs(hash) % createDebug.colors.length]\n  }\n  createDebug.selectColor = selectColor\n\n  /**\n   * Create a debugger with the given `namespace`.\n   *\n   * @param {string} namespace\n   * @returns {Function}\n   */\n  function createDebug (namespace: string): Debugger {\n    let prevTime: any\n    let enableOverride: any = null\n    let namespacesCache: any\n    let enabledCache: any\n\n    function debug (...args: any[]): void {\n      // Disabled?\n      // @ts-expect-error enabled is not in the types\n      if (!debug.enabled) {\n        return\n      }\n\n      const self: any = debug\n\n      // Set `diff` timestamp\n      const curr = Number(new Date())\n      const ms = curr - (prevTime || curr)\n      self.diff = ms\n      self.prev = prevTime\n      self.curr = curr\n      prevTime = curr\n\n      args[0] = createDebug.coerce(args[0])\n\n      if (typeof args[0] !== 'string') {\n        // Anything else let's inspect with %O\n        args.unshift('%O')\n      }\n\n      // Apply any `formatters` transformations\n      let index = 0\n      args[0] = args[0].replace(/%([a-zA-Z%])/g, (match: any, format: any): any => {\n        // If we encounter an escaped % then don't increase the array index\n        if (match === '%%') {\n          return '%'\n        }\n        index++\n        // @ts-expect-error formatters is not in the types\n        const formatter = createDebug.formatters[format]\n        if (typeof formatter === 'function') {\n          const val = args[index]\n          match = formatter.call(self, val)\n\n          // Now we need to remove `args[index]` since it's inlined in the `format`\n          args.splice(index, 1)\n          index--\n        }\n        return match\n      })\n\n      // Apply env-specific formatting (colors, etc.)\n      // @ts-expect-error formatArgs is not in the types\n      createDebug.formatArgs.call(self, args)\n\n      // @ts-expect-error log is not in the types\n      const logFn = self.log || createDebug.log\n      logFn.apply(self, args)\n    }\n\n    debug.namespace = namespace\n    // @ts-expect-error useColors is not in the types\n    debug.useColors = createDebug.useColors()\n    debug.color = createDebug.selectColor(namespace)\n    debug.extend = extend\n    debug.destroy = createDebug.destroy // XXX Temporary. Will be removed in the next major release.\n\n    Object.defineProperty(debug, 'enabled', {\n      enumerable: true,\n      configurable: false,\n      get: () => {\n        if (enableOverride !== null) {\n          return enableOverride\n        }\n        // @ts-expect-error namespaces is not in the types\n        if (namespacesCache !== createDebug.namespaces) {\n          // @ts-expect-error namespaces is not in the types\n          namespacesCache = createDebug.namespaces\n          enabledCache = createDebug.enabled(namespace)\n        }\n\n        return enabledCache\n      },\n      set: v => {\n        enableOverride = v\n      }\n    })\n\n    // Env-specific initialization logic for debug instances\n    // @ts-expect-error init is not in the types\n    if (typeof createDebug.init === 'function') {\n      // @ts-expect-error init is not in the types\n      createDebug.init(debug)\n    }\n\n    // @ts-expect-error some properties are added dynamically\n    return debug\n  }\n\n  function extend (this: any, namespace: string, delimiter: string): any {\n    const newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace)\n    newDebug.log = this.log\n    return newDebug\n  }\n\n  /**\n   * Enables a debug mode by namespaces. This can include modes\n   * separated by a colon and wildcards.\n   *\n   * @param {string} namespaces\n   */\n  function enable (namespaces: string): void {\n    // @ts-expect-error save is not in the types\n    createDebug.save(namespaces)\n    // @ts-expect-error namespaces is not in the types\n    createDebug.namespaces = namespaces\n\n    createDebug.names = []\n    createDebug.skips = []\n\n    let i\n    const split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/)\n    const len = split.length\n\n    for (i = 0; i < len; i++) {\n      if (!split[i]) {\n        // ignore empty strings\n        continue\n      }\n\n      namespaces = split[i].replace(/\\*/g, '.*?')\n\n      if (namespaces[0] === '-') {\n        createDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'))\n      } else {\n        createDebug.names.push(new RegExp('^' + namespaces + '$'))\n      }\n    }\n  }\n\n  /**\n   * Disable debug output.\n   *\n   * @returns {string} namespaces\n   */\n  function disable (): string {\n    const namespaces = [\n      ...createDebug.names.map(toNamespace),\n      ...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n    ].join(',')\n    createDebug.enable('')\n    return namespaces\n  }\n\n  /**\n   * Returns true if the given mode name is enabled, false otherwise.\n   *\n   * @param {string} name\n   * @returns {boolean}\n   */\n  function enabled (name: string): boolean {\n    if (name[name.length - 1] === '*') {\n      return true\n    }\n\n    let i\n    let len\n\n    for (i = 0, len = createDebug.skips.length; i < len; i++) {\n      if (createDebug.skips[i].test(name)) {\n        return false\n      }\n    }\n\n    for (i = 0, len = createDebug.names.length; i < len; i++) {\n      if (createDebug.names[i].test(name)) {\n        return true\n      }\n    }\n\n    return false\n  }\n\n  /**\n   * Convert regexp to namespace\n   */\n  function toNamespace (regexp: RegExp): string {\n    return regexp.toString()\n      .substring(2, regexp.toString().length - 2)\n      .replace(/\\.\\*\\?$/, '*')\n  }\n\n  /**\n   * Coerce `val`.\n   */\n  function coerce (val: any): any {\n    if (val instanceof Error) {\n      return val.stack ?? val.message\n    }\n    return val\n  }\n\n  /**\n   * XXX DO NOT USE. This is a temporary stub function.\n   * XXX It WILL be removed in the next major release.\n   */\n  function destroy (): void {\n    console.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.')\n  }\n\n  // @ts-expect-error setupFormatters is not in the types\n  createDebug.setupFormatters(createDebug.formatters)\n\n  // @ts-expect-error load is not in the types\n  createDebug.enable(createDebug.load())\n\n  // @ts-expect-error some properties are added dynamically\n  return createDebug\n}\n", "/* eslint-disable no-console */\n/* eslint-disable @typescript-eslint/restrict-plus-operands */\n/* eslint-disable @typescript-eslint/strict-boolean-expressions */\n/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\nimport humanize from 'ms'\nimport setup from './common.js'\n\nconst storage = localstorage()\n\n/**\n * Colors.\n */\nconst colors = [\n  '#0000CC',\n  '#0000FF',\n  '#0033CC',\n  '#0033FF',\n  '#0066CC',\n  '#0066FF',\n  '#0099CC',\n  '#0099FF',\n  '#00CC00',\n  '#00CC33',\n  '#00CC66',\n  '#00CC99',\n  '#00CCCC',\n  '#00CCFF',\n  '#3300CC',\n  '#3300FF',\n  '#3333CC',\n  '#3333FF',\n  '#3366CC',\n  '#3366FF',\n  '#3399CC',\n  '#3399FF',\n  '#33CC00',\n  '#33CC33',\n  '#33CC66',\n  '#33CC99',\n  '#33CCCC',\n  '#33CCFF',\n  '#6600CC',\n  '#6600FF',\n  '#6633CC',\n  '#6633FF',\n  '#66CC00',\n  '#66CC33',\n  '#9900CC',\n  '#9900FF',\n  '#9933CC',\n  '#9933FF',\n  '#99CC00',\n  '#99CC33',\n  '#CC0000',\n  '#CC0033',\n  '#CC0066',\n  '#CC0099',\n  '#CC00CC',\n  '#CC00FF',\n  '#CC3300',\n  '#CC3333',\n  '#CC3366',\n  '#CC3399',\n  '#CC33CC',\n  '#CC33FF',\n  '#CC6600',\n  '#CC6633',\n  '#CC9900',\n  '#CC9933',\n  '#CCCC00',\n  '#CCCC33',\n  '#FF0000',\n  '#FF0033',\n  '#FF0066',\n  '#FF0099',\n  '#FF00CC',\n  '#FF00FF',\n  '#FF3300',\n  '#FF3333',\n  '#FF3366',\n  '#FF3399',\n  '#FF33CC',\n  '#FF33FF',\n  '#FF6600',\n  '#FF6633',\n  '#FF9900',\n  '#FF9933',\n  '#FFCC00',\n  '#FFCC33'\n]\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors (): boolean {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  // @ts-expect-error window.process.type and window.process.__nwjs are not in the types\n  if (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n    return true\n  }\n\n  // Internet Explorer and Edge do not support colors.\n  if (typeof navigator !== 'undefined' && (navigator.userAgent?.toLowerCase().match(/(edge|trident)\\/(\\d+)/) != null)) {\n    return false\n  }\n\n  // Is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  // @ts-expect-error document.documentElement.style.WebkitAppearance is not in the types\n  return (typeof document !== 'undefined' && document.documentElement?.style?.WebkitAppearance) ||\n    // Is firebug? http://stackoverflow.com/a/398120/376773\n    // @ts-expect-error window.console.firebug and window.console.exception are not in the types\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // Is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && (navigator.userAgent?.toLowerCase().match(/firefox\\/(\\d+)/) != null) && parseInt(RegExp.$1, 10) >= 31) ||\n    // Double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent?.toLowerCase().match(/applewebkit\\/(\\d+)/))\n}\n\n/**\n * Colorize log arguments if enabled.\n */\nfunction formatArgs (this: any, args: any[]): void {\n  args[0] = (this.useColors ? '%c' : '') +\n    this.namespace +\n    (this.useColors ? ' %c' : ' ') +\n    args[0] +\n    (this.useColors ? '%c ' : ' ') +\n    '+' + humanize(this.diff)\n\n  if (!this.useColors) {\n    return\n  }\n\n  const c = 'color: ' + this.color\n  args.splice(1, 0, c, 'color: inherit')\n\n  // The final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  let index = 0\n  let lastC = 0\n  args[0].replace(/%[a-zA-Z%]/g, (match: string) => {\n    if (match === '%%') {\n      return\n    }\n    index++\n    if (match === '%c') {\n      // We only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index\n    }\n  })\n\n  args.splice(lastC, 0, c)\n}\n\n/**\n * Invokes `console.debug()` when available.\n * No-op when `console.debug` is not a \"function\".\n * If `console.debug` is not available, falls back\n * to `console.log`.\n */\nconst log = console.debug ?? console.log ?? (() => { })\n\n/**\n * Save `namespaces`.\n *\n * @param {string} namespaces\n */\nfunction save (namespaces: string): void {\n  try {\n    if (namespaces) {\n      storage?.setItem('debug', namespaces)\n    } else {\n      storage?.removeItem('debug')\n    }\n  } catch (error) {\n    // Swallow\n    // XXX (@Qix-) should we be logging these?\n  }\n}\n\n/**\n * Load `namespaces`.\n *\n * @returns {string} returns the previously persisted debug modes\n */\nfunction load (): string | null | undefined {\n  let r\n  try {\n    r = storage?.getItem('debug')\n  } catch (error) {\n    // Swallow\n    // XXX (@Qix-) should we be logging these?\n  }\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof globalThis.process !== 'undefined' && 'env' in globalThis.process) {\n    r = globalThis.process.env.DEBUG\n  }\n\n  return r\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n */\nfunction localstorage (): Storage | undefined {\n  try {\n    // TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n    // The Browser also has localStorage in the global context.\n    return localStorage\n  } catch (error) {\n    // Swallow\n    // XXX (@Qix-) should we be logging these?\n  }\n}\n\nfunction setupFormatters (formatters: any): void {\n  /**\n   * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n   */\n  formatters.j = function (v: any) {\n    try {\n      return JSON.stringify(v)\n    } catch (error: any) {\n      return '[UnexpectedJSONParseError]: ' + error.message\n    }\n  }\n}\n\nexport default setup({ formatArgs, save, load, useColors, setupFormatters, colors, storage, log })\n", "/**\n * @packageDocumentation\n *\n * This module is a fork of the [debug](https://www.npmjs.com/package/debug) module. It has been converted to TypeScript and the output is ESM.\n *\n * It is API compatible with no extra features or bug fixes, it should only be used if you want a 100% ESM application.\n *\n * ESM should be arriving in `debug@5.x.x` so this module can be retired after that.\n *\n * Please see [debug](https://www.npmjs.com/package/debug) for API details.\n */\n\n/**\n * Module dependencies.\n */\nimport weald from './node.js'\nimport type ms from 'ms'\n\nexport interface Debug {\n  (namespace: string): Debugger\n  coerce(val: any): any\n  disable(...args: string[]): string\n  enable(namespaces: string | boolean): void\n  enabled(namespaces: string): boolean\n  formatArgs(this: Debugger, args: any[]): void\n  log(...args: any[]): any\n  selectColor(namespace: string): string | number\n  humanize: typeof ms\n\n  names: RegExp[]\n  skips: RegExp[]\n\n  formatters: Formatters\n\n  inspectOpts?: {\n    hideDate?: boolean | number | null\n    colors?: boolean | number | null\n    depth?: boolean | number | null\n    showHidden?: boolean | number | null\n  }\n}\n\nexport type Formatters = Record<string, (v: any) => string>\n\nexport interface Debugger {\n  (formatter: any, ...args: any[]): void\n\n  color: string\n  diff: number\n  enabled: boolean\n  log(...args: any[]): any\n  namespace: string\n  destroy(): boolean\n  extend(namespace: string, delimiter?: string): Debugger\n}\n\nexport default weald\n", "/**\n * @packageDocumentation\n *\n * A logger for libp2p based on [weald](https://www.npmjs.com/package/weald), a TypeScript port of the venerable [debug](https://www.npmjs.com/package/debug) module.\n *\n * @example\n *\n * ```TypeScript\n * import { logger } from '@libp2p/logger'\n *\n * const log = logger('libp2p:my:component:name')\n *\n * try {\n *   // an operation\n *   log('something happened: %s', 'it was ok')\n * } catch (err) {\n *   log.error('something bad happened: %o', err)\n * }\n *\n * log('with this peer: %p', {})\n * log('and this base58btc: %b', Uint8Array.from([0, 1, 2, 3]))\n * log('and this base32: %t', Uint8Array.from([4, 5, 6, 7]))\n * ```\n *\n * ```console\n * $ DEBUG=libp2p:* node index.js\n * something happened: it was ok\n * something bad happened: <stack trace>\n * with this peer: 12D3Foo\n * with this base58btc: Qmfoo\n * with this base32: bafyfoo\n * ```\n */\n\nimport { base32 } from 'multiformats/bases/base32'\nimport { base58btc } from 'multiformats/bases/base58'\nimport { base64 } from 'multiformats/bases/base64'\nimport debug from 'weald'\nimport { truncatePeerId } from './utils.js'\nimport type { PeerId } from '@libp2p/interface'\nimport type { Multiaddr } from '@multiformats/multiaddr'\nimport type { Key } from 'interface-datastore'\nimport type { CID } from 'multiformats/cid'\n\n// Add a formatter for converting to a base58 string\ndebug.formatters.b = (v?: Uint8Array): string => {\n  return v == null ? 'undefined' : base58btc.baseEncode(v)\n}\n\n// Add a formatter for converting to a base32 string\ndebug.formatters.t = (v?: Uint8Array): string => {\n  return v == null ? 'undefined' : base32.baseEncode(v)\n}\n\n// Add a formatter for converting to a base64 string\ndebug.formatters.m = (v?: Uint8Array): string => {\n  return v == null ? 'undefined' : base64.baseEncode(v)\n}\n\n// Add a formatter for stringifying peer ids\ndebug.formatters.p = (v?: PeerId): string => {\n  return v == null ? 'undefined' : v.toString()\n}\n\n// Add a formatter for stringifying CIDs\ndebug.formatters.c = (v?: CID): string => {\n  return v == null ? 'undefined' : v.toString()\n}\n\n// Add a formatter for stringifying Datastore keys\ndebug.formatters.k = (v: Key): string => {\n  return v == null ? 'undefined' : v.toString()\n}\n\n// Add a formatter for stringifying Multiaddrs\ndebug.formatters.a = (v?: Multiaddr): string => {\n  return v == null ? 'undefined' : v.toString()\n}\n\n// Add a formatter for stringifying Errors\ndebug.formatters.e = (v?: Error): string => {\n  return v == null ? 'undefined' : notEmpty(v.stack) ?? notEmpty(v.message) ?? v.toString()\n}\n\nexport interface Logger {\n  (formatter: any, ...args: any[]): void\n  error(formatter: any, ...args: any[]): void\n  trace(formatter: any, ...args: any[]): void\n  enabled: boolean\n}\n\nexport interface ComponentLogger {\n  forComponent(name: string): Logger\n}\n\nfunction createDisabledLogger (namespace: string): debug.Debugger {\n  const logger = (): void => {}\n  logger.enabled = false\n  logger.color = ''\n  logger.diff = 0\n  logger.log = (): void => {}\n  logger.namespace = namespace\n  logger.destroy = () => true\n  logger.extend = () => logger\n\n  return logger\n}\n\nexport interface PeerLoggerOptions {\n  prefixLength: number\n  suffixLength: number\n}\n\n/**\n * Create a component logger that will prefix any log messages with a truncated\n * peer id.\n *\n * @example\n *\n * ```TypeScript\n * import { peerLogger } from '@libp2p/logger'\n * import { peerIdFromString } from '@libp2p/peer-id'\n *\n * const peerId = peerIdFromString('12D3FooBar')\n * const logger = peerLogger(peerId)\n *\n * const log = logger.forComponent('my-component')\n * log.info('hello world')\n * // logs \"12\u2026oBar:my-component hello world\"\n * ```\n */\nexport function peerLogger (peerId: PeerId, options: Partial<PeerLoggerOptions> = {}): ComponentLogger {\n  return prefixLogger(truncatePeerId(peerId, options))\n}\n\n/**\n * Create a component logger that will prefix any log messages with the passed\n * string.\n *\n * @example\n *\n * ```TypeScript\n * import { prefixLogger } from '@libp2p/logger'\n *\n * const logger = prefixLogger('my-node')\n *\n * const log = logger.forComponent('my-component')\n * log.info('hello world')\n * // logs \"my-node:my-component hello world\"\n * ```\n */\nexport function prefixLogger (prefix: string): ComponentLogger {\n  return {\n    forComponent (name: string) {\n      return logger(`${prefix}:${name}`)\n    }\n  }\n}\n\n/**\n * Create a component logger\n *\n * @example\n *\n * ```TypeScript\n * import { defaultLogger } from '@libp2p/logger'\n * import { peerIdFromString } from '@libp2p/peer-id'\n *\n * const logger = defaultLogger()\n *\n * const log = logger.forComponent('my-component')\n * log.info('hello world')\n * // logs \"my-component hello world\"\n * ```\n */\nexport function defaultLogger (): ComponentLogger {\n  return {\n    forComponent (name: string) {\n      return logger(name)\n    }\n  }\n}\n\n/**\n * Creates a logger for the passed component name.\n *\n * @example\n *\n * ```TypeScript\n * import { logger } from '@libp2p/logger'\n *\n * const log = logger('my-component')\n * log.info('hello world')\n * // logs \"my-component hello world\"\n * ```\n */\nexport function logger (name: string): Logger {\n  // trace logging is a no-op by default\n  let trace: debug.Debugger = createDisabledLogger(`${name}:trace`)\n\n  // look at all the debug names and see if trace logging has explicitly been enabled\n  if (debug.enabled(`${name}:trace`) && debug.names.map((r: any) => r.toString()).find((n: string) => n.includes(':trace')) != null) {\n    trace = debug(`${name}:trace`)\n  }\n\n  return Object.assign(debug(name), {\n    error: debug(`${name}:error`),\n    trace\n  })\n}\n\nexport function disable (): void {\n  debug.disable()\n}\n\nexport function enable (namespaces: string): void {\n  debug.enable(namespaces)\n}\n\nexport function enabled (namespaces: string): boolean {\n  return debug.enabled(namespaces)\n}\n\nfunction notEmpty (str?: string): string | undefined {\n  if (str == null) {\n    return\n  }\n\n  str = str.trim()\n\n  if (str.length === 0) {\n    return\n  }\n\n  return str\n}\n", "import { logger } from '@libp2p/logger'\nimport { NotFoundError } from 'interface-store'\nimport { BaseDatastore } from './base.js'\nimport type { Batch, Datastore, Key, KeyQuery, Pair, Query } from 'interface-datastore'\nimport type { AbortOptions, AwaitIterable } from 'interface-store'\n\nconst log = logger('datastore:core:tiered')\n\n/**\n * A datastore that can combine multiple stores. Puts and deletes\n * will write through to all datastores. Has and get will\n * try each store sequentially. Query will always try the\n * last one first.\n *\n */\nexport class TieredDatastore extends BaseDatastore {\n  private readonly stores: Datastore[]\n\n  constructor (stores: Datastore[]) {\n    super()\n\n    this.stores = stores.slice()\n  }\n\n  async put (key: Key, value: Uint8Array, options?: AbortOptions): Promise<Key> {\n    await Promise.all(\n      this.stores.map(async store => {\n        await store.put(key, value, options)\n      })\n    )\n\n    return key\n  }\n\n  async get (key: Key, options?: AbortOptions): Promise<Uint8Array> {\n    let error: Error | undefined\n\n    for (const store of this.stores) {\n      try {\n        const res = await store.get(key, options)\n\n        if (res != null) {\n          return res\n        }\n      } catch (err: any) {\n        error = err\n        log.error(err)\n      }\n    }\n\n    throw error ?? new NotFoundError()\n  }\n\n  async has (key: Key, options?: AbortOptions): Promise<boolean> {\n    for (const s of this.stores) {\n      if (await s.has(key, options)) {\n        return true\n      }\n    }\n\n    return false\n  }\n\n  async delete (key: Key, options?: AbortOptions): Promise<void> {\n    await Promise.all(\n      this.stores.map(async store => {\n        await store.delete(key, options)\n      })\n    )\n  }\n\n  async * putMany (source: AwaitIterable<Pair>, options: AbortOptions = {}): AsyncIterable<Key> {\n    for await (const pair of source) {\n      await this.put(pair.key, pair.value, options)\n      yield pair.key\n    }\n  }\n\n  async * deleteMany (source: AwaitIterable<Key>, options: AbortOptions = {}): AsyncIterable<Key> {\n    for await (const key of source) {\n      await this.delete(key, options)\n      yield key\n    }\n  }\n\n  batch (): Batch {\n    const batches = this.stores.map(store => store.batch())\n\n    return {\n      put: (key, value) => {\n        batches.forEach(b => { b.put(key, value) })\n      },\n      delete: (key) => {\n        batches.forEach(b => { b.delete(key) })\n      },\n      commit: async (options) => {\n        for (const batch of batches) {\n          await batch.commit(options)\n        }\n      }\n    }\n  }\n\n  query (q: Query, options?: AbortOptions): AwaitIterable<Pair> {\n    return this.stores[this.stores.length - 1].query(q, options)\n  }\n\n  queryKeys (q: KeyQuery, options?: AbortOptions): AwaitIterable<Key> {\n    return this.stores[this.stores.length - 1].queryKeys(q, options)\n  }\n}\n", "import { Key } from 'interface-datastore'\nimport map from 'it-map'\nimport { KeyTransformDatastore } from './keytransform.js'\nimport type { Datastore, Query, Pair, KeyQuery } from 'interface-datastore'\nimport type { AbortOptions } from 'interface-store'\n\n/**\n * Wraps a given datastore into a keytransform which\n * makes a given prefix transparent.\n *\n * For example, if the prefix is `new Key(/hello)` a call\n * to `store.put(new Key('/world'), mydata)` would store the data under\n * `/hello/world`.\n */\nexport class NamespaceDatastore extends KeyTransformDatastore {\n  private readonly iChild: Datastore\n  private readonly iKey: Key\n\n  constructor (child: Datastore, prefix: Key) {\n    super(child, {\n      convert (key) {\n        return prefix.child(key)\n      },\n      invert (key) {\n        if (prefix.toString() === '/') {\n          return key\n        }\n\n        if (!prefix.isAncestorOf(key)) {\n          throw new Error(`Expected prefix: (${prefix.toString()}) in key: ${key.toString()}`)\n        }\n\n        return new Key(key.toString().slice(prefix.toString().length), false)\n      }\n    })\n\n    this.iChild = child\n    this.iKey = prefix\n  }\n\n  query (q: Query, options?: AbortOptions): AsyncIterable<Pair> {\n    const query: Query = {\n      ...q\n    }\n\n    query.filters = (query.filters ?? []).map(filter => {\n      return ({ key, value }) => filter({ key: this.transform.invert(key), value })\n    })\n\n    const { prefix } = q\n    if (prefix != null && prefix !== '/') {\n      delete query.prefix\n      query.filters.push(({ key }) => {\n        return this.transform.invert(key).toString().startsWith(prefix)\n      })\n    }\n\n    if (query.orders != null) {\n      query.orders = query.orders.map(order => {\n        return (a, b) => order(\n          { key: this.transform.invert(a.key), value: a.value },\n          { key: this.transform.invert(b.key), value: b.value }\n        )\n      })\n    }\n\n    query.filters.unshift(({ key }) => this.iKey.isAncestorOf(key))\n\n    return map(this.iChild.query(query, options), ({ key, value }) => {\n      return {\n        key: this.transform.invert(key),\n        value\n      }\n    })\n  }\n\n  queryKeys (q: KeyQuery, options?: AbortOptions): AsyncIterable<Key> {\n    const query = {\n      ...q\n    }\n\n    query.filters = (query.filters ?? []).map(filter => {\n      return (key) => filter(this.transform.invert(key))\n    })\n\n    const { prefix } = q\n    if (prefix != null && prefix !== '/') {\n      delete query.prefix\n      query.filters.push((key) => {\n        return this.transform.invert(key).toString().startsWith(prefix)\n      })\n    }\n\n    if (query.orders != null) {\n      query.orders = query.orders.map(order => {\n        return (a, b) => order(\n          this.transform.invert(a),\n          this.transform.invert(b)\n        )\n      })\n    }\n\n    query.filters.unshift(key => this.iKey.isAncestorOf(key))\n\n    return map(this.iChild.queryKeys(query, options), key => {\n      return this.transform.invert(key)\n    })\n  }\n}\n"],
+  "mappings": "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",
+  "names": ["index_exports", "__export", "BaseDatastore", "KeyTransformDatastore", "MemoryDatastore", "MountDatastore", "NamespaceDatastore", "ShardingDatastore", "TieredDatastore", "shard_exports", "shard_exports", "__export", "NextToLast", "PREFIX", "Prefix", "SHARDING_FN", "ShardBase", "Suffix", "parseShardFun", "readShardFun", "base10_exports", "__export", "base10", "empty", "equals", "aa", "bb", "ii", "coerce", "o", "fromString", "str", "toString", "b", "base", "ALPHABET", "name", "BASE_MAP", "j", "i", "x", "xc", "BASE", "LEADER", "FACTOR", "iFACTOR", "encode", "source", "zeroes", "length", "pbegin", "pend", "size", "b58", "carry", "it1", "it2", "str", "decodeUnsafe", "psz", "b256", "it3", "it4", "vch", "decode", "string", "buffer", "src", "_brrp__multiformats_scope_baseX", "base_x_default", "Encoder", "name", "prefix", "baseEncode", "bytes", "Decoder", "baseDecode", "prefixCodePoint", "text", "decoder", "or", "ComposedDecoder", "decoders", "input", "left", "right", "Codec", "from", "encode", "decode", "baseX", "alphabet", "base_x_default", "coerce", "string", "alphabetIdx", "bitsPerChar", "end", "out", "bits", "buffer", "written", "i", "value", "data", "pad", "mask", "createAlphabetIdx", "rfc4648", "base10", "baseX", "base16_exports", "__export", "base16", "base16upper", "base16", "rfc4648", "base16upper", "base2_exports", "__export", "base2", "base2", "rfc4648", "base256emoji_exports", "__export", "base256emoji", "alphabet", "alphabetBytesToChars", "p", "c", "i", "alphabetCharsToBytes", "codePoint", "encode", "data", "decode", "str", "byts", "char", "byt", "base256emoji", "from", "base32_exports", "__export", "base32", "base32hex", "base32hexpad", "base32hexpadupper", "base32hexupper", "base32pad", "base32padupper", "base32upper", "base32z", "base32", "rfc4648", "base32upper", "base32pad", "base32padupper", "base32hex", "base32hexupper", "base32hexpad", "base32hexpadupper", "base32z", "base36_exports", "__export", "base36", "base36upper", "base36", "baseX", "base36upper", "base58_exports", "__export", "base58btc", "base58flickr", "base58btc", "baseX", "base58flickr", "base64_exports", "__export", "base64", "base64pad", "base64url", "base64urlpad", "base64", "rfc4648", "base64pad", "base64url", "base64urlpad", "base8_exports", "__export", "base8", "base8", "rfc4648", "identity_exports", "__export", "identity", "identity", "from", "buf", "toString", "str", "fromString", "textEncoder", "textDecoder", "identity_exports", "__export", "identity", "encode_1", "encode", "MSB", "REST", "MSBALL", "INT", "num", "out", "offset", "oldOffset", "decode", "read", "MSB$1", "REST$1", "buf", "res", "shift", "counter", "b", "l", "N1", "N2", "N3", "N4", "N5", "N6", "N7", "N8", "N9", "length", "value", "varint", "_brrp_varint", "varint_default", "decode", "data", "offset", "varint_default", "encodeTo", "int", "target", "encodingLength", "create", "code", "digest", "size", "sizeOffset", "encodingLength", "digestOffset", "bytes", "encodeTo", "Digest", "decode", "multihash", "coerce", "equals", "a", "b", "data", "code", "name", "encode", "coerce", "digest", "input", "create", "identity", "sha2_browser_exports", "__export", "sha256", "sha512", "from", "name", "code", "encode", "Hasher", "input", "result", "create", "digest", "sha", "name", "data", "sha256", "from", "sha512", "format", "link", "base", "bytes", "version", "toStringV0", "baseCache", "base58btc", "toStringV1", "base32", "cache", "baseCache", "cid", "CID", "_CID", "version", "code", "multihash", "bytes", "DAG_PB_CODE", "SHA_256_CODE", "digest", "create", "other", "self", "unknown", "equals", "base", "format", "input", "value", "encodeCID", "cidSymbol", "decode", "remainder", "specs", "prefixSize", "multihashBytes", "coerce", "digestBytes", "Digest", "initialBytes", "offset", "next", "i", "length", "codec", "multihashCode", "digestSize", "size", "multihashSize", "source", "prefix", "parseCIDtoBytes", "decoder", "base58btc", "base32", "base36", "toStringV0", "toStringV1", "codeOffset", "encodingLength", "hashOffset", "encodeTo", "bases", "identity_exports", "base2_exports", "base8_exports", "base10_exports", "base16_exports", "base32_exports", "base36_exports", "base58_exports", "base64_exports", "base256emoji_exports", "hashes", "sha2_browser_exports", "allocUnsafe", "size", "createCodec", "name", "prefix", "encode", "decode", "string", "buf", "str", "ascii", "i", "allocUnsafe", "BASES", "bases", "bases_default", "fromString", "string", "encoding", "base", "bases_default", "toString", "array", "encoding", "base", "bases_default", "pathSepS", "pathSepB", "pathSep", "Key", "_Key", "s", "clean", "fromString", "encoding", "toString", "list", "other", "bytes", "key", "list1", "list2", "i", "c1", "c2", "ns", "namespaceType", "namespaceValue", "p", "keys", "flatten", "parts", "arr", "PREFIX", "SHARDING_FN", "ShardBase", "param", "s", "Prefix", "prefixLen", "noslash", "Suffix", "suffixLen", "NextToLast", "offset", "parseShardFun", "str", "parts", "version", "name", "readShardFun", "path", "store", "key", "Key", "res", "isAsyncIterable", "thing", "drain", "source", "_", "src_default", "peekable", "iterable", "iterator", "symbol", "queue", "value", "src_default", "isAsyncIterable", "thing", "filter", "source", "fn", "index", "entry", "peekable", "src_default", "value", "done", "res", "func", "isAsyncIterable", "thing", "all", "source", "arr", "entry", "src_default", "isAsyncIterable", "thing", "sort", "source", "sorter", "src_default", "isAsyncIterable", "thing", "take", "source", "limit", "items", "entry", "src_default", "BaseDatastore", "key", "val", "options", "source", "value", "puts", "dels", "src_default", "q", "it", "prefix", "e", "f", "i", "offset", "OpenFailedError", "_OpenFailedError", "message", "PutFailedError", "_PutFailedError", "message", "DeleteFailedError", "_DeleteFailedError", "message", "NotFoundError", "_NotFoundError", "message", "MemoryDatastore", "BaseDatastore", "key", "val", "options", "result", "NotFoundError", "q", "value", "Key", "isAsyncIterable", "thing", "map", "source", "func", "index", "val", "peekable", "src_default", "value", "done", "res", "fn", "pDefer", "deferred", "resolve", "reject", "FixedFIFO", "hwm", "data", "last", "FIFO", "options", "obj", "val", "prev", "next", "AbortError", "message", "code", "pushable", "options", "_pushable", "buffer", "next", "_pushable", "getNext", "options", "onEnd", "buffer", "FIFO", "pushable", "onNext", "ended", "drain", "pDefer", "waitNext", "resolve", "reject", "next", "err", "bufferNext", "bufferError", "push", "value", "end", "_return", "_throw", "signal", "cancel", "listener", "AbortError", "opts", "AbortError", "message", "code", "name", "raceSignal", "promise", "signal", "opts", "listener", "error", "resolve", "reject", "QueuelessPushable", "pDefer", "nextResult", "err", "result", "value", "options", "raceSignal", "queuelessPushable", "isAsyncIterable", "thing", "addAllToPushable", "sources", "output", "signal", "source", "item", "err", "mergeSources", "controller", "queuelessPushable", "mergeSyncSources", "syncSources", "merge", "src_default", "pipe", "first", "rest", "isDuplex", "duplex", "isIterable", "isAsyncIterable", "source", "fns", "i", "duplexPipelineFn", "rawPipe", "res", "obj", "p", "stream", "pushable", "err", "sourceWrap", "src_default", "KeyTransformDatastore", "BaseDatastore", "child", "transform", "key", "val", "options", "source", "pipe", "src_default", "value", "b", "q", "query", "filter", "prefix", "order", "a", "shardKey", "Key", "SHARDING_FN", "ShardingDatastore", "_ShardingDatastore", "BaseDatastore", "store", "shard", "KeyTransformDatastore", "key", "s", "OpenFailedError", "readShardFun", "diskShard", "a", "b", "val", "options", "source", "q", "tq", "MountDatastore", "BaseDatastore", "mounts", "key", "mount", "value", "options", "match", "PutFailedError", "NotFoundError", "DeleteFailedError", "batchMounts", "lookup", "m", "p", "q", "qs", "it", "src_default", "f", "o", "i", "offset", "ms", "value", "options", "parse", "fmtLong", "fmtShort", "error", "message", "isError", "str", "match", "n", "type", "dist_default", "msAbs", "plural", "name", "isPlural", "setup", "env", "createDebug", "coerce", "disable", "enable", "enabled", "dist_default", "destroy", "key", "selectColor", "namespace", "hash", "i", "prevTime", "enableOverride", "namespacesCache", "enabledCache", "debug", "args", "self", "curr", "ms", "index", "match", "format", "formatter", "val", "extend", "v", "delimiter", "newDebug", "namespaces", "split", "len", "toNamespace", "name", "regexp", "storage", "localstorage", "colors", "useColors", "formatArgs", "args", "dist_default", "c", "index", "lastC", "match", "log", "save", "namespaces", "load", "setupFormatters", "formatters", "v", "error", "browser_default", "setup", "src_default", "browser_default", "src_default", "v", "base58btc", "base32", "base64", "notEmpty", "createDisabledLogger", "namespace", "logger", "logger", "name", "trace", "createDisabledLogger", "src_default", "r", "n", "notEmpty", "str", "log", "logger", "TieredDatastore", "BaseDatastore", "stores", "key", "value", "options", "store", "error", "res", "err", "NotFoundError", "s", "source", "pair", "batches", "b", "batch", "q", "NamespaceDatastore", "KeyTransformDatastore", "child", "prefix", "key", "Key", "q", "options", "query", "filter", "value", "order", "a", "b", "src_default"]
+}
diff --git a/node_modules/datastore-core/dist/src/black-hole.d.ts b/node_modules/datastore-core/dist/src/black-hole.d.ts
index 24a3528..dbb1385 100644
--- a/node_modules/datastore-core/dist/src/black-hole.d.ts
+++ b/node_modules/datastore-core/dist/src/black-hole.d.ts
@@ -1,13 +1,13 @@
 import { BaseDatastore } from './base.js';
-import type { Pair } from 'interface-datastore';
+import type { Pair, Query, KeyQuery } from 'interface-datastore';
 import type { Key } from 'interface-datastore/key';
-import type { Await, AwaitIterable } from 'interface-store';
+import type { AbortOptions, Await, AwaitIterable } from 'interface-store';
 export declare class BlackHoleDatastore extends BaseDatastore {
-    put(key: Key): Await<Key>;
-    get(): Await<Uint8Array>;
-    has(key: Key): Await<boolean>;
-    delete(key: Key): Await<void>;
-    _all(): AwaitIterable<Pair>;
-    _allKeys(): AwaitIterable<Key>;
+    put(key: Key, value: Uint8Array, options?: AbortOptions): Await<Key>;
+    get(key: Key, options?: AbortOptions): Await<Uint8Array>;
+    has(key: Key, options?: AbortOptions): Await<boolean>;
+    delete(key: Key, options?: AbortOptions): Await<void>;
+    _all(q: Query, options?: AbortOptions): AwaitIterable<Pair>;
+    _allKeys(q: KeyQuery, options?: AbortOptions): AwaitIterable<Key>;
 }
 //# sourceMappingURL=black-hole.d.ts.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/black-hole.d.ts.map b/node_modules/datastore-core/dist/src/black-hole.d.ts.map
index 8a70944..63b291d 100644
--- a/node_modules/datastore-core/dist/src/black-hole.d.ts.map
+++ b/node_modules/datastore-core/dist/src/black-hole.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"black-hole.d.ts","sourceRoot":"","sources":["../../src/black-hole.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAA;AACzC,OAAO,KAAK,EAAE,IAAI,EAAE,MAAM,qBAAqB,CAAA;AAC/C,OAAO,KAAK,EAAE,GAAG,EAAE,MAAM,yBAAyB,CAAA;AAClD,OAAO,KAAK,EAAE,KAAK,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAE3D,qBAAa,kBAAmB,SAAQ,aAAa;IACnD,GAAG,CAAE,GAAG,EAAE,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC;IAI1B,GAAG,IAAK,KAAK,CAAC,UAAU,CAAC;IAIzB,GAAG,CAAE,GAAG,EAAE,GAAG,GAAG,KAAK,CAAC,OAAO,CAAC;IAI9B,MAAM,CAAE,GAAG,EAAE,GAAG,GAAG,KAAK,CAAC,IAAI,CAAC;IAI5B,IAAI,IAAK,aAAa,CAAC,IAAI,CAAC;IAI5B,QAAQ,IAAK,aAAa,CAAC,GAAG,CAAC;CAGlC"}
\ No newline at end of file
+{"version":3,"file":"black-hole.d.ts","sourceRoot":"","sources":["../../src/black-hole.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAA;AACzC,OAAO,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,MAAM,qBAAqB,CAAA;AAChE,OAAO,KAAK,EAAE,GAAG,EAAE,MAAM,yBAAyB,CAAA;AAClD,OAAO,KAAK,EAAE,YAAY,EAAE,KAAK,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAEzE,qBAAa,kBAAmB,SAAQ,aAAa;IACnD,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,UAAU,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,KAAK,CAAC,GAAG,CAAC;IAKrE,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,KAAK,CAAC,UAAU,CAAC;IAKzD,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,KAAK,CAAC,OAAO,CAAC;IAKtD,MAAM,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,KAAK,CAAC,IAAI,CAAC;IAKpD,IAAI,CAAE,CAAC,EAAE,KAAK,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,IAAI,CAAC;IAK5D,QAAQ,CAAE,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,GAAG,CAAC;CAGrE"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/black-hole.js b/node_modules/datastore-core/dist/src/black-hole.js
index 079f171..5d69040 100644
--- a/node_modules/datastore-core/dist/src/black-hole.js
+++ b/node_modules/datastore-core/dist/src/black-hole.js
@@ -1,20 +1,28 @@
 import { NotFoundError } from 'interface-store';
 import { BaseDatastore } from './base.js';
 export class BlackHoleDatastore extends BaseDatastore {
-    put(key) {
+    put(key, value, options) {
+        options?.signal?.throwIfAborted();
         return key;
     }
-    get() {
+    get(key, options) {
+        options?.signal?.throwIfAborted();
         throw new NotFoundError();
     }
-    has(key) {
+    has(key, options) {
+        options?.signal?.throwIfAborted();
         return false;
     }
-    delete(key) {
+    delete(key, options) {
+        options?.signal?.throwIfAborted();
     }
-    *_all() {
+    // eslint-disable-next-line require-yield
+    *_all(q, options) {
+        options?.signal?.throwIfAborted();
     }
-    *_allKeys() {
+    // eslint-disable-next-line require-yield
+    *_allKeys(q, options) {
+        options?.signal?.throwIfAborted();
     }
 }
 //# sourceMappingURL=black-hole.js.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/black-hole.js.map b/node_modules/datastore-core/dist/src/black-hole.js.map
index d282a24..a933d4f 100644
--- a/node_modules/datastore-core/dist/src/black-hole.js.map
+++ b/node_modules/datastore-core/dist/src/black-hole.js.map
@@ -1 +1 @@
-{"version":3,"file":"black-hole.js","sourceRoot":"","sources":["../../src/black-hole.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAC/C,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAA;AAKzC,MAAM,OAAO,kBAAmB,SAAQ,aAAa;IACnD,GAAG,CAAE,GAAQ;QACX,OAAO,GAAG,CAAA;IACZ,CAAC;IAED,GAAG;QACD,MAAM,IAAI,aAAa,EAAE,CAAA;IAC3B,CAAC;IAED,GAAG,CAAE,GAAQ;QACX,OAAO,KAAK,CAAA;IACd,CAAC;IAED,MAAM,CAAE,GAAQ;IAEhB,CAAC;IAED,CAAE,IAAI;IAEN,CAAC;IAED,CAAE,QAAQ;IAEV,CAAC;CACF"}
\ No newline at end of file
+{"version":3,"file":"black-hole.js","sourceRoot":"","sources":["../../src/black-hole.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAC/C,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAA;AAKzC,MAAM,OAAO,kBAAmB,SAAQ,aAAa;IACnD,GAAG,CAAE,GAAQ,EAAE,KAAiB,EAAE,OAAsB;QACtD,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QACjC,OAAO,GAAG,CAAA;IACZ,CAAC;IAED,GAAG,CAAE,GAAQ,EAAE,OAAsB;QACnC,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QACjC,MAAM,IAAI,aAAa,EAAE,CAAA;IAC3B,CAAC;IAED,GAAG,CAAE,GAAQ,EAAE,OAAsB;QACnC,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QACjC,OAAO,KAAK,CAAA;IACd,CAAC;IAED,MAAM,CAAE,GAAQ,EAAE,OAAsB;QACtC,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;IACnC,CAAC;IAED,yCAAyC;IACzC,CAAE,IAAI,CAAE,CAAQ,EAAE,OAAsB;QACtC,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;IACnC,CAAC;IAED,yCAAyC;IACzC,CAAE,QAAQ,CAAE,CAAW,EAAE,OAAsB;QAC7C,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;IACnC,CAAC;CACF"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/index.d.ts b/node_modules/datastore-core/dist/src/index.d.ts
index 03a3fea..fe00541 100644
--- a/node_modules/datastore-core/dist/src/index.d.ts
+++ b/node_modules/datastore-core/dist/src/index.d.ts
@@ -5,12 +5,12 @@
  *
  * ## Implementations
  *
- * - Mount: [`src/mount`](src/mount.ts)
- * - Keytransform: [`src/keytransform`](src/keytransform.ts)
- * - Sharding: [`src/sharding`](src/sharding.ts)
- * - Tiered: [`src/tiered`](src/tirered.ts)
- * - Namespace: [`src/namespace`](src/namespace.ts)
- * - BlackHole: [`src/black-hole`](src/black-hole.ts)
+ * - Mount: [`src/mount`](./src/mount.ts)
+ * - Keytransform: [`src/keytransform`](./src/keytransform.ts)
+ * - Sharding: [`src/sharding`](./src/sharding.ts)
+ * - Tiered: [`src/tiered`](./src/tirered.ts)
+ * - Namespace: [`src/namespace`](./src/namespace.ts)
+ * - BlackHole: [`src/black-hole`](./src/black-hole.ts)
  *
  * @example BaseDatastore
  *
diff --git a/node_modules/datastore-core/dist/src/index.js b/node_modules/datastore-core/dist/src/index.js
index 6b72642..696343a 100644
--- a/node_modules/datastore-core/dist/src/index.js
+++ b/node_modules/datastore-core/dist/src/index.js
@@ -5,12 +5,12 @@
  *
  * ## Implementations
  *
- * - Mount: [`src/mount`](src/mount.ts)
- * - Keytransform: [`src/keytransform`](src/keytransform.ts)
- * - Sharding: [`src/sharding`](src/sharding.ts)
- * - Tiered: [`src/tiered`](src/tirered.ts)
- * - Namespace: [`src/namespace`](src/namespace.ts)
- * - BlackHole: [`src/black-hole`](src/black-hole.ts)
+ * - Mount: [`src/mount`](./src/mount.ts)
+ * - Keytransform: [`src/keytransform`](./src/keytransform.ts)
+ * - Sharding: [`src/sharding`](./src/sharding.ts)
+ * - Tiered: [`src/tiered`](./src/tirered.ts)
+ * - Namespace: [`src/namespace`](./src/namespace.ts)
+ * - BlackHole: [`src/black-hole`](./src/black-hole.ts)
  *
  * @example BaseDatastore
  *
diff --git a/node_modules/datastore-core/dist/src/memory.d.ts b/node_modules/datastore-core/dist/src/memory.d.ts
index 7ac011e..a4bc8b3 100644
--- a/node_modules/datastore-core/dist/src/memory.d.ts
+++ b/node_modules/datastore-core/dist/src/memory.d.ts
@@ -1,15 +1,15 @@
 import { Key } from 'interface-datastore/key';
 import { BaseDatastore } from './base.js';
-import type { Pair } from 'interface-datastore';
-import type { Await, AwaitIterable } from 'interface-store';
+import type { KeyQuery, Pair, Query } from 'interface-datastore';
+import type { AbortOptions, Await, AwaitIterable } from 'interface-store';
 export declare class MemoryDatastore extends BaseDatastore {
     private readonly data;
     constructor();
-    put(key: Key, val: Uint8Array): Await<Key>;
-    get(key: Key): Await<Uint8Array>;
-    has(key: Key): Await<boolean>;
-    delete(key: Key): Await<void>;
-    _all(): AwaitIterable<Pair>;
-    _allKeys(): AwaitIterable<Key>;
+    put(key: Key, val: Uint8Array, options?: AbortOptions): Await<Key>;
+    get(key: Key, options?: AbortOptions): Await<Uint8Array>;
+    has(key: Key, options?: AbortOptions): Await<boolean>;
+    delete(key: Key, options?: AbortOptions): Await<void>;
+    _all(q: Query, options?: AbortOptions): AwaitIterable<Pair>;
+    _allKeys(q: KeyQuery, options?: AbortOptions): AwaitIterable<Key>;
 }
 //# sourceMappingURL=memory.d.ts.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/memory.d.ts.map b/node_modules/datastore-core/dist/src/memory.d.ts.map
index 8ca48b9..01f90d2 100644
--- a/node_modules/datastore-core/dist/src/memory.d.ts.map
+++ b/node_modules/datastore-core/dist/src/memory.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"memory.d.ts","sourceRoot":"","sources":["../../src/memory.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,MAAM,yBAAyB,CAAA;AAE7C,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAA;AACzC,OAAO,KAAK,EAAE,IAAI,EAAE,MAAM,qBAAqB,CAAA;AAC/C,OAAO,KAAK,EAAE,KAAK,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAE3D,qBAAa,eAAgB,SAAQ,aAAa;IAChD,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAyB;;IAQ9C,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,UAAU,GAAG,KAAK,CAAC,GAAG,CAAC;IAM3C,GAAG,CAAE,GAAG,EAAE,GAAG,GAAG,KAAK,CAAC,UAAU,CAAC;IAUjC,GAAG,CAAE,GAAG,EAAE,GAAG,GAAG,KAAK,CAAC,OAAO,CAAC;IAI9B,MAAM,CAAE,GAAG,EAAE,GAAG,GAAG,KAAK,CAAC,IAAI,CAAC;IAI5B,IAAI,IAAK,aAAa,CAAC,IAAI,CAAC;IAM5B,QAAQ,IAAK,aAAa,CAAC,GAAG,CAAC;CAKlC"}
\ No newline at end of file
+{"version":3,"file":"memory.d.ts","sourceRoot":"","sources":["../../src/memory.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,MAAM,yBAAyB,CAAA;AAE7C,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAA;AACzC,OAAO,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,qBAAqB,CAAA;AAChE,OAAO,KAAK,EAAE,YAAY,EAAE,KAAK,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAEzE,qBAAa,eAAgB,SAAQ,aAAa;IAChD,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAyB;;IAQ9C,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,UAAU,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,KAAK,CAAC,GAAG,CAAC;IAQnE,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,KAAK,CAAC,UAAU,CAAC;IAYzD,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,KAAK,CAAC,OAAO,CAAC;IAKtD,MAAM,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,KAAK,CAAC,IAAI,CAAC;IAKpD,IAAI,CAAE,CAAC,EAAE,KAAK,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,IAAI,CAAC;IAQ5D,QAAQ,CAAE,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,GAAG,CAAC;CAOrE"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/memory.js b/node_modules/datastore-core/dist/src/memory.js
index 319a83f..777e107 100644
--- a/node_modules/datastore-core/dist/src/memory.js
+++ b/node_modules/datastore-core/dist/src/memory.js
@@ -7,31 +7,39 @@ export class MemoryDatastore extends BaseDatastore {
         super();
         this.data = new Map();
     }
-    put(key, val) {
+    put(key, val, options) {
+        options?.signal?.throwIfAborted();
         this.data.set(key.toString(), val);
         return key;
     }
-    get(key) {
+    get(key, options) {
+        options?.signal?.throwIfAborted();
         const result = this.data.get(key.toString());
         if (result == null) {
             throw new NotFoundError();
         }
         return result;
     }
-    has(key) {
+    has(key, options) {
+        options?.signal?.throwIfAborted();
         return this.data.has(key.toString());
     }
-    delete(key) {
+    delete(key, options) {
+        options?.signal?.throwIfAborted();
         this.data.delete(key.toString());
     }
-    *_all() {
+    *_all(q, options) {
+        options?.signal?.throwIfAborted();
         for (const [key, value] of this.data.entries()) {
             yield { key: new Key(key), value };
+            options?.signal?.throwIfAborted();
         }
     }
-    *_allKeys() {
+    *_allKeys(q, options) {
+        options?.signal?.throwIfAborted();
         for (const key of this.data.keys()) {
             yield new Key(key);
+            options?.signal?.throwIfAborted();
         }
     }
 }
diff --git a/node_modules/datastore-core/dist/src/memory.js.map b/node_modules/datastore-core/dist/src/memory.js.map
index f270483..97d4e3b 100644
--- a/node_modules/datastore-core/dist/src/memory.js.map
+++ b/node_modules/datastore-core/dist/src/memory.js.map
@@ -1 +1 @@
-{"version":3,"file":"memory.js","sourceRoot":"","sources":["../../src/memory.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,MAAM,yBAAyB,CAAA;AAC7C,OAAO,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAC/C,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAA;AAIzC,MAAM,OAAO,eAAgB,SAAQ,aAAa;IAC/B,IAAI,CAAyB;IAE9C;QACE,KAAK,EAAE,CAAA;QAEP,IAAI,CAAC,IAAI,GAAG,IAAI,GAAG,EAAE,CAAA;IACvB,CAAC;IAED,GAAG,CAAE,GAAQ,EAAE,GAAe;QAC5B,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,CAAA;QAElC,OAAO,GAAG,CAAA;IACZ,CAAC;IAED,GAAG,CAAE,GAAQ;QACX,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAA;QAE5C,IAAI,MAAM,IAAI,IAAI,EAAE,CAAC;YACnB,MAAM,IAAI,aAAa,EAAE,CAAA;QAC3B,CAAC;QAED,OAAO,MAAM,CAAA;IACf,CAAC;IAED,GAAG,CAAE,GAAQ;QACX,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAA;IACtC,CAAC;IAED,MAAM,CAAE,GAAQ;QACd,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAA;IAClC,CAAC;IAED,CAAE,IAAI;QACJ,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,CAAC;YAC/C,MAAM,EAAE,GAAG,EAAE,IAAI,GAAG,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,CAAA;QACpC,CAAC;IACH,CAAC;IAED,CAAE,QAAQ;QACR,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC;YACnC,MAAM,IAAI,GAAG,CAAC,GAAG,CAAC,CAAA;QACpB,CAAC;IACH,CAAC;CACF"}
\ No newline at end of file
+{"version":3,"file":"memory.js","sourceRoot":"","sources":["../../src/memory.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,MAAM,yBAAyB,CAAA;AAC7C,OAAO,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAC/C,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAA;AAIzC,MAAM,OAAO,eAAgB,SAAQ,aAAa;IAC/B,IAAI,CAAyB;IAE9C;QACE,KAAK,EAAE,CAAA;QAEP,IAAI,CAAC,IAAI,GAAG,IAAI,GAAG,EAAE,CAAA;IACvB,CAAC;IAED,GAAG,CAAE,GAAQ,EAAE,GAAe,EAAE,OAAsB;QACpD,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QAEjC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,GAAG,CAAC,CAAA;QAElC,OAAO,GAAG,CAAA;IACZ,CAAC;IAED,GAAG,CAAE,GAAQ,EAAE,OAAsB;QACnC,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QAEjC,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAA;QAE5C,IAAI,MAAM,IAAI,IAAI,EAAE,CAAC;YACnB,MAAM,IAAI,aAAa,EAAE,CAAA;QAC3B,CAAC;QAED,OAAO,MAAM,CAAA;IACf,CAAC;IAED,GAAG,CAAE,GAAQ,EAAE,OAAsB;QACnC,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QACjC,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAA;IACtC,CAAC;IAED,MAAM,CAAE,GAAQ,EAAE,OAAsB;QACtC,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QACjC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAA;IAClC,CAAC;IAED,CAAE,IAAI,CAAE,CAAQ,EAAE,OAAsB;QACtC,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QACjC,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,CAAC;YAC/C,MAAM,EAAE,GAAG,EAAE,IAAI,GAAG,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,CAAA;YAClC,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QACnC,CAAC;IACH,CAAC;IAED,CAAE,QAAQ,CAAE,CAAW,EAAE,OAAsB;QAC7C,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QACjC,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC;YACnC,MAAM,IAAI,GAAG,CAAC,GAAG,CAAC,CAAA;YAClB,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,CAAA;QACnC,CAAC;IACH,CAAC;CACF"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/mount.js b/node_modules/datastore-core/dist/src/mount.js
index fd56f78..bccc06f 100644
--- a/node_modules/datastore-core/dist/src/mount.js
+++ b/node_modules/datastore-core/dist/src/mount.js
@@ -97,17 +97,20 @@ export class MountDatastore extends BaseDatastore {
             }, options);
         });
         let it = merge(...qs);
-        if (q.filters != null)
+        if (q.filters != null) {
             q.filters.forEach(f => { it = filter(it, f); });
-        if (q.orders != null)
+        }
+        if (q.orders != null) {
             q.orders.forEach(o => { it = sort(it, o); });
+        }
         if (q.offset != null) {
             let i = 0;
             const offset = q.offset;
             it = filter(it, () => i++ >= offset);
         }
-        if (q.limit != null)
+        if (q.limit != null) {
             it = take(it, q.limit);
+        }
         return it;
     }
     queryKeys(q, options) {
@@ -119,17 +122,20 @@ export class MountDatastore extends BaseDatastore {
         });
         /** @type AsyncIterable<Key> */
         let it = merge(...qs);
-        if (q.filters != null)
+        if (q.filters != null) {
             q.filters.forEach(f => { it = filter(it, f); });
-        if (q.orders != null)
+        }
+        if (q.orders != null) {
             q.orders.forEach(o => { it = sort(it, o); });
+        }
         if (q.offset != null) {
             let i = 0;
             const offset = q.offset;
             it = filter(it, () => i++ >= offset);
         }
-        if (q.limit != null)
+        if (q.limit != null) {
             it = take(it, q.limit);
+        }
         return it;
     }
 }
diff --git a/node_modules/datastore-core/dist/src/mount.js.map b/node_modules/datastore-core/dist/src/mount.js.map
index 21e6cd6..469e3dc 100644
--- a/node_modules/datastore-core/dist/src/mount.js.map
+++ b/node_modules/datastore-core/dist/src/mount.js.map
@@ -1 +1 @@
-{"version":3,"file":"mount.js","sourceRoot":"","sources":["../../src/mount.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"mount.js","sourceRoot":"","sources":["../../src/mount.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/namespace.d.ts b/node_modules/datastore-core/dist/src/namespace.d.ts
index 4cc57bd..fbc5d69 100644
--- a/node_modules/datastore-core/dist/src/namespace.d.ts
+++ b/node_modules/datastore-core/dist/src/namespace.d.ts
@@ -1,5 +1,6 @@
-import { Key, type Datastore, type Query, type Pair, type KeyQuery } from 'interface-datastore';
+import { Key } from 'interface-datastore';
 import { KeyTransformDatastore } from './keytransform.js';
+import type { Datastore, Query, Pair, KeyQuery } from 'interface-datastore';
 import type { AbortOptions } from 'interface-store';
 /**
  * Wraps a given datastore into a keytransform which
diff --git a/node_modules/datastore-core/dist/src/namespace.d.ts.map b/node_modules/datastore-core/dist/src/namespace.d.ts.map
index 828268c..c54d07b 100644
--- a/node_modules/datastore-core/dist/src/namespace.d.ts.map
+++ b/node_modules/datastore-core/dist/src/namespace.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"namespace.d.ts","sourceRoot":"","sources":["../../src/namespace.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,KAAK,SAAS,EAAE,KAAK,KAAK,EAAE,KAAK,IAAI,EAAE,KAAK,QAAQ,EAAE,MAAM,qBAAqB,CAAA;AAE/F,OAAO,EAAE,qBAAqB,EAAE,MAAM,mBAAmB,CAAA;AACzD,OAAO,KAAK,EAAE,YAAY,EAAE,MAAM,iBAAiB,CAAA;AAEnD;;;;;;;GAOG;AACH,qBAAa,kBAAmB,SAAQ,qBAAqB;IAC3D,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAW;IAClC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAK;gBAEb,KAAK,EAAE,SAAS,EAAE,MAAM,EAAE,GAAG;IAsB1C,KAAK,CAAE,CAAC,EAAE,KAAK,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,IAAI,CAAC;IAoC7D,SAAS,CAAE,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,GAAG,CAAC;CAgCpE"}
\ No newline at end of file
+{"version":3,"file":"namespace.d.ts","sourceRoot":"","sources":["../../src/namespace.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,MAAM,qBAAqB,CAAA;AAEzC,OAAO,EAAE,qBAAqB,EAAE,MAAM,mBAAmB,CAAA;AACzD,OAAO,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,qBAAqB,CAAA;AAC3E,OAAO,KAAK,EAAE,YAAY,EAAE,MAAM,iBAAiB,CAAA;AAEnD;;;;;;;GAOG;AACH,qBAAa,kBAAmB,SAAQ,qBAAqB;IAC3D,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAW;IAClC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAK;gBAEb,KAAK,EAAE,SAAS,EAAE,MAAM,EAAE,GAAG;IAsB1C,KAAK,CAAE,CAAC,EAAE,KAAK,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,IAAI,CAAC;IAoC7D,SAAS,CAAE,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,GAAG,CAAC;CAgCpE"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/namespace.js.map b/node_modules/datastore-core/dist/src/namespace.js.map
index 5b0591d..372c424 100644
--- a/node_modules/datastore-core/dist/src/namespace.js.map
+++ b/node_modules/datastore-core/dist/src/namespace.js.map
@@ -1 +1 @@
-{"version":3,"file":"namespace.js","sourceRoot":"","sources":["../../src/namespace.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"namespace.js","sourceRoot":"","sources":["../../src/namespace.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/shard.d.ts.map b/node_modules/datastore-core/dist/src/shard.d.ts.map
index 61a2a41..b9d73dc 100644
--- a/node_modules/datastore-core/dist/src/shard.d.ts.map
+++ b/node_modules/datastore-core/dist/src/shard.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"shard.d.ts","sourceRoot":"","sources":["../../src/shard.ts"],"names":[],"mappings":"AACA,OAAO,KAAK,EAAE,KAAK,EAAE,MAAM,YAAY,CAAA;AACvC,OAAO,KAAK,EAAE,SAAS,EAAE,MAAM,qBAAqB,CAAA;AAEpD,eAAO,MAAM,MAAM,wBAAwB,CAAA;AAC3C,eAAO,MAAM,WAAW,aAAa,CAAA;AAErC,qBAAa,SAAU,YAAW,KAAK;IAC9B,KAAK,EAAE,MAAM,CAAA;IACb,IAAI,EAAE,MAAM,CAAA;IACZ,QAAQ,EAAE,MAAM,CAAA;gBAEV,KAAK,EAAE,MAAM;IAM1B,GAAG,CAAE,CAAC,EAAE,MAAM,GAAG,MAAM;IAIvB,QAAQ,IAAK,MAAM;CAGpB;AAED,qBAAa,MAAO,SAAQ,SAAS;gBACtB,SAAS,EAAE,MAAM;IAM9B,GAAG,CAAE,OAAO,EAAE,MAAM,GAAG,MAAM;CAG9B;AAED,qBAAa,MAAO,SAAQ,SAAS;gBACtB,SAAS,EAAE,MAAM;IAO9B,GAAG,CAAE,OAAO,EAAE,MAAM,GAAG,MAAM;CAI9B;AAED,qBAAa,UAAW,SAAQ,SAAS;gBAC1B,SAAS,EAAE,MAAM;IAM9B,GAAG,CAAE,OAAO,EAAE,MAAM,GAAG,MAAM;CAK9B;AAED;;GAEG;AACH,wBAAgB,aAAa,CAAE,GAAG,EAAE,MAAM,GAAG,KAAK,CAoCjD;AAED,eAAO,MAAM,YAAY,SAAgB,MAAM,GAAG,UAAU,SAAS,SAAS,KAAG,QAAQ,KAAK,CAM7F,CAAA"}
\ No newline at end of file
+{"version":3,"file":"shard.d.ts","sourceRoot":"","sources":["../../src/shard.ts"],"names":[],"mappings":"AACA,OAAO,KAAK,EAAE,KAAK,EAAE,MAAM,YAAY,CAAA;AACvC,OAAO,KAAK,EAAE,SAAS,EAAE,MAAM,qBAAqB,CAAA;AAEpD,eAAO,MAAM,MAAM,wBAAwB,CAAA;AAC3C,eAAO,MAAM,WAAW,aAAa,CAAA;AAErC,qBAAa,SAAU,YAAW,KAAK;IAC9B,KAAK,EAAE,MAAM,CAAA;IACb,IAAI,EAAE,MAAM,CAAA;IACZ,QAAQ,EAAE,MAAM,CAAA;gBAEV,KAAK,EAAE,MAAM;IAM1B,GAAG,CAAE,CAAC,EAAE,MAAM,GAAG,MAAM;IAIvB,QAAQ,IAAK,MAAM;CAGpB;AAED,qBAAa,MAAO,SAAQ,SAAS;gBACtB,SAAS,EAAE,MAAM;IAM9B,GAAG,CAAE,OAAO,EAAE,MAAM,GAAG,MAAM;CAG9B;AAED,qBAAa,MAAO,SAAQ,SAAS;gBACtB,SAAS,EAAE,MAAM;IAO9B,GAAG,CAAE,OAAO,EAAE,MAAM,GAAG,MAAM;CAI9B;AAED,qBAAa,UAAW,SAAQ,SAAS;gBAC1B,SAAS,EAAE,MAAM;IAM9B,GAAG,CAAE,OAAO,EAAE,MAAM,GAAG,MAAM;CAK9B;AAED;;GAEG;AACH,wBAAgB,aAAa,CAAE,GAAG,EAAE,MAAM,GAAG,KAAK,CAoCjD;AAED,eAAO,MAAM,YAAY,GAAU,MAAM,MAAM,GAAG,UAAU,EAAE,OAAO,SAAS,KAAG,OAAO,CAAC,KAAK,CAM7F,CAAA"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/tiered.d.ts.map b/node_modules/datastore-core/dist/src/tiered.d.ts.map
index 81372d1..ffee91d 100644
--- a/node_modules/datastore-core/dist/src/tiered.d.ts.map
+++ b/node_modules/datastore-core/dist/src/tiered.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"tiered.d.ts","sourceRoot":"","sources":["../../src/tiered.ts"],"names":[],"mappings":"AAIA,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAA;AACzC,OAAO,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,qBAAqB,CAAA;AACvF,OAAO,KAAK,EAAE,YAAY,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAIlE;;;;;;GAMG;AACH,qBAAa,eAAgB,SAAQ,aAAa;IAChD,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAa;gBAEvB,MAAM,EAAE,SAAS,EAAE;IAM1B,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,UAAU,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,OAAO,CAAC,GAAG,CAAC;IASvE,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,OAAO,CAAC,UAAU,CAAC;IAY3D,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,OAAO,CAAC,OAAO,CAAC;IAUxD,MAAM,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,OAAO,CAAC,IAAI,CAAC;IAQtD,OAAO,CAAE,MAAM,EAAE,aAAa,CAAC,IAAI,CAAC,EAAE,OAAO,GAAE,YAAiB,GAAG,aAAa,CAAC,GAAG,CAAC;IA+BrF,UAAU,CAAE,MAAM,EAAE,aAAa,CAAC,GAAG,CAAC,EAAE,OAAO,GAAE,YAAiB,GAAG,aAAa,CAAC,GAAG,CAAC;IA+B/F,KAAK,IAAK,KAAK;IAkBf,KAAK,CAAE,CAAC,EAAE,KAAK,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,IAAI,CAAC;IAI7D,SAAS,CAAE,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,GAAG,CAAC;CAGpE"}
\ No newline at end of file
+{"version":3,"file":"tiered.d.ts","sourceRoot":"","sources":["../../src/tiered.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAA;AACzC,OAAO,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,qBAAqB,CAAA;AACvF,OAAO,KAAK,EAAE,YAAY,EAAE,aAAa,EAAE,MAAM,iBAAiB,CAAA;AAIlE;;;;;;GAMG;AACH,qBAAa,eAAgB,SAAQ,aAAa;IAChD,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAa;gBAEvB,MAAM,EAAE,SAAS,EAAE;IAM1B,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,UAAU,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,OAAO,CAAC,GAAG,CAAC;IAUvE,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,OAAO,CAAC,UAAU,CAAC;IAmB3D,GAAG,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,OAAO,CAAC,OAAO,CAAC;IAUxD,MAAM,CAAE,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,OAAO,CAAC,IAAI,CAAC;IAQtD,OAAO,CAAE,MAAM,EAAE,aAAa,CAAC,IAAI,CAAC,EAAE,OAAO,GAAE,YAAiB,GAAG,aAAa,CAAC,GAAG,CAAC;IAOrF,UAAU,CAAE,MAAM,EAAE,aAAa,CAAC,GAAG,CAAC,EAAE,OAAO,GAAE,YAAiB,GAAG,aAAa,CAAC,GAAG,CAAC;IAO/F,KAAK,IAAK,KAAK;IAkBf,KAAK,CAAE,CAAC,EAAE,KAAK,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,IAAI,CAAC;IAI7D,SAAS,CAAE,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,aAAa,CAAC,GAAG,CAAC;CAGpE"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/tiered.js b/node_modules/datastore-core/dist/src/tiered.js
index 448d2eb..560fc44 100644
--- a/node_modules/datastore-core/dist/src/tiered.js
+++ b/node_modules/datastore-core/dist/src/tiered.js
@@ -1,7 +1,5 @@
 import { logger } from '@libp2p/logger';
-import { PutFailedError, NotFoundError, DeleteFailedError } from 'interface-store';
-import drain from 'it-drain';
-import { pushable } from 'it-pushable';
+import { NotFoundError } from 'interface-store';
 import { BaseDatastore } from './base.js';
 const log = logger('datastore:core:tiered');
 /**
@@ -18,26 +16,26 @@ export class TieredDatastore extends BaseDatastore {
         this.stores = stores.slice();
     }
     async put(key, value, options) {
-        try {
-            await Promise.all(this.stores.map(async (store) => { await store.put(key, value, options); }));
-            return key;
-        }
-        catch (err) {
-            throw new PutFailedError(err.message);
-        }
+        await Promise.all(this.stores.map(async (store) => {
+            await store.put(key, value, options);
+        }));
+        return key;
     }
     async get(key, options) {
+        let error;
         for (const store of this.stores) {
             try {
                 const res = await store.get(key, options);
-                if (res != null)
+                if (res != null) {
                     return res;
+                }
             }
             catch (err) {
+                error = err;
                 log.error(err);
             }
         }
-        throw new NotFoundError();
+        throw error ?? new NotFoundError();
     }
     async has(key, options) {
         for (const s of this.stores) {
@@ -48,63 +46,20 @@ export class TieredDatastore extends BaseDatastore {
         return false;
     }
     async delete(key, options) {
-        try {
-            await Promise.all(this.stores.map(async (store) => { await store.delete(key, options); }));
-        }
-        catch (err) {
-            throw new DeleteFailedError(err.message);
-        }
+        await Promise.all(this.stores.map(async (store) => {
+            await store.delete(key, options);
+        }));
     }
     async *putMany(source, options = {}) {
-        let error;
-        const pushables = this.stores.map(store => {
-            const source = pushable({
-                objectMode: true
-            });
-            drain(store.putMany(source, options))
-                .catch(err => {
-                // store threw while putting, make sure we bubble the error up
-                error = err;
-            });
-            return source;
-        });
-        try {
-            for await (const pair of source) {
-                if (error != null) {
-                    throw error;
-                }
-                pushables.forEach(p => p.push(pair));
-                yield pair.key;
-            }
-        }
-        finally {
-            pushables.forEach(p => p.end());
+        for await (const pair of source) {
+            await this.put(pair.key, pair.value, options);
+            yield pair.key;
         }
     }
     async *deleteMany(source, options = {}) {
-        let error;
-        const pushables = this.stores.map(store => {
-            const source = pushable({
-                objectMode: true
-            });
-            drain(store.deleteMany(source, options))
-                .catch(err => {
-                // store threw while deleting, make sure we bubble the error up
-                error = err;
-            });
-            return source;
-        });
-        try {
-            for await (const key of source) {
-                if (error != null) {
-                    throw error;
-                }
-                pushables.forEach(p => p.push(key));
-                yield key;
-            }
-        }
-        finally {
-            pushables.forEach(p => p.end());
+        for await (const key of source) {
+            await this.delete(key, options);
+            yield key;
         }
     }
     batch() {
diff --git a/node_modules/datastore-core/dist/src/tiered.js.map b/node_modules/datastore-core/dist/src/tiered.js.map
index 4fcc180..e5b6abe 100644
--- a/node_modules/datastore-core/dist/src/tiered.js.map
+++ b/node_modules/datastore-core/dist/src/tiered.js.map
@@ -1 +1 @@
-{"version":3,"file":"tiered.js","sourceRoot":"","sources":["../../src/tiered.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"tiered.js","sourceRoot":"","sources":["../../src/tiered.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/src/utils.d.ts.map b/node_modules/datastore-core/dist/src/utils.d.ts.map
index 3291552..207d936 100644
--- a/node_modules/datastore-core/dist/src/utils.d.ts.map
+++ b/node_modules/datastore-core/dist/src/utils.d.ts.map
@@ -1 +1 @@
-{"version":3,"file":"utils.d.ts","sourceRoot":"","sources":["../../src/utils.ts"],"names":[],"mappings":"AAAA,eAAO,MAAM,gBAAgB,MAAO,MAAM,KAAK,MAAM,KAAG,MAGvD,CAAA"}
\ No newline at end of file
+{"version":3,"file":"utils.d.ts","sourceRoot":"","sources":["../../src/utils.ts"],"names":[],"mappings":"AAAA,eAAO,MAAM,gBAAgB,GAAI,GAAG,MAAM,EAAE,GAAG,MAAM,KAAG,MAGvD,CAAA"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/keytransform.spec.d.ts b/node_modules/datastore-core/dist/test/keytransform.spec.d.ts
new file mode 100644
index 0000000..a645b65
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/keytransform.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=keytransform.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/keytransform.spec.d.ts.map b/node_modules/datastore-core/dist/test/keytransform.spec.d.ts.map
new file mode 100644
index 0000000..6a24cd8
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/keytransform.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"keytransform.spec.d.ts","sourceRoot":"","sources":["../../test/keytransform.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/keytransform.spec.js b/node_modules/datastore-core/dist/test/keytransform.spec.js
new file mode 100644
index 0000000..e9d5ae4
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/keytransform.spec.js
@@ -0,0 +1,47 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { Key } from 'interface-datastore/key';
+import all from 'it-all';
+import { KeyTransformDatastore } from '../src/keytransform.js';
+import { MemoryDatastore } from '../src/memory.js';
+describe('KeyTransformDatastore', () => {
+    it('basic', async () => {
+        const mStore = new MemoryDatastore();
+        const transform = {
+            convert(key) {
+                return new Key('/abc').child(key);
+            },
+            invert(key) {
+                const l = key.list();
+                if (l[0] !== 'abc') {
+                    throw new Error('missing prefix, convert failed?');
+                }
+                return Key.withNamespaces(l.slice(1));
+            }
+        };
+        const kStore = new KeyTransformDatastore(mStore, transform);
+        const keys = [
+            'foo',
+            'foo/bar',
+            'foo/bar/baz',
+            'foo/barb',
+            'foo/bar/bazb',
+            'foo/bar/baz/barb'
+        ].map((s) => new Key(s));
+        await Promise.all(keys.map(async (key) => { await kStore.put(key, key.uint8Array()); }));
+        const kResults = Promise.all(keys.map(async (key) => kStore.get(key)));
+        const mResults = Promise.all(keys.map(async (key) => mStore.get(new Key('abc').child(key))));
+        const results = await Promise.all([kResults, mResults]);
+        expect(results[0]).to.eql(results[1]);
+        const mRes = await all(mStore.query({}));
+        const kRes = await all(kStore.query({}));
+        expect(kRes).to.have.length(mRes.length);
+        mRes.forEach((a, i) => {
+            const kA = a.key;
+            const kB = kRes[i].key;
+            expect(transform.invert(kA)).to.eql(kB);
+            expect(kA).to.eql(transform.convert(kB));
+        });
+    });
+});
+//# sourceMappingURL=keytransform.spec.js.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/keytransform.spec.js.map b/node_modules/datastore-core/dist/test/keytransform.spec.js.map
new file mode 100644
index 0000000..010add1
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/keytransform.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"keytransform.spec.js","sourceRoot":"","sources":["../../test/keytransform.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/memory.spec.d.ts b/node_modules/datastore-core/dist/test/memory.spec.d.ts
new file mode 100644
index 0000000..6c30f83
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/memory.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=memory.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/memory.spec.d.ts.map b/node_modules/datastore-core/dist/test/memory.spec.d.ts.map
new file mode 100644
index 0000000..b13ab41
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/memory.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"memory.spec.d.ts","sourceRoot":"","sources":["../../test/memory.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/memory.spec.js b/node_modules/datastore-core/dist/test/memory.spec.js
new file mode 100644
index 0000000..22741c1
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/memory.spec.js
@@ -0,0 +1,14 @@
+/* eslint-env mocha */
+import { interfaceDatastoreTests } from 'interface-datastore-tests';
+import { MemoryDatastore } from '../src/memory.js';
+describe('Memory', () => {
+    describe('interface-datastore', () => {
+        interfaceDatastoreTests({
+            setup() {
+                return new MemoryDatastore();
+            },
+            teardown() { }
+        });
+    });
+});
+//# sourceMappingURL=memory.spec.js.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/memory.spec.js.map b/node_modules/datastore-core/dist/test/memory.spec.js.map
new file mode 100644
index 0000000..8b2e963
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/memory.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"memory.spec.js","sourceRoot":"","sources":["../../test/memory.spec.ts"],"names":[],"mappings":"AAAA,sBAAsB;AAEtB,OAAO,EAAE,uBAAuB,EAAE,MAAM,2BAA2B,CAAA;AACnE,OAAO,EAAE,eAAe,EAAE,MAAM,kBAAkB,CAAA;AAElD,QAAQ,CAAC,QAAQ,EAAE,GAAG,EAAE;IACtB,QAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE;QACnC,uBAAuB,CAAC;YACtB,KAAK;gBACH,OAAO,IAAI,eAAe,EAAE,CAAA;YAC9B,CAAC;YACD,QAAQ,KAAK,CAAC;SACf,CAAC,CAAA;IACJ,CAAC,CAAC,CAAA;AACJ,CAAC,CAAC,CAAA"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/mount.spec.d.ts b/node_modules/datastore-core/dist/test/mount.spec.d.ts
new file mode 100644
index 0000000..8669ce6
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/mount.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=mount.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/mount.spec.d.ts.map b/node_modules/datastore-core/dist/test/mount.spec.d.ts.map
new file mode 100644
index 0000000..0aeac4c
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/mount.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"mount.spec.d.ts","sourceRoot":"","sources":["../../test/mount.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/mount.spec.js b/node_modules/datastore-core/dist/test/mount.spec.js
new file mode 100644
index 0000000..04958a1
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/mount.spec.js
@@ -0,0 +1,122 @@
+/* eslint-env mocha */
+/* eslint max-nested-callbacks: ["error", 8] */
+import { expect, assert } from 'aegir/chai';
+import { Key } from 'interface-datastore/key';
+import { interfaceDatastoreTests } from 'interface-datastore-tests';
+import all from 'it-all';
+import { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';
+import { KeyTransformDatastore } from '../src/keytransform.js';
+import { MemoryDatastore } from '../src/memory.js';
+import { MountDatastore } from '../src/mount.js';
+const stripPrefixDatastore = (datastore, prefix) => {
+    return new KeyTransformDatastore(datastore, {
+        convert: (key) => {
+            if (!prefix.isAncestorOf(key)) {
+                throw new Error(`Expected prefix: (${prefix.toString()}) in key: ${key.toString()}`);
+            }
+            return Key.withNamespaces(key.namespaces().slice(prefix.namespaces().length));
+        },
+        invert: (key) => Key.withNamespaces([...prefix.namespaces(), ...key.namespaces()])
+    });
+};
+describe('MountDatastore', () => {
+    it('put - no mount', async () => {
+        const m = new MountDatastore([]);
+        try {
+            await m.put(new Key('hello'), uint8ArrayFromString('foo'));
+            assert(false, 'Failed to throw error on no mount');
+        }
+        catch (err) {
+            expect(err).to.be.an('Error');
+        }
+    });
+    it('put - wrong mount', async () => {
+        const m = new MountDatastore([{
+                datastore: stripPrefixDatastore(new MemoryDatastore(), new Key('cool')),
+                prefix: new Key('cool')
+            }]);
+        try {
+            await m.put(new Key('/fail/hello'), uint8ArrayFromString('foo'));
+            assert(false, 'Failed to throw error on wrong mount');
+        }
+        catch (err) {
+            expect(err).to.be.an('Error');
+        }
+    });
+    it('put', async () => {
+        const mds = new MemoryDatastore();
+        const m = new MountDatastore([{
+                datastore: stripPrefixDatastore(mds, new Key('cool')),
+                prefix: new Key('cool')
+            }]);
+        const val = uint8ArrayFromString('hello');
+        await m.put(new Key('/cool/hello'), val);
+        const res = await mds.get(new Key('/hello'));
+        expect(res).to.eql(val);
+    });
+    it('get', async () => {
+        const mds = new MemoryDatastore();
+        const m = new MountDatastore([{
+                datastore: stripPrefixDatastore(mds, new Key('cool')),
+                prefix: new Key('cool')
+            }]);
+        const val = uint8ArrayFromString('hello');
+        await mds.put(new Key('/hello'), val);
+        const res = await m.get(new Key('/cool/hello'));
+        expect(res).to.eql(val);
+    });
+    it('has', async () => {
+        const mds = new MemoryDatastore();
+        const m = new MountDatastore([{
+                datastore: stripPrefixDatastore(mds, new Key('cool')),
+                prefix: new Key('cool')
+            }]);
+        const val = uint8ArrayFromString('hello');
+        await mds.put(new Key('/hello'), val);
+        const exists = await m.has(new Key('/cool/hello'));
+        expect(exists).to.eql(true);
+    });
+    it('delete', async () => {
+        const mds = new MemoryDatastore();
+        const m = new MountDatastore([{
+                datastore: stripPrefixDatastore(mds, new Key('cool')),
+                prefix: new Key('cool')
+            }]);
+        const val = uint8ArrayFromString('hello');
+        await m.put(new Key('/cool/hello'), val);
+        await m.delete(new Key('/cool/hello'));
+        let exists = await m.has(new Key('/cool/hello'));
+        expect(exists).to.eql(false);
+        exists = await mds.has(new Key('/hello'));
+        expect(exists).to.eql(false);
+    });
+    it('query simple', async () => {
+        const mds = new MemoryDatastore();
+        const m = new MountDatastore([{
+                datastore: stripPrefixDatastore(mds, new Key('cool')),
+                prefix: new Key('cool')
+            }]);
+        const val = uint8ArrayFromString('hello');
+        await m.put(new Key('/cool/hello'), val);
+        const res = await all(m.query({ prefix: '/cool' }));
+        expect(res).to.eql([{ key: new Key('/cool/hello'), value: val }]);
+    });
+    describe('interface-datastore', () => {
+        interfaceDatastoreTests({
+            setup() {
+                return new MountDatastore([{
+                        prefix: new Key('/a'),
+                        datastore: new MemoryDatastore()
+                    }, {
+                        prefix: new Key('/z'),
+                        datastore: new MemoryDatastore()
+                    }, {
+                        prefix: new Key('/q'),
+                        datastore: new MemoryDatastore()
+                    }]);
+            },
+            teardown() { }
+        });
+    });
+});
+//# sourceMappingURL=mount.spec.js.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/mount.spec.js.map b/node_modules/datastore-core/dist/test/mount.spec.js.map
new file mode 100644
index 0000000..5dd20f1
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/mount.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"mount.spec.js","sourceRoot":"","sources":["../../test/mount.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/namespace.spec.d.ts b/node_modules/datastore-core/dist/test/namespace.spec.d.ts
new file mode 100644
index 0000000..c3fce3f
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/namespace.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=namespace.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/namespace.spec.d.ts.map b/node_modules/datastore-core/dist/test/namespace.spec.d.ts.map
new file mode 100644
index 0000000..03a0cf5
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/namespace.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"namespace.spec.d.ts","sourceRoot":"","sources":["../../test/namespace.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/namespace.spec.js b/node_modules/datastore-core/dist/test/namespace.spec.js
new file mode 100644
index 0000000..f395cce
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/namespace.spec.js
@@ -0,0 +1,104 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { Key } from 'interface-datastore/key';
+import { interfaceDatastoreTests } from 'interface-datastore-tests';
+import all from 'it-all';
+import { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';
+import { MemoryDatastore } from '../src/memory.js';
+import { NamespaceDatastore } from '../src/namespace.js';
+describe('NamespaceDatastore', () => {
+    const prefixes = [
+        'abc',
+        ''
+    ];
+    const keys = [
+        'foo',
+        'foo/bar',
+        'foo/bar/baz',
+        'foo/barb',
+        'foo/bar/bazb',
+        'foo/bar/baz/barb'
+    ].map((s) => new Key(s));
+    prefixes.forEach((prefix) => it(`basic '${prefix}'`, async () => {
+        const mStore = new MemoryDatastore();
+        const store = new NamespaceDatastore(mStore, new Key(prefix));
+        await Promise.all(keys.map(async (key) => { await store.put(key, uint8ArrayFromString(key.toString())); }));
+        const nResults = Promise.all(keys.map(async (key) => store.get(key)));
+        const mResults = Promise.all(keys.map(async (key) => mStore.get(new Key(prefix).child(key))));
+        const results = await Promise.all([nResults, mResults]);
+        const mRes = await all(mStore.query({}));
+        const nRes = await all(store.query({}));
+        expect(nRes).to.have.length(mRes.length);
+        mRes.forEach((a, i) => {
+            const kA = a.key;
+            const kB = nRes[i].key;
+            expect(store.transform.invert(kA)).to.eql(kB);
+            expect(kA).to.eql(store.transform.convert(kB));
+        });
+        expect(results[0]).to.eql(results[1]);
+    }));
+    const setupStores = async (keys) => {
+        const prefixes = ['abc', '123', 'sub/prefix'];
+        const mStore = new MemoryDatastore();
+        return Promise.all(prefixes.map(async (prefix) => {
+            const store = new NamespaceDatastore(mStore, new Key(prefix));
+            await Promise.all(keys.map(async (key) => { await store.put(key, uint8ArrayFromString(key.toString())); }));
+            return store;
+        }));
+    };
+    const setupNestedStores = async (keys) => {
+        const prefixes = ['abc', '123', 'sub/prefix'];
+        const mStore = new MemoryDatastore();
+        return (await Promise.all(prefixes.map(async (prefix) => {
+            const store = new NamespaceDatastore(mStore, new Key(prefix));
+            return Promise.all(prefixes.map(async (prefix) => {
+                const child = new NamespaceDatastore(store, new Key(prefix));
+                await Promise.all(keys.map(async (key) => { await child.put(key, uint8ArrayFromString(key.toString())); }));
+                return child;
+            }));
+        }))).reduce((a, c) => [...a, ...c], []);
+    };
+    it('queries keys under each prefix', async () => {
+        const stores = await setupStores(keys);
+        for (const store of stores) {
+            const nRes = await all(store.queryKeys({}));
+            expect(nRes).deep.equal(keys);
+        }
+    });
+    it('queries values under each prefix', async () => {
+        const stores = await setupStores(keys);
+        for (const store of stores) {
+            const nRes = await all(store.query({}));
+            const values = keys.map(key => uint8ArrayFromString(key.toString()));
+            expect(nRes.map(p => p.key)).deep.equal(keys);
+            expect(nRes.map(p => p.value)).deep.equal(values);
+        }
+    });
+    it('queries keys under each prefix in nested stores', async () => {
+        const stores = await setupNestedStores(keys);
+        for (const store of stores) {
+            const nRes = await all(store.queryKeys({}));
+            expect(nRes).deep.equal(keys);
+        }
+    });
+    it('queries values under each prefix in nested stores', async () => {
+        const stores = await setupNestedStores(keys);
+        for (const store of stores) {
+            const nRes = await all(store.query({}));
+            const values = keys.map(key => uint8ArrayFromString(key.toString()));
+            expect(nRes.map(p => p.key)).deep.equal(keys);
+            expect(nRes.map(p => p.value)).deep.equal(values);
+        }
+    });
+    prefixes.forEach((prefix) => {
+        describe(`interface-datastore: '${prefix}'`, () => {
+            interfaceDatastoreTests({
+                setup() {
+                    return new NamespaceDatastore(new MemoryDatastore(), new Key(prefix));
+                },
+                async teardown() { }
+            });
+        });
+    });
+});
+//# sourceMappingURL=namespace.spec.js.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/namespace.spec.js.map b/node_modules/datastore-core/dist/test/namespace.spec.js.map
new file mode 100644
index 0000000..4d521b8
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/namespace.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"namespace.spec.js","sourceRoot":"","sources":["../../test/namespace.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/shard.spec.d.ts b/node_modules/datastore-core/dist/test/shard.spec.d.ts
new file mode 100644
index 0000000..86a736a
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/shard.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=shard.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/shard.spec.d.ts.map b/node_modules/datastore-core/dist/test/shard.spec.d.ts.map
new file mode 100644
index 0000000..d0648ae
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/shard.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"shard.spec.d.ts","sourceRoot":"","sources":["../../test/shard.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/shard.spec.js b/node_modules/datastore-core/dist/test/shard.spec.js
new file mode 100644
index 0000000..8fc2879
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/shard.spec.js
@@ -0,0 +1,46 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { Prefix, Suffix, NextToLast, parseShardFun } from '../src/shard.js';
+describe('shard', () => {
+    it('prefix', () => {
+        expect(new Prefix(2).fun('hello')).to.eql('he');
+        expect(new Prefix(2).fun('h')).to.eql('h_');
+        expect(new Prefix(2).toString()).to.eql('/repo/flatfs/shard/v1/prefix/2');
+    });
+    it('suffix', () => {
+        expect(new Suffix(2).fun('hello')).to.eql('lo');
+        expect(new Suffix(2).fun('h')).to.eql('_h');
+        expect(new Suffix(2).toString()).to.eql('/repo/flatfs/shard/v1/suffix/2');
+    });
+    it('next-to-last', () => {
+        expect(new NextToLast(2).fun('hello')).to.eql('ll');
+        expect(new NextToLast(3).fun('he')).to.eql('__h');
+        expect(new NextToLast(2).toString()).to.eql('/repo/flatfs/shard/v1/next-to-last/2');
+    });
+});
+describe('parsesShardFun', () => {
+    it('errors', () => {
+        const errors = [
+            '',
+            'shard/v1/next-to-last/2',
+            '/repo/flatfs/shard/v2/next-to-last/2',
+            '/repo/flatfs/shard/v1/other/2',
+            '/repo/flatfs/shard/v1/next-to-last/'
+        ];
+        errors.forEach((input) => {
+            expect(() => parseShardFun(input)).to.throw();
+        });
+    });
+    it('success', () => {
+        const success = [
+            'prefix',
+            'suffix',
+            'next-to-last'
+        ];
+        success.forEach((name) => {
+            const n = Math.floor(Math.random() * 100);
+            expect(parseShardFun(`/repo/flatfs/shard/v1/${name}/${n}`).name).to.eql(name);
+        });
+    });
+});
+//# sourceMappingURL=shard.spec.js.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/shard.spec.js.map b/node_modules/datastore-core/dist/test/shard.spec.js.map
new file mode 100644
index 0000000..616b3e6
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/shard.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"shard.spec.js","sourceRoot":"","sources":["../../test/shard.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/sharding.spec.d.ts b/node_modules/datastore-core/dist/test/sharding.spec.d.ts
new file mode 100644
index 0000000..90d19c0
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/sharding.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=sharding.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/sharding.spec.d.ts.map b/node_modules/datastore-core/dist/test/sharding.spec.d.ts.map
new file mode 100644
index 0000000..290b8ce
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/sharding.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"sharding.spec.d.ts","sourceRoot":"","sources":["../../test/sharding.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/sharding.spec.js b/node_modules/datastore-core/dist/test/sharding.spec.js
new file mode 100644
index 0000000..fcf6751
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/sharding.spec.js
@@ -0,0 +1,54 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { Key } from 'interface-datastore/key';
+import { interfaceDatastoreTests } from 'interface-datastore-tests';
+import { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';
+import { toString as uint8ArrayToString } from 'uint8arrays/to-string';
+import { MemoryDatastore } from '../src/memory.js';
+import { NextToLast, SHARDING_FN } from '../src/shard.js';
+import { ShardingDatastore } from '../src/sharding.js';
+describe('ShardingDatastore', () => {
+    it('create', async () => {
+        const ms = new MemoryDatastore();
+        const shard = new NextToLast(2);
+        const store = new ShardingDatastore(ms, shard);
+        await store.open();
+        const res = await Promise.all([
+            store.get(new Key(SHARDING_FN))
+        ]);
+        expect(uint8ArrayToString(res[0])).to.eql(shard.toString() + '\n');
+    });
+    it('open - empty', () => {
+        const ms = new MemoryDatastore();
+        // @ts-expect-error shard is missing
+        const store = new ShardingDatastore(ms);
+        return expect(store.open())
+            .to.eventually.be.rejected()
+            .with.property('name', 'OpenFailedError');
+    });
+    it('open - existing', () => {
+        const ms = new MemoryDatastore();
+        const shard = new NextToLast(2);
+        const store = new ShardingDatastore(ms, shard);
+        return expect(store.open()).to.eventually.be.fulfilled();
+    });
+    it('basics', async () => {
+        const ms = new MemoryDatastore();
+        const shard = new NextToLast(2);
+        const store = new ShardingDatastore(ms, shard);
+        await store.open();
+        await store.put(new Key('hello'), uint8ArrayFromString('test'));
+        const res = await ms.get(new Key('ll').child(new Key('hello')));
+        expect(res).to.eql(uint8ArrayFromString('test'));
+    });
+    describe('interface-datastore', () => {
+        interfaceDatastoreTests({
+            setup() {
+                const shard = new NextToLast(2);
+                return new ShardingDatastore(new MemoryDatastore(), shard);
+            },
+            teardown() { }
+        });
+    });
+});
+//# sourceMappingURL=sharding.spec.js.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/sharding.spec.js.map b/node_modules/datastore-core/dist/test/sharding.spec.js.map
new file mode 100644
index 0000000..0aa043d
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/sharding.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"sharding.spec.js","sourceRoot":"","sources":["../../test/sharding.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/tiered.spec.d.ts b/node_modules/datastore-core/dist/test/tiered.spec.d.ts
new file mode 100644
index 0000000..477ecc4
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/tiered.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=tiered.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/tiered.spec.d.ts.map b/node_modules/datastore-core/dist/test/tiered.spec.d.ts.map
new file mode 100644
index 0000000..d26b485
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/tiered.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"tiered.spec.d.ts","sourceRoot":"","sources":["../../test/tiered.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/tiered.spec.js b/node_modules/datastore-core/dist/test/tiered.spec.js
new file mode 100644
index 0000000..dd9f769
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/tiered.spec.js
@@ -0,0 +1,64 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import { Key } from 'interface-datastore/key';
+import { interfaceDatastoreTests } from 'interface-datastore-tests';
+import { fromString as uint8ArrayFromString } from 'uint8arrays/from-string';
+import { MemoryDatastore } from '../src/memory.js';
+import { TieredDatastore } from '../src/tiered.js';
+/**
+ * @typedef {import('interface-datastore').Datastore} Datastore
+ */
+describe('Tiered', () => {
+    describe('all stores', () => {
+        const ms = [];
+        let store;
+        beforeEach(() => {
+            ms.push(new MemoryDatastore());
+            ms.push(new MemoryDatastore());
+            store = new TieredDatastore(ms);
+        });
+        it('put', async () => {
+            const k = new Key('hello');
+            const v = uint8ArrayFromString('world');
+            await store.put(k, v);
+            const res = await Promise.all([ms[0].get(k), ms[1].get(k)]);
+            res.forEach((val) => {
+                expect(val).to.be.eql(v);
+            });
+        });
+        it('get and has, where available', async () => {
+            const k = new Key('hello');
+            const v = uint8ArrayFromString('world');
+            await ms[1].put(k, v);
+            const val = await store.get(k);
+            expect(val).to.be.eql(v);
+            const exists = await store.has(k);
+            expect(exists).to.be.eql(true);
+        });
+        it('has - key not found', async () => {
+            expect(await store.has(new Key('hello1'))).to.be.eql(false);
+        });
+        it('has and delete', async () => {
+            const k = new Key('hello');
+            const v = uint8ArrayFromString('world');
+            await store.put(k, v);
+            let res = await Promise.all([ms[0].has(k), ms[1].has(k)]);
+            expect(res).to.be.eql([true, true]);
+            await store.delete(k);
+            res = await Promise.all([ms[0].has(k), ms[1].has(k)]);
+            expect(res).to.be.eql([false, false]);
+        });
+    });
+    describe('inteface-datastore-single', () => {
+        interfaceDatastoreTests({
+            setup() {
+                return new TieredDatastore([
+                    new MemoryDatastore(),
+                    new MemoryDatastore()
+                ]);
+            },
+            teardown() { }
+        });
+    });
+});
+//# sourceMappingURL=tiered.spec.js.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/tiered.spec.js.map b/node_modules/datastore-core/dist/test/tiered.spec.js.map
new file mode 100644
index 0000000..03fb256
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/tiered.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"tiered.spec.js","sourceRoot":"","sources":["../../test/tiered.spec.ts"],"names":[],"mappings":"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"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/utils.spec.d.ts b/node_modules/datastore-core/dist/test/utils.spec.d.ts
new file mode 100644
index 0000000..defd4da
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/utils.spec.d.ts
@@ -0,0 +1,2 @@
+export {};
+//# sourceMappingURL=utils.spec.d.ts.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/utils.spec.d.ts.map b/node_modules/datastore-core/dist/test/utils.spec.d.ts.map
new file mode 100644
index 0000000..8f252e3
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/utils.spec.d.ts.map
@@ -0,0 +1 @@
+{"version":3,"file":"utils.spec.d.ts","sourceRoot":"","sources":["../../test/utils.spec.ts"],"names":[],"mappings":""}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/utils.spec.js b/node_modules/datastore-core/dist/test/utils.spec.js
new file mode 100644
index 0000000..5aee6ce
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/utils.spec.js
@@ -0,0 +1,10 @@
+/* eslint-env mocha */
+import { expect } from 'aegir/chai';
+import * as utils from '../src/utils.js';
+describe('utils', () => {
+    it('replaceStartWith', () => {
+        expect(utils.replaceStartWith('helloworld', 'hello')).to.eql('world');
+        expect(utils.replaceStartWith('helloworld', 'world')).to.eql('helloworld');
+    });
+});
+//# sourceMappingURL=utils.spec.js.map
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/test/utils.spec.js.map b/node_modules/datastore-core/dist/test/utils.spec.js.map
new file mode 100644
index 0000000..2579137
--- /dev/null
+++ b/node_modules/datastore-core/dist/test/utils.spec.js.map
@@ -0,0 +1 @@
+{"version":3,"file":"utils.spec.js","sourceRoot":"","sources":["../../test/utils.spec.ts"],"names":[],"mappings":"AAAA,sBAAsB;AAEtB,OAAO,EAAE,MAAM,EAAE,MAAM,YAAY,CAAA;AACnC,OAAO,KAAK,KAAK,MAAM,iBAAiB,CAAA;AAExC,QAAQ,CAAC,OAAO,EAAE,GAAG,EAAE;IACrB,EAAE,CAAC,kBAAkB,EAAE,GAAG,EAAE;QAC1B,MAAM,CACJ,KAAK,CAAC,gBAAgB,CAAC,YAAY,EAAE,OAAO,CAAC,CAC9C,CAAC,EAAE,CAAC,GAAG,CACN,OAAO,CACR,CAAA;QAED,MAAM,CACJ,KAAK,CAAC,gBAAgB,CAAC,YAAY,EAAE,OAAO,CAAC,CAC9C,CAAC,EAAE,CAAC,GAAG,CACN,YAAY,CACb,CAAA;IACH,CAAC,CAAC,CAAA;AACJ,CAAC,CAAC,CAAA"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/tsconfig.tsbuildinfo b/node_modules/datastore-core/dist/tsconfig.tsbuildinfo
new file mode 100644
index 0000000..44d123a
--- /dev/null
+++ b/node_modules/datastore-core/dist/tsconfig.tsbuildinfo
@@ -0,0 +1 @@
+{"fileNames":["../../../node_modules/typescript/lib/lib.es5.d.ts","../../../node_modules/typescript/lib/lib.es2015.d.ts","../../../node_modules/typescript/lib/lib.es2016.d.ts","../../../node_modules/typescript/lib/lib.es2017.d.ts","../../../node_modules/typescript/lib/lib.es2018.d.ts","../../../node_modules/typescript/lib/lib.es2019.d.ts","../../../node_modules/typescript/lib/lib.es2020.d.ts","../../../node_modules/typescript/lib/lib.es2021.d.ts","../../../node_modules/typescript/lib/lib.es2022.d.ts","../../../node_modules/typescript/lib/lib.es2023.d.ts","../../../node_modules/typescript/lib/lib.es2024.d.ts","../../../node_modules/typescript/lib/lib.dom.d.ts","../../../node_modules/typescript/lib/lib.dom.iterable.d.ts","../../../node_modules/typescript/lib/lib.webworker.d.ts","../../../node_modules/typescript/lib/lib.es2015.core.d.ts","../../../node_modules/typescript/lib/lib.es2015.collection.d.ts","../../../node_modules/typescript/lib/lib.es2015.generator.d.ts","../../../node_modules/typescript/lib/lib.es2015.iterable.d.ts","../../../node_modules/typescript/lib/lib.es2015.promise.d.ts","../../../node_modules/typescript/lib/lib.es2015.proxy.d.ts","../../../node_modules/typescript/lib/lib.es2015.reflect.d.ts","../../../node_modules/typescript/lib/lib.es2015.symbol.d.ts","../../../node_modules/typescript/lib/lib.es2015.symbol.wellknown.d.ts","../../../node_modules/typescript/lib/lib.es2016.array.include.d.ts","../../../node_modules/typescript/lib/lib.es2016.intl.d.ts","../../../node_modules/typescript/lib/lib.es2017.arraybuffer.d.ts","../../../node_modules/typescript/lib/lib.es2017.date.d.ts","../../../node_modules/typescript/lib/lib.es2017.object.d.ts","../../../node_modules/typescript/lib/lib.es2017.sharedmemory.d.ts","../../../node_modules/typescript/lib/lib.es2017.string.d.ts","../../../node_modules/typescript/lib/lib.es2017.intl.d.ts","../../../node_modules/typescript/lib/lib.es2017.typedarrays.d.ts","../../../node_modules/typescript/lib/lib.es2018.asyncgenerator.d.ts","../../../node_modules/typescript/lib/lib.es2018.asynciterable.d.ts","../../../node_modules/typescript/lib/lib.es2018.intl.d.ts","../../../node_modules/typescript/lib/lib.es2018.promise.d.ts","../../../node_modules/typescript/lib/lib.es2018.regexp.d.ts","../../../node_modules/typescript/lib/lib.es2019.array.d.ts","../../../node_modules/typescript/lib/lib.es2019.object.d.ts","../../../node_modules/typescript/lib/lib.es2019.string.d.ts","../../../node_modules/typescript/lib/lib.es2019.symbol.d.ts","../../../node_modules/typescript/lib/lib.es2019.intl.d.ts","../../../node_modules/typescript/lib/lib.es2020.bigint.d.ts","../../../node_modules/typescript/lib/lib.es2020.date.d.ts","../../../node_modules/typescript/lib/lib.es2020.promise.d.ts","../../../node_modules/typescript/lib/lib.es2020.sharedmemory.d.ts","../../../node_modules/typescript/lib/lib.es2020.string.d.ts","../../../node_modules/typescript/lib/lib.es2020.symbol.wellknown.d.ts","../../../node_modules/typescript/lib/lib.es2020.intl.d.ts","../../../node_modules/typescript/lib/lib.es2020.number.d.ts","../../../node_modules/typescript/lib/lib.es2021.promise.d.ts","../../../node_modules/typescript/lib/lib.es2021.string.d.ts","../../../node_modules/typescript/lib/lib.es2021.weakref.d.ts","../../../node_modules/typescript/lib/lib.es2021.intl.d.ts","../../../node_modules/typescript/lib/lib.es2022.array.d.ts","../../../node_modules/typescript/lib/lib.es2022.error.d.ts","../../../node_modules/typescript/lib/lib.es2022.intl.d.ts","../../../node_modules/typescript/lib/lib.es2022.object.d.ts","../../../node_modules/typescript/lib/lib.es2022.string.d.ts","../../../node_modules/typescript/lib/lib.es2022.regexp.d.ts","../../../node_modules/typescript/lib/lib.es2023.array.d.ts","../../../node_modules/typescript/lib/lib.es2023.collection.d.ts","../../../node_modules/typescript/lib/lib.es2023.intl.d.ts","../../../node_modules/typescript/lib/lib.es2024.arraybuffer.d.ts","../../../node_modules/typescript/lib/lib.es2024.collection.d.ts","../../../node_modules/typescript/lib/lib.es2024.object.d.ts","../../../node_modules/typescript/lib/lib.es2024.promise.d.ts","../../../node_modules/typescript/lib/lib.es2024.regexp.d.ts","../../../node_modules/typescript/lib/lib.es2024.sharedmemory.d.ts","../../../node_modules/typescript/lib/lib.es2024.string.d.ts","../../../node_modules/typescript/lib/lib.decorators.d.ts","../../../node_modules/typescript/lib/lib.decorators.legacy.d.ts","../../../node_modules/it-drain/dist/src/index.d.ts","../../../node_modules/it-filter/dist/src/index.d.ts","../../../node_modules/it-sort/dist/src/index.d.ts","../../../node_modules/it-take/dist/src/index.d.ts","../../../node_modules/multiformats/dist/src/bases/interface.d.ts","../../../node_modules/multiformats/dist/src/hashes/interface.d.ts","../../../node_modules/multiformats/dist/src/link/interface.d.ts","../../../node_modules/multiformats/dist/src/cid.d.ts","../../../node_modules/multiformats/dist/src/block/interface.d.ts","../../../node_modules/multiformats/dist/src/codecs/interface.d.ts","../../../node_modules/multiformats/dist/src/codecs/json.d.ts","../../../node_modules/multiformats/dist/src/codecs/raw.d.ts","../../../node_modules/multiformats/dist/src/bytes.d.ts","../../../node_modules/multiformats/dist/src/hashes/digest.d.ts","../../../node_modules/multiformats/dist/src/hashes/hasher.d.ts","../../../node_modules/multiformats/dist/src/varint.d.ts","../../../node_modules/multiformats/dist/src/interface.d.ts","../../../node_modules/multiformats/dist/src/index.d.ts","../../../node_modules/multiformats/dist/src/bases/base.d.ts","../../../node_modules/multiformats/dist/src/basics.d.ts","../../../node_modules/uint8arrays/dist/src/util/bases.d.ts","../../../node_modules/uint8arrays/dist/src/to-string.d.ts","../../interface-datastore/dist/src/key.d.ts","../../interface-store/dist/src/errors.d.ts","../../interface-store/dist/src/index.d.ts","../../interface-datastore/dist/src/index.d.ts","../src/base.ts","../src/black-hole.ts","../src/shard.ts","../src/memory.ts","../../../node_modules/it-map/dist/src/index.d.ts","../../../node_modules/it-stream-types/dist/src/index.d.ts","../../../node_modules/it-pipe/dist/src/index.d.ts","../src/keytransform.ts","../src/sharding.ts","../../../node_modules/it-merge/dist/src/index.d.ts","../src/mount.ts","../../../node_modules/uint8arraylist/dist/src/index.d.ts","../../../node_modules/@libp2p/interface/dist/src/keys.d.ts","../../../node_modules/@libp2p/interface/dist/src/peer-id.d.ts","../../../node_modules/@multiformats/multiaddr/dist/src/protocols-table.d.ts","../../../node_modules/@multiformats/dns/dist/src/resolvers/dns-over-https.d.ts","../../../node_modules/@multiformats/dns/dist/src/resolvers/dns-json-over-https.d.ts","../../../node_modules/@multiformats/dns/dist/src/resolvers/index.d.ts","../../../node_modules/progress-events/dist/src/index.d.ts","../../../node_modules/@multiformats/dns/dist/src/index.d.ts","../../../node_modules/@multiformats/multiaddr/dist/src/resolvers/dnsaddr.d.ts","../../../node_modules/@multiformats/multiaddr/dist/src/resolvers/index.d.ts","../../../node_modules/@multiformats/multiaddr/dist/src/filter/multiaddr-filter.d.ts","../../../node_modules/@multiformats/multiaddr/dist/src/index.d.ts","../../../node_modules/@libp2p/interface/dist/src/connection.d.ts","../../../node_modules/@libp2p/interface/dist/src/peer-info.d.ts","../../../node_modules/@libp2p/interface/dist/src/content-routing.d.ts","../../../node_modules/@libp2p/interface/dist/src/event-target.d.ts","../../../node_modules/@libp2p/interface/dist/src/metrics.d.ts","../../../node_modules/@libp2p/interface/dist/src/peer-routing.d.ts","../../../node_modules/@libp2p/interface/dist/src/peer-store.d.ts","../../../node_modules/@libp2p/interface/dist/src/startable.d.ts","../../../node_modules/@libp2p/interface/dist/src/stream-handler.d.ts","../../../node_modules/@libp2p/interface/dist/src/topology.d.ts","../../../node_modules/@libp2p/interface/dist/src/stream-muxer.d.ts","../../../node_modules/@libp2p/interface/dist/src/transport.d.ts","../../../node_modules/@libp2p/interface/dist/src/connection-encrypter.d.ts","../../../node_modules/@libp2p/interface/dist/src/connection-gater.d.ts","../../../node_modules/@libp2p/interface/dist/src/peer-discovery.d.ts","../../../node_modules/it-pushable/dist/src/index.d.ts","../../../node_modules/@libp2p/interface/dist/src/pubsub.d.ts","../../../node_modules/@libp2p/interface/dist/src/record.d.ts","../../../node_modules/@libp2p/interface/dist/src/errors.d.ts","../../../node_modules/@libp2p/interface/dist/src/events.d.ts","../../../node_modules/@libp2p/interface/dist/src/index.d.ts","../../../node_modules/@libp2p/logger/dist/src/index.d.ts","../src/tiered.ts","../src/namespace.ts","../src/index.ts","../src/utils.ts","../../../node_modules/@types/chai/index.d.ts","../../../node_modules/@types/chai-as-promised/index.d.ts","../../../node_modules/chai-parentheses/index.d.ts","../../../node_modules/@types/chai-subset/index.d.ts","../../../node_modules/chai-bites/index.d.ts","../../../node_modules/@types/chai-string/index.d.ts","../../../node_modules/aegir/dist/utils/chai.d.ts","../../../node_modules/it-all/dist/src/index.d.ts","../test/keytransform.spec.ts","../../interface-datastore-tests/dist/src/index.d.ts","../test/memory.spec.ts","../../../node_modules/uint8arrays/dist/src/from-string.d.ts","../test/mount.spec.ts","../test/namespace.spec.ts","../test/shard.spec.ts","../test/sharding.spec.ts","../test/tiered.spec.ts","../test/utils.spec.ts","../../../node_modules/@types/ms/index.d.ts","../../../node_modules/@types/debug/index.d.ts","../../../node_modules/@types/node/compatibility/disposable.d.ts","../../../node_modules/@types/node/compatibility/indexable.d.ts","../../../node_modules/@types/node/compatibility/iterators.d.ts","../../../node_modules/@types/node/compatibility/index.d.ts","../../../node_modules/@types/node/globals.typedarray.d.ts","../../../node_modules/@types/node/buffer.buffer.d.ts","../../../node_modules/buffer/index.d.ts","../../../node_modules/undici-types/header.d.ts","../../../node_modules/undici-types/readable.d.ts","../../../node_modules/undici-types/file.d.ts","../../../node_modules/undici-types/fetch.d.ts","../../../node_modules/undici-types/formdata.d.ts","../../../node_modules/undici-types/connector.d.ts","../../../node_modules/undici-types/client.d.ts","../../../node_modules/undici-types/errors.d.ts","../../../node_modules/undici-types/dispatcher.d.ts","../../../node_modules/undici-types/global-dispatcher.d.ts","../../../node_modules/undici-types/global-origin.d.ts","../../../node_modules/undici-types/pool-stats.d.ts","../../../node_modules/undici-types/pool.d.ts","../../../node_modules/undici-types/handlers.d.ts","../../../node_modules/undici-types/balanced-pool.d.ts","../../../node_modules/undici-types/agent.d.ts","../../../node_modules/undici-types/mock-interceptor.d.ts","../../../node_modules/undici-types/mock-agent.d.ts","../../../node_modules/undici-types/mock-client.d.ts","../../../node_modules/undici-types/mock-pool.d.ts","../../../node_modules/undici-types/mock-errors.d.ts","../../../node_modules/undici-types/proxy-agent.d.ts","../../../node_modules/undici-types/env-http-proxy-agent.d.ts","../../../node_modules/undici-types/retry-handler.d.ts","../../../node_modules/undici-types/retry-agent.d.ts","../../../node_modules/undici-types/api.d.ts","../../../node_modules/undici-types/interceptors.d.ts","../../../node_modules/undici-types/util.d.ts","../../../node_modules/undici-types/cookies.d.ts","../../../node_modules/undici-types/patch.d.ts","../../../node_modules/undici-types/websocket.d.ts","../../../node_modules/undici-types/eventsource.d.ts","../../../node_modules/undici-types/filereader.d.ts","../../../node_modules/undici-types/diagnostics-channel.d.ts","../../../node_modules/undici-types/content-type.d.ts","../../../node_modules/undici-types/cache.d.ts","../../../node_modules/undici-types/index.d.ts","../../../node_modules/@types/node/globals.d.ts","../../../node_modules/@types/node/assert.d.ts","../../../node_modules/@types/node/assert/strict.d.ts","../../../node_modules/@types/node/async_hooks.d.ts","../../../node_modules/@types/node/buffer.d.ts","../../../node_modules/@types/node/child_process.d.ts","../../../node_modules/@types/node/cluster.d.ts","../../../node_modules/@types/node/console.d.ts","../../../node_modules/@types/node/constants.d.ts","../../../node_modules/@types/node/crypto.d.ts","../../../node_modules/@types/node/dgram.d.ts","../../../node_modules/@types/node/diagnostics_channel.d.ts","../../../node_modules/@types/node/dns.d.ts","../../../node_modules/@types/node/dns/promises.d.ts","../../../node_modules/@types/node/domain.d.ts","../../../node_modules/@types/node/dom-events.d.ts","../../../node_modules/@types/node/events.d.ts","../../../node_modules/@types/node/fs.d.ts","../../../node_modules/@types/node/fs/promises.d.ts","../../../node_modules/@types/node/http.d.ts","../../../node_modules/@types/node/http2.d.ts","../../../node_modules/@types/node/https.d.ts","../../../node_modules/@types/node/inspector.d.ts","../../../node_modules/@types/node/module.d.ts","../../../node_modules/@types/node/net.d.ts","../../../node_modules/@types/node/os.d.ts","../../../node_modules/@types/node/path.d.ts","../../../node_modules/@types/node/perf_hooks.d.ts","../../../node_modules/@types/node/process.d.ts","../../../node_modules/@types/node/punycode.d.ts","../../../node_modules/@types/node/querystring.d.ts","../../../node_modules/@types/node/readline.d.ts","../../../node_modules/@types/node/readline/promises.d.ts","../../../node_modules/@types/node/repl.d.ts","../../../node_modules/@types/node/sea.d.ts","../../../node_modules/@types/node/sqlite.d.ts","../../../node_modules/@types/node/stream.d.ts","../../../node_modules/@types/node/stream/promises.d.ts","../../../node_modules/@types/node/stream/consumers.d.ts","../../../node_modules/@types/node/stream/web.d.ts","../../../node_modules/@types/node/string_decoder.d.ts","../../../node_modules/@types/node/test.d.ts","../../../node_modules/@types/node/timers.d.ts","../../../node_modules/@types/node/timers/promises.d.ts","../../../node_modules/@types/node/tls.d.ts","../../../node_modules/@types/node/trace_events.d.ts","../../../node_modules/@types/node/tty.d.ts","../../../node_modules/@types/node/url.d.ts","../../../node_modules/@types/node/util.d.ts","../../../node_modules/@types/node/v8.d.ts","../../../node_modules/@types/node/vm.d.ts","../../../node_modules/@types/node/wasi.d.ts","../../../node_modules/@types/node/worker_threads.d.ts","../../../node_modules/@types/node/zlib.d.ts","../../../node_modules/@types/node/index.d.ts","../../../node_modules/@types/dns-packet/index.d.ts","../../../node_modules/@types/estree/index.d.ts","../../../node_modules/@types/unist/index.d.ts","../../../node_modules/@types/hast/index.d.ts","../../../node_modules/@types/http-cache-semantics/index.d.ts","../../../node_modules/@types/istanbul-lib-coverage/index.d.ts","../../../node_modules/@types/json-schema/index.d.ts","../../../node_modules/@types/json5/index.d.ts","../../../node_modules/@types/mdast/index.d.ts","../../../node_modules/@types/minimatch/index.d.ts","../../../node_modules/@types/minimist/index.d.ts","../../../node_modules/@types/mocha/index.d.ts","../../../node_modules/@types/normalize-package-data/index.d.ts","../../../node_modules/@types/parse-json/index.d.ts","../../../node_modules/@types/retry/index.d.ts","../../../node_modules/@types/sinonjs__fake-timers/index.d.ts","../../../node_modules/@types/sinon/index.d.ts","../../../node_modules/@types/strip-bom/index.d.ts","../../../node_modules/@types/strip-json-comments/index.d.ts","../../../node_modules/@types/yauzl/index.d.ts"],"fileIdsList":[[104,110,112,123,143,174,217],[112,122,123,174,217],[104,110,112,122,143,174,217],[80,124,143,174,217],[174,217],[174,217,229],[111,112,117,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,139,140,141,142,174,217],[78,80,110,174,217],[123,174,217],[124,126,174,217],[78,80,111,174,217],[112,122,174,217],[112,124,143,174,217],[111,112,122,124,174,217],[110,111,112,123,126,138,174,217],[110,111,174,217],[104,110,123,143,174,217],[112,123,174,217],[117,122,123,126,133,143,174,217],[143,174,217],[116,117,174,217],[116,174,217],[114,115,118,174,217],[122,174,217],[113,118,120,121,174,217],[118,120,122,174,217],[119,122,174,217],[149,174,217],[167,174,217],[174,217,267],[174,217,270],[174,214,217],[174,216,217],[217],[174,217,222,252],[174,217,218,223,229,230,237,249,260],[174,217,218,219,229,237],[169,170,171,174,217],[174,217,220,261],[174,217,221,222,230,238],[174,217,222,249,257],[174,217,223,225,229,237],[174,216,217,224],[174,217,225,226],[174,217,227,229],[174,216,217,229],[174,217,229,230,231,249,260],[174,217,229,230,231,244,249,252],[174,212,217,265],[174,212,217,225,229,232,237,249,260],[174,217,229,230,232,233,237,249,257,260],[174,217,232,234,249,257,260],[172,173,174,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266],[174,217,229,235],[174,217,236,260],[174,217,225,229,237,249],[174,217,238],[174,217,239],[174,216,217,240],[174,214,215,216,217,218,219,220,221,222,223,224,225,226,227,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266],[174,217,242],[174,217,243],[174,217,229,244,245],[174,217,244,246,261,263],[174,217,229,249,250,252],[174,217,251,252],[174,217,249,250],[174,217,252],[174,217,253],[174,214,217,249],[174,217,229,255,256],[174,217,255,256],[174,217,222,237,249,257],[174,217,258],[174,217,237,259],[174,217,232,243,260],[174,217,222,261],[174,217,249,262],[174,217,236,263],[174,217,264],[174,217,222,229,231,240,249,260,263,265],[174,217,249,266],[174,217,283],[174,217,229,249,267],[149,150,151,152,153,154,174,217],[149,150,174,217],[104,174,217],[77,174,217],[83,84,90,91,174,217],[79,80,174,217],[79,174,217],[81,174,217],[82,174,217],[78,174,217],[78,86,174,217],[80,85,86,87,88,89,174,217],[77,78,79,81,82,174,217],[77,78,81,174,217],[93,174,217],[90,92,174,217],[174,184,188,217,260],[174,184,217,249,260],[174,179,217],[174,181,184,217,257,260],[174,217,237,257],[174,179,217,267],[174,181,184,217,237,260],[174,176,177,180,183,217,229,249,260],[174,184,191,217],[174,176,182,217],[174,184,205,206,217],[174,180,184,217,252,260,267],[174,205,217,267],[174,178,179,217,267],[174,184,217],[174,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,206,207,208,209,210,211,217],[174,184,199,217],[174,184,191,192,217],[174,182,184,192,193,217],[174,183,217],[174,176,179,184,217],[174,184,188,192,193,217],[174,188,217],[174,182,184,187,217,260],[174,176,181,184,191,217],[174,217,249],[174,179,184,205,217,265,267],[73,74,75,76,97,98,174,217],[95,97,98,99,174,217],[98,99,101,102,106,107,109,145,146,174,217],[97,98,99,103,105,147,174,217],[74,75,76,97,98,99,108,174,217],[97,98,103,106,174,217],[95,98,147,174,217],[97,98,99,101,106,147,174,217],[97,98,99,144,174,217],[95,102,106,155,156,174,217],[102,158,174,217],[95,98,102,106,109,155,156,158,160,174,217],[95,102,146,155,156,158,160,174,217],[101,155,174,217],[94,95,101,102,107,155,158,160,174,217],[95,98,102,145,155,158,160,174,217],[148,155,174,217],[98,174,217],[95,97,174,217],[94,174,217],[96,174,217]],"fileInfos":[{"version":"69684132aeb9b5642cbcd9e22dff7818ff0ee1aa831728af0ecf97d3364d5546","affectsGlobalScope":true,"impliedFormat":1},{"version":"45b7ab580deca34ae9729e97c13cfd999df04416a79116c3bfb483804f85ded4","impliedFormat":1},{"version":"3facaf05f0c5fc569c5649dd359892c98a85557e3e0c847964caeb67076f4d75","impliedFormat":1},{"version":"e44bb8bbac7f10ecc786703fe0a6a4b952189f908707980ba8f3c8975a760962","impliedFormat":1},{"version":"5e1c4c362065a6b95ff952c0eab010f04dcd2c3494e813b493ecfd4fcb9fc0d8","impliedFormat":1},{"version":"68d73b4a11549f9c0b7d352d10e91e5dca8faa3322bfb77b661839c42b1ddec7","impliedFormat":1},{"version":"5efce4fc3c29ea84e8928f97adec086e3dc876365e0982cc8479a07954a3efd4","impliedFormat":1},{"version":"feecb1be483ed332fad555aff858affd90a48ab19ba7272ee084704eb7167569","impliedFormat":1},{"version":"ee7bad0c15b58988daa84371e0b89d313b762ab83cb5b31b8a2d1162e8eb41c2","impliedFormat":1},{"version":"27bdc30a0e32783366a5abeda841bc22757c1797de8681bbe81fbc735eeb1c10","impliedFormat":1},{"version":"8fd575e12870e9944c7e1d62e1f5a73fcf23dd8d3a321f2a2c74c20d022283fe","impliedFormat":1},{"version":"092c2bfe125ce69dbb1223c85d68d4d2397d7d8411867b5cc03cec902c233763","affectsGlobalScope":true,"impliedFormat":1},{"version":"07f073f19d67f74d732b1adea08e1dc66b1b58d77cb5b43931dee3d798a2fd53","affectsGlobalScope":true,"impliedFormat":1},{"version":"8ea22b76493fc658fe9b76a84e64c9618823608076ecee5ed3f93f7f0dde904e","affectsGlobalScope":true,"impliedFormat":1},{"version":"c57796738e7f83dbc4b8e65132f11a377649c00dd3eee333f672b8f0a6bea671","affectsGlobalScope":true,"impliedFormat":1},{"version":"dc2df20b1bcdc8c2d34af4926e2c3ab15ffe1160a63e58b7e09833f616efff44","affectsGlobalScope":true,"impliedFormat":1},{"version":"515d0b7b9bea2e31ea4ec968e9edd2c39d3eebf4a2d5cbd04e88639819ae3b71","affectsGlobalScope":true,"impliedFormat":1},{"version":"0559b1f683ac7505ae451f9a96ce4c3c92bdc71411651ca6ddb0e88baaaad6a3","affectsGlobalScope":true,"impliedFormat":1},{"version":"0dc1e7ceda9b8b9b455c3a2d67b0412feab00bd2f66656cd8850e8831b08b537","affectsGlobalScope":true,"impliedFormat":1},{"version":"ce691fb9e5c64efb9547083e4a34091bcbe5bdb41027e310ebba8f7d96a98671","affectsGlobalScope":true,"impliedFormat":1},{"version":"8d697a2a929a5fcb38b7a65594020fcef05ec1630804a33748829c5ff53640d0","affectsGlobalScope":true,"impliedFormat":1},{"version":"4ff2a353abf8a80ee399af572debb8faab2d33ad38c4b4474cff7f26e7653b8d","affectsGlobalScope":true,"impliedFormat":1},{"version":"936e80ad36a2ee83fc3caf008e7c4c5afe45b3cf3d5c24408f039c1d47bdc1df","affectsGlobalScope":true,"impliedFormat":1},{"version":"d15bea3d62cbbdb9797079416b8ac375ae99162a7fba5de2c6c505446486ac0a","affectsGlobalScope":true,"impliedFormat":1},{"version":"68d18b664c9d32a7336a70235958b8997ebc1c3b8505f4f1ae2b7e7753b87618","affectsGlobalScope":true,"impliedFormat":1},{"version":"eb3d66c8327153d8fa7dd03f9c58d351107fe824c79e9b56b462935176cdf12a","affectsGlobalScope":true,"impliedFormat":1},{"version":"38f0219c9e23c915ef9790ab1d680440d95419ad264816fa15009a8851e79119","affectsGlobalScope":true,"impliedFormat":1},{"version":"69ab18c3b76cd9b1be3d188eaf8bba06112ebbe2f47f6c322b5105a6fbc45a2e","affectsGlobalScope":true,"impliedFormat":1},{"version":"fef8cfad2e2dc5f5b3d97a6f4f2e92848eb1b88e897bb7318cef0e2820bceaab","affectsGlobalScope":true,"impliedFormat":1},{"version":"2f11ff796926e0832f9ae148008138ad583bd181899ab7dd768a2666700b1893","affectsGlobalScope":true,"impliedFormat":1},{"version":"4de680d5bb41c17f7f68e0419412ca23c98d5749dcaaea1896172f06435891fc","affectsGlobalScope":true,"impliedFormat":1},{"version":"954296b30da6d508a104a3a0b5d96b76495c709785c1d11610908e63481ee667","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac9538681b19688c8eae65811b329d3744af679e0bdfa5d842d0e32524c73e1c","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a969edff4bd52585473d24995c5ef223f6652d6ef46193309b3921d65dd4376","affectsGlobalScope":true,"impliedFormat":1},{"version":"9e9fbd7030c440b33d021da145d3232984c8bb7916f277e8ffd3dc2e3eae2bdb","affectsGlobalScope":true,"impliedFormat":1},{"version":"811ec78f7fefcabbda4bfa93b3eb67d9ae166ef95f9bff989d964061cbf81a0c","affectsGlobalScope":true,"impliedFormat":1},{"version":"717937616a17072082152a2ef351cb51f98802fb4b2fdabd32399843875974ca","affectsGlobalScope":true,"impliedFormat":1},{"version":"d7e7d9b7b50e5f22c915b525acc5a49a7a6584cf8f62d0569e557c5cfc4b2ac2","affectsGlobalScope":true,"impliedFormat":1},{"version":"71c37f4c9543f31dfced6c7840e068c5a5aacb7b89111a4364b1d5276b852557","affectsGlobalScope":true,"impliedFormat":1},{"version":"576711e016cf4f1804676043e6a0a5414252560eb57de9faceee34d79798c850","affectsGlobalScope":true,"impliedFormat":1},{"version":"89c1b1281ba7b8a96efc676b11b264de7a8374c5ea1e6617f11880a13fc56dc6","affectsGlobalScope":true,"impliedFormat":1},{"version":"74f7fa2d027d5b33eb0471c8e82a6c87216223181ec31247c357a3e8e2fddc5b","affectsGlobalScope":true,"impliedFormat":1},{"version":"d6d7ae4d1f1f3772e2a3cde568ed08991a8ae34a080ff1151af28b7f798e22ca","affectsGlobalScope":true,"impliedFormat":1},{"version":"063600664504610fe3e99b717a1223f8b1900087fab0b4cad1496a114744f8df","affectsGlobalScope":true,"impliedFormat":1},{"version":"934019d7e3c81950f9a8426d093458b65d5aff2c7c1511233c0fd5b941e608ab","affectsGlobalScope":true,"impliedFormat":1},{"version":"52ada8e0b6e0482b728070b7639ee42e83a9b1c22d205992756fe020fd9f4a47","affectsGlobalScope":true,"impliedFormat":1},{"version":"3bdefe1bfd4d6dee0e26f928f93ccc128f1b64d5d501ff4a8cf3c6371200e5e6","affectsGlobalScope":true,"impliedFormat":1},{"version":"59fb2c069260b4ba00b5643b907ef5d5341b167e7d1dbf58dfd895658bda2867","affectsGlobalScope":true,"impliedFormat":1},{"version":"639e512c0dfc3fad96a84caad71b8834d66329a1f28dc95e3946c9b58176c73a","affectsGlobalScope":true,"impliedFormat":1},{"version":"368af93f74c9c932edd84c58883e736c9e3d53cec1fe24c0b0ff451f529ceab1","affectsGlobalScope":true,"impliedFormat":1},{"version":"af3dd424cf267428f30ccfc376f47a2c0114546b55c44d8c0f1d57d841e28d74","affectsGlobalScope":true,"impliedFormat":1},{"version":"995c005ab91a498455ea8dfb63aa9f83fa2ea793c3d8aa344be4a1678d06d399","affectsGlobalScope":true,"impliedFormat":1},{"version":"959d36cddf5e7d572a65045b876f2956c973a586da58e5d26cde519184fd9b8a","affectsGlobalScope":true,"impliedFormat":1},{"version":"965f36eae237dd74e6cca203a43e9ca801ce38824ead814728a2807b1910117d","affectsGlobalScope":true,"impliedFormat":1},{"version":"3925a6c820dcb1a06506c90b1577db1fdbf7705d65b62b99dce4be75c637e26b","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a3d63ef2b853447ec4f749d3f368ce642264246e02911fcb1590d8c161b8005","affectsGlobalScope":true,"impliedFormat":1},{"version":"b5ce7a470bc3628408429040c4e3a53a27755022a32fd05e2cb694e7015386c7","affectsGlobalScope":true,"impliedFormat":1},{"version":"8444af78980e3b20b49324f4a16ba35024fef3ee069a0eb67616ea6ca821c47a","affectsGlobalScope":true,"impliedFormat":1},{"version":"3287d9d085fbd618c3971944b65b4be57859f5415f495b33a6adc994edd2f004","affectsGlobalScope":true,"impliedFormat":1},{"version":"b4b67b1a91182421f5df999988c690f14d813b9850b40acd06ed44691f6727ad","affectsGlobalScope":true,"impliedFormat":1},{"version":"df83c2a6c73228b625b0beb6669c7ee2a09c914637e2d35170723ad49c0f5cd4","affectsGlobalScope":true,"impliedFormat":1},{"version":"436aaf437562f276ec2ddbee2f2cdedac7664c1e4c1d2c36839ddd582eeb3d0a","affectsGlobalScope":true,"impliedFormat":1},{"version":"8e3c06ea092138bf9fa5e874a1fdbc9d54805d074bee1de31b99a11e2fec239d","affectsGlobalScope":true,"impliedFormat":1},{"version":"87dc0f382502f5bbce5129bdc0aea21e19a3abbc19259e0b43ae038a9fc4e326","affectsGlobalScope":true,"impliedFormat":1},{"version":"b1cb28af0c891c8c96b2d6b7be76bd394fddcfdb4709a20ba05a7c1605eea0f9","affectsGlobalScope":true,"impliedFormat":1},{"version":"2fef54945a13095fdb9b84f705f2b5994597640c46afeb2ce78352fab4cb3279","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac77cb3e8c6d3565793eb90a8373ee8033146315a3dbead3bde8db5eaf5e5ec6","affectsGlobalScope":true,"impliedFormat":1},{"version":"56e4ed5aab5f5920980066a9409bfaf53e6d21d3f8d020c17e4de584d29600ad","affectsGlobalScope":true,"impliedFormat":1},{"version":"4ece9f17b3866cc077099c73f4983bddbcb1dc7ddb943227f1ec070f529dedd1","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a6282c8827e4b9a95f4bf4f5c205673ada31b982f50572d27103df8ceb8013c","affectsGlobalScope":true,"impliedFormat":1},{"version":"8e7f8264d0fb4c5339605a15daadb037bf238c10b654bb3eee14208f860a32ea","affectsGlobalScope":true,"impliedFormat":1},{"version":"782dec38049b92d4e85c1585fbea5474a219c6984a35b004963b00beb1aab538","affectsGlobalScope":true,"impliedFormat":1},{"version":"687ec53a7422d8cf80477fffa82a2db211f724039267931642befcd4907aec26","impliedFormat":99},{"version":"3ce6e8574f6052b14dabacbf4fbf202def94373909428cd482aa42a674733325","impliedFormat":99},{"version":"c8565a448c850391b315dc0901302f701b345939a08cb702e160ae6f3518f9b8","impliedFormat":99},{"version":"72322a0b1586d3de59d3c5edc9eacf34480d1bb20d6de633fb63044de9682401","impliedFormat":99},{"version":"4a3605bef1a5ef29fd5a1696dd95b0b4e2259e2d07a4d88fac79f3a9765c44a2","impliedFormat":99},{"version":"90240231e730deed31569f6c686766a538e4a024bbc33ea1738fe924f477ba61","impliedFormat":99},{"version":"552223520e823223ee13c5764e9b69b1819c985818a8bcda435d8d1dbd909bee","impliedFormat":99},{"version":"49b7c3ddd683c09aa437dd92681699387441f522524b14d2331ce494a9bf2f27","impliedFormat":99},{"version":"370079895f1acdd4bb5194a403c85bf60cfbb2654bced9430a6c7210e7246be8","impliedFormat":99},{"version":"1447d46bff9e7c5c77da14515a7456ea5e919ce6e28f5e6746edf99818e4be47","impliedFormat":99},{"version":"ba3f6f0ee47f46cdce55620aec5726de80e92a930982634afe9918c114c38f0b","impliedFormat":99},{"version":"6f38045547cdfd54ec19abcd943cace72c775fde739c5e0e1d917cf3030c16b5","impliedFormat":99},{"version":"0feb3e59277511c22c957053c1a9e4697b5c15d55e7cfc05200180ba7e6ed958","impliedFormat":99},{"version":"3d0e04c8ca3f41da5f3d689500d9c4aeb54a1c59764d66d58f0e579b9af720e5","impliedFormat":99},{"version":"a6eb23f2a83113ce0ab7203bfda2be0888720f8d694a20abaef83b9f62832061","impliedFormat":99},{"version":"363dca5004ac5a3d9c2bba12812b97a64461911762f0b8f9320a8856ec53bcad","impliedFormat":99},{"version":"557b8c7481296f4b7ed362320f3bbb40bb87404edf880c81224f365a8d1e17f3","impliedFormat":99},{"version":"283ed3d075bf7d3e8793f63b2a52f475ed84d95b7b6351c5d5bcc6c49d4b845b","impliedFormat":99},{"version":"6544dab49004fecb69a4ef775e9ad2773a6148b1f9bfd9b75508e3afa11f5d35","impliedFormat":99},{"version":"e15a0423c85811ac63f42ce2b0d17303b93a3d6884f2e63ea74ae148d9f49a55","impliedFormat":99},{"version":"e2dd36a524ea5b13de1ed104ede9cea79696588175c1df1940d6a29113a4aee0","impliedFormat":99},{"version":"a878d4c7237a7af50e96534295fcf723134d70cbb1e9bfd8365266b912aee6ec","impliedFormat":99},{"version":"c69e364ff605f619935b702e4502f3e7b6565efd7c058588573e90e3b23de009","impliedFormat":99},{"version":"406ad29837d74e2ec97cdd8bba6295b6c984c1793d287c77fd1bb9ac9ff105cc","impliedFormat":99},{"version":"749effab6d7e72df8d126868c82b8166cdde84d48453e44f65cbad42ad900b06","impliedFormat":99},{"version":"11705a4aad6e2e724b82ffee6c4fa271d798f0fb68806ace4b1c425c266f8d98","impliedFormat":99},{"version":"e49270fb620a4eb01c24b35a5f8757a093cc8ca25122fcc559e87b4298820b16","signature":"8b1b666fe96fd9e713f1279a3e446f16ee824f46ca0c2c075e4e89f0b1258e6c","impliedFormat":99},{"version":"d840b9f92ec578d6a6c5ca39a0813a1b6c1d1bdfcaf6b93f9449e76979b6454b","signature":"462b8a0b19385ce4b594c73112bf2aac229c21ce0498c00d5489ae037f26fe4e","impliedFormat":99},{"version":"1c43a191370f4f0552bdaed92c072679e52494c8936a2221f3ba97c200b78dd0","signature":"7c59943d77166c1aecd731af8683a7b5a0984e1bc0427fa35be504d77c41fdcd","impliedFormat":99},{"version":"0018798c0cc60cc11f1784610103cf1e1485b763e1bf4cf0b7e43ddc73b4911c","signature":"29a18bb3027d687157bd5100806720e425fc34c90fa3947498d164f6af751616","impliedFormat":99},{"version":"bcc66913f07d898149b4bb118d1b04c4925f0d61dceeecc65ef5bb58b5004d4c","impliedFormat":99},{"version":"c84146dbc9d2e5f43d2cbf15485a4eabf90219dbb66c0d481f20f12d3851bffc","impliedFormat":99},{"version":"56558ae167446acf230ea2cc072a835309a37ae63d286b484308afd8c504c2d6","impliedFormat":99},{"version":"661fc671ac79ee0ef1e91280a3395f55198fb83e1487b9241cfc24b120b8cd3c","signature":"d357e56d630bcd0f63cfc678e306702555b4f791c2d8e07f037de39171be4cd3","impliedFormat":99},{"version":"1b133dcb9a52cf63b369b013c5e79a52634af11186fa7331251198a2237a88d3","signature":"c7ab5bd8603f3d24c94a95b780fb3bac66e45212fb304495f205b53dc2a9808b","impliedFormat":99},{"version":"ebc51770c27d90812d97af081e035c941e7ce706a909c838e759b6d605967f83","impliedFormat":99},{"version":"20c4c7117e4f3ed19b279425ddef8b095f685c8226810cedc5fb399b35896229","signature":"a93ae01c9ed49ba423599144ffa3cd520db83e53b32471865905a65113bb3e59","impliedFormat":99},{"version":"d35b5db21a04a45ae6323c4d4b25acc983dfe2870fc670fd05249eb19d839a5e","impliedFormat":99},{"version":"1f7a97ce945bbb1ae665673ff64ed134d207af6e1a0c196b60abb37bc6c6d10a","impliedFormat":99},{"version":"72b129e625a479942a4f9e8a1bc12c45c09bbbf6ebae147418584441eb9fba18","impliedFormat":99},{"version":"5212dd78d1d63ab33332c8846a0ea5ce248159e74033cde16de48373036b4704","impliedFormat":99},{"version":"954b3c04ee9f94ca1e262f3e5a6e833b0da0066514b3d4b97b92b7f0c85f8700","impliedFormat":99},{"version":"a2fc9ce1ae5bed7068d701d8aeebf13321de0f42c217dc2e10f1622dcaa53a7f","impliedFormat":99},{"version":"8e81f220cb935d551e88cff11541d5e89d3a3494a52fe6247e98016a9dbd4c2d","impliedFormat":99},{"version":"6b2576a04253626ba41b7dc7ec5977bec07f3b6952b16249d9fa8a3a0d79901c","impliedFormat":99},{"version":"9de17491f2bfbccea92500e174079d53bdedae34dbebe5d4a12a06ab09814710","impliedFormat":99},{"version":"e88481085a8576fa52efc913e631c1a833d16179486469b8538d8c4fab2f7381","impliedFormat":99},{"version":"cc8c0bbe9fa2399c83e9f5492f82c55fe184380a371dd6fa462586c6563b054b","impliedFormat":99},{"version":"d71577e78c7a4257074aaf82f595724175210c89e8b467ef82f949a6cbd891bc","impliedFormat":99},{"version":"52e78315d331eeec07e0fabb68af969e7cdb28eafeeda17fca75897764a53f0b","impliedFormat":99},{"version":"99e58b8cfcc96db650fc7ee19e343d0a51bd3359dc149f7394448c17f191a545","impliedFormat":99},{"version":"c7bdf13966d47b3b3cf9de4ce1647184717579990cc7143602f02ab224e9bfc6","impliedFormat":99},{"version":"2df70ce5ac08695f7c18c4f06771ce367c12167f5868028c81912217ac87902f","impliedFormat":99},{"version":"31df5ef75bd58d593d86b8a6b8453f91edcfb0028619d12013df5072491f2584","impliedFormat":99},{"version":"f3a9711898711a33db517fd5d0749c5c73e9d23004473cd698e7e14f9a26c768","impliedFormat":99},{"version":"bca17571cb28cda192676b35856905550ec82495f6f782dfb6c34b5611317f36","impliedFormat":99},{"version":"ddbcda59047eb4d81dd1868950e2069e0f8a6a22e7a42b1dccc6591c5a4a2c4f","impliedFormat":99},{"version":"0f02789a4cd141f719fcfa7d9bb2aa01fcc88ea1ff2527884976ff0be6885d2c","impliedFormat":99},{"version":"76b9fa1e321d1a3df90391e97234009ab3a36e55965a53a74038949994b8fb23","impliedFormat":99},{"version":"1bc5eadd83cdb0931e3ee2de0734acc9e003f44ac799b20b9673c540c8cd4373","impliedFormat":99},{"version":"44fa41130045a0256c73b8f94d0885d1a170063b543ddf7324293b21af4b18b6","impliedFormat":99},{"version":"7e6167b95acf6613ec23123174cb521adb4a304e649df53aaea7bf761df999c8","impliedFormat":99},{"version":"cb367da7004cc13870f5108858262bcebbae4d57ede1506769a0f06823509050","impliedFormat":99},{"version":"89346453b46aeb38468711a4880156f29b1eea4eab823bd53802965b3d3fc27d","impliedFormat":99},{"version":"1e271966c873756f8e1d666998c491b5dc12af5d74d533e47c5e5e279e18274e","impliedFormat":99},{"version":"fac83d4c6898d5bf90c508cc84409ded40fdc14611cf42d7fb750fb2c7847979","impliedFormat":99},{"version":"da80121bd71df51319f3105d60a9dac23e1e391ef3a58e223c722af526bcb3f4","impliedFormat":99},{"version":"30a3b1f1188c219ea516f1705f6ed50a9729981e8afffc37cd99c9282bb353c9","impliedFormat":99},{"version":"c0c00b990b4f0c26f00090df7e566344fea8df23421d674c1597ea678625b961","impliedFormat":99},{"version":"6a99ac72e356885b8aab17cc8b50e63583447a1b39cd77db49916d37bd61fca2","impliedFormat":99},{"version":"4e12f75592a04f1f127950507cb392ebf9a3a1178b1eead7c1a285403e837b7b","impliedFormat":99},{"version":"3d53e5e411caeb49b5238ee5675b305745157bff28c26afd81c6a3ee8694fa83","impliedFormat":99},{"version":"df439c16ff04d87c3cd6836e9848d17451d29747a0639f969830a63559ba5fde","signature":"6088973936033e869d3616b63d25c15363862b491f46af77d40a5215ee8cc1a8","impliedFormat":99},{"version":"85c0e4623177a2a9be3d7f033627c0e63d9705d98f8229c0f2e139529d299281","signature":"cfe6d4704a87ca97a5e4920b26c08277c0dc3e54c8cd47f8ab103a31c2a9eebd","impliedFormat":99},{"version":"d609c0b5d032bb68734bef699358bba20dbbe11e422a0e5e2eb1e6f714c79a82","signature":"34547e9d404f6fc9a800b7a230e3891f0ebcc1400649edc524c499f11995cb11","impliedFormat":99},{"version":"d9ea0ba9ce09a46da919f94b4dd3be1dc8871f7caf31b3058959add5b0256ad2","signature":"1f8349a62e9d7507fad3e5f12f66e0de6a9d25c8b01227dbe0bc16ab475eaeb2","impliedFormat":99},{"version":"eef204f061321360559bd19235ea32a9d55b3ec22a362cc78d14ef50d4db4490","affectsGlobalScope":true,"impliedFormat":1},{"version":"86e56d97b13ef0a58bc9c59aee782ae7d47d63802b5b32129ec5e5d62c20dbfa","affectsGlobalScope":true,"impliedFormat":1},{"version":"c1f79c6d85cd84518fd7349588b3c61bdc189f58e3866f925cbf4631c81e31f9","affectsGlobalScope":true,"impliedFormat":1},{"version":"54db406753da16e177f094aa66da79840f447de6d87ddd1543a80c9418c52545","affectsGlobalScope":true,"impliedFormat":1},{"version":"42f28f4cfca4a70bd89c1d55d76c7978275030b894f6793f36890265c11a83a4","affectsGlobalScope":true,"impliedFormat":1},{"version":"7cf1027da9599f056355b46bbea31dbf7f715f797dffb9cbb3402d4490c503e5","affectsGlobalScope":true,"impliedFormat":1},{"version":"96dbd0787b57ae02981d26d5f2441f0f8444fb46d7578c56527eab89cff13a7d","impliedFormat":99},{"version":"5ccc3c7f73ef48c223635cd4506f21133560de7abc4c09c623327bb1b54386dc","impliedFormat":99},{"version":"e501796a41189f1ccf9b58ff8b974f3d281c4bb559b5963772f0ecd2a653cd28","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":99},{"version":"e5d567ef48597d620a84726707241b903fd3d64bb2b38c4eecc7921b203785d1","impliedFormat":99},{"version":"7e6f245b3ede6bd56b9f58cae57e31ce81d5cc9a29334206de9e03c9a5f85ce0","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":99},{"version":"ac63a01fcac70315fc9b416e9a57e568b18032c7cfcaa314e1751f03ef71286f","impliedFormat":99},{"version":"9413e940c9f2fa8345cec064f1436b6fd03fdb1bef9f5df62df9b0ef49a52e7b","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":99},{"version":"31fba0d3dd96f31491a55339e7a2fec515d571fb1ae389031459049a62103f71","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":99},{"version":"8100cd010fe0d7fc63111c10765103a10ab099e0d621258498b2c458a97023ca","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":99},{"version":"0da9fcda552da9ea7936c1cbdec02b14f701f56ecce041b7626ada076f49fd15","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":99},{"version":"5b79b254dc974521d433aa8be4c7483e43dfebc20a84645402c4fd5db3cc9881","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":99},{"version":"ad1e5eb8e852c52cfb0857dbe4dd3fa1ef00fd82444e4ecdd4d1ed26dfb53e15","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":99},{"version":"fb893a0dfc3c9fb0f9ca93d0648694dd95f33cbad2c0f2c629f842981dfd4e2e","impliedFormat":1},{"version":"3eb11dbf3489064a47a2e1cf9d261b1f100ef0b3b50ffca6c44dd99d6dd81ac1","impliedFormat":1},{"version":"70521b6ab0dcba37539e5303104f29b721bfb2940b2776da4cc818c07e1fefc1","affectsGlobalScope":true,"impliedFormat":1},{"version":"030e350db2525514580ed054f712ffb22d273e6bc7eddc1bb7eda1e0ba5d395e","affectsGlobalScope":true,"impliedFormat":1},{"version":"d153a11543fd884b596587ccd97aebbeed950b26933ee000f94009f1ab142848","affectsGlobalScope":true,"impliedFormat":1},{"version":"21d819c173c0cf7cc3ce57c3276e77fd9a8a01d35a06ad87158781515c9a438a","impliedFormat":1},{"version":"a79e62f1e20467e11a904399b8b18b18c0c6eea6b50c1168bf215356d5bebfaf","affectsGlobalScope":true,"impliedFormat":1},{"version":"d802f0e6b5188646d307f070d83512e8eb94651858de8a82d1e47f60fb6da4e2","affectsGlobalScope":true,"impliedFormat":1},{"version":"4967529644e391115ca5592184d4b63980569adf60ee685f968fd59ab1557188","impliedFormat":1},{"version":"5929864ce17fba74232584d90cb721a89b7ad277220627cc97054ba15a98ea8f","impliedFormat":1},{"version":"763fe0f42b3d79b440a9b6e51e9ba3f3f91352469c1e4b3b67bfa4ff6352f3f4","impliedFormat":1},{"version":"25c8056edf4314820382a5fdb4bb7816999acdcb929c8f75e3f39473b87e85bc","impliedFormat":1},{"version":"c464d66b20788266e5353b48dc4aa6bc0dc4a707276df1e7152ab0c9ae21fad8","impliedFormat":1},{"version":"78d0d27c130d35c60b5e5566c9f1e5be77caf39804636bc1a40133919a949f21","impliedFormat":1},{"version":"c6fd2c5a395f2432786c9cb8deb870b9b0e8ff7e22c029954fabdd692bff6195","impliedFormat":1},{"version":"1d6e127068ea8e104a912e42fc0a110e2aa5a66a356a917a163e8cf9a65e4a75","impliedFormat":1},{"version":"5ded6427296cdf3b9542de4471d2aa8d3983671d4cac0f4bf9c637208d1ced43","impliedFormat":1},{"version":"7f182617db458e98fc18dfb272d40aa2fff3a353c44a89b2c0ccb3937709bfb5","impliedFormat":1},{"version":"cadc8aced301244057c4e7e73fbcae534b0f5b12a37b150d80e5a45aa4bebcbd","impliedFormat":1},{"version":"385aab901643aa54e1c36f5ef3107913b10d1b5bb8cbcd933d4263b80a0d7f20","impliedFormat":1},{"version":"9670d44354bab9d9982eca21945686b5c24a3f893db73c0dae0fd74217a4c219","impliedFormat":1},{"version":"0b8a9268adaf4da35e7fa830c8981cfa22adbbe5b3f6f5ab91f6658899e657a7","impliedFormat":1},{"version":"11396ed8a44c02ab9798b7dca436009f866e8dae3c9c25e8c1fbc396880bf1bb","impliedFormat":1},{"version":"ba7bc87d01492633cb5a0e5da8a4a42a1c86270e7b3d2dea5d156828a84e4882","impliedFormat":1},{"version":"4893a895ea92c85345017a04ed427cbd6a1710453338df26881a6019432febdd","impliedFormat":1},{"version":"c21dc52e277bcfc75fac0436ccb75c204f9e1b3fa5e12729670910639f27343e","impliedFormat":1},{"version":"13f6f39e12b1518c6650bbb220c8985999020fe0f21d818e28f512b7771d00f9","impliedFormat":1},{"version":"9b5369969f6e7175740bf51223112ff209f94ba43ecd3bb09eefff9fd675624a","impliedFormat":1},{"version":"4fe9e626e7164748e8769bbf74b538e09607f07ed17c2f20af8d680ee49fc1da","impliedFormat":1},{"version":"24515859bc0b836719105bb6cc3d68255042a9f02a6022b3187948b204946bd2","impliedFormat":1},{"version":"ea0148f897b45a76544ae179784c95af1bd6721b8610af9ffa467a518a086a43","impliedFormat":1},{"version":"24c6a117721e606c9984335f71711877293a9651e44f59f3d21c1ea0856f9cc9","impliedFormat":1},{"version":"dd3273ead9fbde62a72949c97dbec2247ea08e0c6952e701a483d74ef92d6a17","impliedFormat":1},{"version":"405822be75ad3e4d162e07439bac80c6bcc6dbae1929e179cf467ec0b9ee4e2e","impliedFormat":1},{"version":"0db18c6e78ea846316c012478888f33c11ffadab9efd1cc8bcc12daded7a60b6","impliedFormat":1},{"version":"e61be3f894b41b7baa1fbd6a66893f2579bfad01d208b4ff61daef21493ef0a8","impliedFormat":1},{"version":"bd0532fd6556073727d28da0edfd1736417a3f9f394877b6d5ef6ad88fba1d1a","impliedFormat":1},{"version":"89167d696a849fce5ca508032aabfe901c0868f833a8625d5a9c6e861ef935d2","impliedFormat":1},{"version":"615ba88d0128ed16bf83ef8ccbb6aff05c3ee2db1cc0f89ab50a4939bfc1943f","impliedFormat":1},{"version":"a4d551dbf8746780194d550c88f26cf937caf8d56f102969a110cfaed4b06656","impliedFormat":1},{"version":"8bd86b8e8f6a6aa6c49b71e14c4ffe1211a0e97c80f08d2c8cc98838006e4b88","impliedFormat":1},{"version":"317e63deeb21ac07f3992f5b50cdca8338f10acd4fbb7257ebf56735bf52ab00","impliedFormat":1},{"version":"4732aec92b20fb28c5fe9ad99521fb59974289ed1e45aecb282616202184064f","impliedFormat":1},{"version":"2e85db9e6fd73cfa3d7f28e0ab6b55417ea18931423bd47b409a96e4a169e8e6","impliedFormat":1},{"version":"c46e079fe54c76f95c67fb89081b3e399da2c7d109e7dca8e4b58d83e332e605","impliedFormat":1},{"version":"bf67d53d168abc1298888693338cb82854bdb2e69ef83f8a0092093c2d562107","impliedFormat":1},{"version":"88d9a77d2abc23a7d26625dd6dae5b57199a8693b85c9819355651c9d9bab90f","affectsGlobalScope":true,"impliedFormat":1},{"version":"a38efe83ff77c34e0f418a806a01ca3910c02ee7d64212a59d59bca6c2c38fa1","impliedFormat":1},{"version":"7394959e5a741b185456e1ef5d64599c36c60a323207450991e7a42e08911419","impliedFormat":1},{"version":"3fe4022ba1e738034e38ad9afacbf0f1f16b458ed516326f5bf9e4a31e9be1dc","impliedFormat":1},{"version":"a957197054b074bcdf5555d26286e8461680c7c878040d0f4e2d5509a7524944","affectsGlobalScope":true,"impliedFormat":1},{"version":"4314c7a11517e221f7296b46547dbc4df047115b182f544d072bdccffa57fc72","impliedFormat":1},{"version":"e9b97d69510658d2f4199b7d384326b7c4053b9e6645f5c19e1c2a54ede427fc","impliedFormat":1},{"version":"c2510f124c0293ab80b1777c44d80f812b75612f297b9857406468c0f4dafe29","affectsGlobalScope":true,"impliedFormat":1},{"version":"5524481e56c48ff486f42926778c0a3cce1cc85dc46683b92b1271865bcf015a","impliedFormat":1},{"version":"f478f6f5902dc144c0d6d7bdc919c5177cac4d17a8ca8653c2daf6d7dc94317f","affectsGlobalScope":true,"impliedFormat":1},{"version":"19d5f8d3930e9f99aa2c36258bf95abbe5adf7e889e6181872d1cdba7c9a7dd5","impliedFormat":1},{"version":"b200675fd112ffef97c166d0341fb33f6e29e9f27660adde7868e95c5bc98beb","impliedFormat":1},{"version":"a6bf63d17324010ca1fbf0389cab83f93389bb0b9a01dc8a346d092f65b3605f","impliedFormat":1},{"version":"e009777bef4b023a999b2e5b9a136ff2cde37dc3f77c744a02840f05b18be8ff","impliedFormat":1},{"version":"1e0d1f8b0adfa0b0330e028c7941b5a98c08b600efe7f14d2d2a00854fb2f393","impliedFormat":1},{"version":"ee1ee365d88c4c6c0c0a5a5701d66ebc27ccd0bcfcfaa482c6e2e7fe7b98edf7","affectsGlobalScope":true,"impliedFormat":1},{"version":"88bc59b32d0d5b4e5d9632ac38edea23454057e643684c3c0b94511296f2998c","affectsGlobalScope":true,"impliedFormat":1},{"version":"a0a1dda070290b92da5a50113b73ecc4dd6bcbffad66e3c86503d483eafbadcf","impliedFormat":1},{"version":"59dcad36c4549175a25998f6a8b33c1df8e18df9c12ebad1dfb25af13fd4b1ce","impliedFormat":1},{"version":"206a70e72af3e24688397b81304358526ce70d020e4c2606c4acfd1fa1e81fb2","impliedFormat":1},{"version":"3f3edb8e44e3b9df3b7ca3219ab539710b6a7f4fe16bd884d441af207e03cd57","impliedFormat":1},{"version":"528b62e4272e3ddfb50e8eed9e359dedea0a4d171c3eb8f337f4892aac37b24b","impliedFormat":1},{"version":"d71535813e39c23baa113bc4a29a0e187b87d1105ccc8c5a6ebaca38d9a9bff2","impliedFormat":1},{"version":"8cf7e92bdb2862c2d28ba4535c43dc599cfbc0025db5ed9973d9b708dcbe3d98","affectsGlobalScope":true,"impliedFormat":1},{"version":"f72bc8fe16da67e4e3268599295797b202b95e54bd215a03f97e925dd1502a36","impliedFormat":1},{"version":"b1b6ee0d012aeebe11d776a155d8979730440082797695fc8e2a5c326285678f","impliedFormat":1},{"version":"45875bcae57270aeb3ebc73a5e3fb4c7b9d91d6b045f107c1d8513c28ece71c0","impliedFormat":1},{"version":"1dc73f8854e5c4506131c4d95b3a6c24d0c80336d3758e95110f4c7b5cb16397","affectsGlobalScope":true,"impliedFormat":1},{"version":"636302a00dfd1f9fe6e8e91e4e9350c6518dcc8d51a474e4fc3a9ba07135100b","affectsGlobalScope":true,"impliedFormat":1},{"version":"3f16a7e4deafa527ed9995a772bb380eb7d3c2c0fd4ae178c5263ed18394db2c","impliedFormat":1},{"version":"933921f0bb0ec12ef45d1062a1fc0f27635318f4d294e4d99de9a5493e618ca2","impliedFormat":1},{"version":"71a0f3ad612c123b57239a7749770017ecfe6b66411488000aba83e4546fde25","impliedFormat":1},{"version":"8145e07aad6da5f23f2fcd8c8e4c5c13fb26ee986a79d03b0829b8fce152d8b2","impliedFormat":1},{"version":"e1120271ebbc9952fdc7b2dd3e145560e52e06956345e6fdf91d70ca4886464f","impliedFormat":1},{"version":"814118df420c4e38fe5ae1b9a3bafb6e9c2aa40838e528cde908381867be6466","impliedFormat":1},{"version":"e1ce1d622f1e561f6cdf246372ead3bbc07ce0342024d0e9c7caf3136f712698","impliedFormat":1},{"version":"c878f74b6d10b267f6075c51ac1d8becd15b4aa6a58f79c0cfe3b24908357f60","impliedFormat":1},{"version":"37ba7b45141a45ce6e80e66f2a96c8a5ab1bcef0fc2d0f56bb58df96ec67e972","impliedFormat":1},{"version":"125d792ec6c0c0f657d758055c494301cc5fdb327d9d9d5960b3f129aff76093","impliedFormat":1},{"version":"27e4532aaaa1665d0dd19023321e4dc12a35a741d6b8e1ca3517fcc2544e0efe","affectsGlobalScope":true,"impliedFormat":1},{"version":"2754d8221d77c7b382096651925eb476f1066b3348da4b73fe71ced7801edada","impliedFormat":1},{"version":"8c2ad42d5d1a2e8e6112625767f8794d9537f1247907378543106f7ba6c7df90","affectsGlobalScope":true,"impliedFormat":1},{"version":"f0be1b8078cd549d91f37c30c222c2a187ac1cf981d994fb476a1adc61387b14","affectsGlobalScope":true,"impliedFormat":1},{"version":"0aaed1d72199b01234152f7a60046bc947f1f37d78d182e9ae09c4289e06a592","impliedFormat":1},{"version":"98ffdf93dfdd206516971d28e3e473f417a5cfd41172e46b4ce45008f640588e","impliedFormat":1},{"version":"66ba1b2c3e3a3644a1011cd530fb444a96b1b2dfe2f5e837a002d41a1a799e60","impliedFormat":1},{"version":"7e514f5b852fdbc166b539fdd1f4e9114f29911592a5eb10a94bb3a13ccac3c4","impliedFormat":1},{"version":"7d6ff413e198d25639f9f01f16673e7df4e4bd2875a42455afd4ecc02ef156da","affectsGlobalScope":true,"impliedFormat":1},{"version":"12e8ce658dd17662d82fb0509d2057afc5e6ee30369a2e9e0957eff725b1f11d","affectsGlobalScope":true,"impliedFormat":1},{"version":"74736930d108365d7bbe740c7154706ccfb1b2a3855a897963ab3e5c07ecbf19","impliedFormat":1},{"version":"858f999b3e4a45a4e74766d43030941466460bf8768361d254234d5870480a53","impliedFormat":1},{"version":"ac5ed35e649cdd8143131964336ab9076937fa91802ec760b3ea63b59175c10a","impliedFormat":1},{"version":"63b05afa6121657f25e99e1519596b0826cda026f09372c9100dfe21417f4bd6","affectsGlobalScope":true,"impliedFormat":1},{"version":"3797dd6f4ea3dc15f356f8cdd3128bfa18122213b38a80d6c1f05d8e13cbdad8","impliedFormat":1},{"version":"ad90122e1cb599b3bc06a11710eb5489101be678f2920f2322b0ac3e195af78d","impliedFormat":1},{"version":"bc222163edcb8df6ba9b506d053d6c5afcae50e85695151cf4636a3107deaba9","impliedFormat":1},{"version":"e2b48abff5a8adc6bb1cd13a702b9ef05e6045a98e7cfa95a8779b53b6d0e69d","impliedFormat":1},{"version":"89121c1bf2990f5219bfd802a3e7fc557de447c62058d6af68d6b6348d64499a","impliedFormat":1},{"version":"79b4369233a12c6fa4a07301ecb7085802c98f3a77cf9ab97eee27e1656f82e6","impliedFormat":1},{"version":"d7dbe0ad36bdca8a6ecf143422a48e72cc8927bab7b23a1a2485c2f78a7022c6","impliedFormat":1},{"version":"035a5df183489c2e22f3cf59fc1ed2b043d27f357eecc0eb8d8e840059d44245","impliedFormat":1},{"version":"f3d8c757e148ad968f0d98697987db363070abada5f503da3c06aefd9d4248c1","impliedFormat":1},{"version":"96d14f21b7652903852eef49379d04dbda28c16ed36468f8c9fa08f7c14c9538","impliedFormat":1},{"version":"d4a22007b481fe2a2e6bfd3a42c00cd62d41edb36d30fc4697df2692e9891fc8","impliedFormat":1},{"version":"8841e2aa774b89bd23302dede20663306dc1b9902431ac64b24be8b8d0e3f649","impliedFormat":1},{"version":"fbca5ffaebf282ec3cdac47b0d1d4a138a8b0bb32105251a38acb235087d3318","impliedFormat":1},{"version":"29f72ec1289ae3aeda78bf14b38086d3d803262ac13904b400422941a26a3636","affectsGlobalScope":true,"impliedFormat":1},{"version":"22293bd6fa12747929f8dfca3ec1684a3fe08638aa18023dd286ab337e88a592","impliedFormat":1},{"version":"916be7d770b0ae0406be9486ac12eb9825f21514961dd050594c4b250617d5a8","impliedFormat":1},{"version":"510616459e6edd01acbce333fb256e06bdffdad43ca233a9090164bf8bb83912","impliedFormat":1},{"version":"7d2a0ba1297be385a89b5515b88cd31b4a1eeef5236f710166dc1b36b1741e1b","impliedFormat":1},{"version":"6175dda01fddf3684d6261d97d169d86b024eceb2cc20041936c068789230f8f","impliedFormat":1},{"version":"4006c872e38a2c4e09c593bc0cdd32b7b4f5c4843910bea0def631c483fff6c5","impliedFormat":1},{"version":"ab6aa3a65d473871ee093e3b7b71ed0f9c69e07d1d4295f45c9efd91a771241d","impliedFormat":1},{"version":"74d5a87c3616cd5d8691059d531504403aa857e09cbaecb1c64dfb9ace0db185","impliedFormat":1}],"root":[[99,102],106,107,109,[145,148],157,159,[161,166]],"options":{"allowJs":true,"checkJs":true,"composite":true,"declaration":true,"declarationMap":true,"emitDeclarationOnly":false,"esModuleInterop":true,"module":101,"noEmitOnError":true,"outDir":"./","removeComments":false,"rewriteRelativeImportExtensions":true,"skipLibCheck":true,"sourceMap":true,"strict":true,"stripInternal":true,"target":11,"verbatimModuleSyntax":true},"referencedMap":[[135,1],[136,2],[123,3],[125,4],[141,5],[126,5],[142,6],[143,7],[111,8],[127,9],[137,10],[112,11],[124,12],[128,13],[129,14],[139,15],[140,16],[130,5],[131,9],[133,17],[132,18],[134,19],[144,20],[118,21],[115,22],[114,22],[116,23],[121,24],[122,25],[113,24],[119,26],[120,27],[150,28],[154,28],[152,28],[149,5],[168,29],[268,30],[269,5],[271,31],[272,5],[273,5],[274,5],[275,5],[276,31],[277,5],[278,5],[279,5],[167,5],[214,32],[215,32],[216,33],[174,34],[217,35],[218,36],[219,37],[169,5],[172,38],[170,5],[171,5],[220,39],[221,40],[222,41],[223,42],[224,43],[225,44],[226,44],[228,6],[227,45],[229,46],[230,47],[231,48],[213,49],[173,5],[232,50],[233,51],[234,52],[267,53],[235,54],[236,55],[237,56],[238,57],[239,58],[240,59],[241,60],[242,61],[243,62],[244,63],[245,63],[246,64],[247,5],[248,5],[249,65],[251,66],[250,67],[252,68],[253,69],[254,70],[255,71],[256,72],[257,73],[258,74],[259,75],[260,76],[261,77],[262,78],[263,79],[264,80],[265,81],[266,82],[280,5],[281,5],[282,5],[284,83],[283,5],[285,5],[286,5],[270,5],[287,84],[155,85],[175,5],[153,28],[151,86],[156,5],[73,5],[74,5],[103,5],[108,5],[105,87],[138,5],[75,5],[104,5],[76,5],[91,88],[77,5],[92,89],[81,90],[85,5],[80,91],[82,92],[83,93],[84,93],[86,94],[87,95],[78,5],[90,96],[89,97],[79,98],[88,5],[117,5],[71,5],[72,5],[12,5],[13,5],[16,5],[15,5],[2,5],[17,5],[18,5],[19,5],[20,5],[21,5],[22,5],[23,5],[24,5],[3,5],[25,5],[26,5],[4,5],[27,5],[31,5],[28,5],[29,5],[30,5],[32,5],[33,5],[34,5],[5,5],[35,5],[36,5],[37,5],[38,5],[6,5],[42,5],[39,5],[40,5],[41,5],[43,5],[7,5],[44,5],[49,5],[50,5],[45,5],[46,5],[47,5],[48,5],[8,5],[54,5],[51,5],[52,5],[53,5],[55,5],[9,5],[56,5],[57,5],[58,5],[60,5],[59,5],[61,5],[62,5],[10,5],[63,5],[64,5],[65,5],[11,5],[66,5],[67,5],[68,5],[69,5],[70,5],[1,5],[14,5],[110,5],[160,99],[94,99],[93,100],[191,101],[201,102],[190,101],[211,103],[182,104],[181,105],[210,30],[204,106],[209,107],[184,108],[198,109],[183,110],[207,111],[179,112],[178,30],[208,113],[180,114],[185,115],[186,5],[189,115],[176,5],[212,116],[202,117],[193,118],[194,119],[196,120],[192,121],[195,122],[205,30],[187,123],[188,124],[197,125],[177,126],[200,117],[199,115],[203,5],[206,127],[99,128],[100,129],[147,130],[106,131],[102,129],[109,132],[146,133],[101,134],[107,135],[145,136],[148,5],[157,137],[159,138],[161,139],[162,140],[163,141],[164,142],[165,143],[166,144],[158,145],[98,146],[95,147],[96,5],[97,148]],"latestChangedDtsFile":"./test/utils.spec.d.ts","version":"5.8.3"}
\ No newline at end of file
diff --git a/node_modules/datastore-core/dist/typedoc-urls.json b/node_modules/datastore-core/dist/typedoc-urls.json
deleted file mode 100644
index 9626c93..0000000
--- a/node_modules/datastore-core/dist/typedoc-urls.json
+++ /dev/null
@@ -1,38 +0,0 @@
-{
-  "BaseDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.base.BaseDatastore.html",
-  "./base:BaseDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.base.BaseDatastore.html",
-  "BlackHoleDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.black_hole.BlackHoleDatastore.html",
-  "./black-hole:BlackHoleDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.black_hole.BlackHoleDatastore.html",
-  "KeyTransform": "https://ipfs.github.io/js-stores/interfaces/datastore_core.index.KeyTransform.html",
-  ".:KeyTransform": "https://ipfs.github.io/js-stores/interfaces/datastore_core.index.KeyTransform.html",
-  "Shard": "https://ipfs.github.io/js-stores/interfaces/datastore_core.index.Shard-1.html",
-  ".:Shard": "https://ipfs.github.io/js-stores/interfaces/datastore_core.index.Shard-1.html",
-  "KeyTransformDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.keytransform.KeyTransformDatastore.html",
-  "./keytransform:KeyTransformDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.keytransform.KeyTransformDatastore.html",
-  "MemoryDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.memory.MemoryDatastore.html",
-  "./memory:MemoryDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.memory.MemoryDatastore.html",
-  "MountDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.mount.MountDatastore.html",
-  "./mount:MountDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.mount.MountDatastore.html",
-  "NamespaceDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.namespace.NamespaceDatastore.html",
-  "./namespace:NamespaceDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.namespace.NamespaceDatastore.html",
-  "NextToLast": "https://ipfs.github.io/js-stores/classes/datastore_core.shard.NextToLast.html",
-  "./shard:NextToLast": "https://ipfs.github.io/js-stores/classes/datastore_core.shard.NextToLast.html",
-  "Prefix": "https://ipfs.github.io/js-stores/classes/datastore_core.shard.Prefix.html",
-  "./shard:Prefix": "https://ipfs.github.io/js-stores/classes/datastore_core.shard.Prefix.html",
-  "ShardBase": "https://ipfs.github.io/js-stores/classes/datastore_core.shard.ShardBase.html",
-  "./shard:ShardBase": "https://ipfs.github.io/js-stores/classes/datastore_core.shard.ShardBase.html",
-  "Suffix": "https://ipfs.github.io/js-stores/classes/datastore_core.shard.Suffix.html",
-  "./shard:Suffix": "https://ipfs.github.io/js-stores/classes/datastore_core.shard.Suffix.html",
-  "PREFIX": "https://ipfs.github.io/js-stores/variables/datastore_core.shard.PREFIX-1.html",
-  "./shard:PREFIX": "https://ipfs.github.io/js-stores/variables/datastore_core.shard.PREFIX-1.html",
-  "SHARDING_FN": "https://ipfs.github.io/js-stores/variables/datastore_core.shard.SHARDING_FN.html",
-  "./shard:SHARDING_FN": "https://ipfs.github.io/js-stores/variables/datastore_core.shard.SHARDING_FN.html",
-  "parseShardFun": "https://ipfs.github.io/js-stores/functions/datastore_core.shard.parseShardFun.html",
-  "./shard:parseShardFun": "https://ipfs.github.io/js-stores/functions/datastore_core.shard.parseShardFun.html",
-  "readShardFun": "https://ipfs.github.io/js-stores/functions/datastore_core.shard.readShardFun.html",
-  "./shard:readShardFun": "https://ipfs.github.io/js-stores/functions/datastore_core.shard.readShardFun.html",
-  "ShardingDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.sharding.ShardingDatastore.html",
-  "./sharding:ShardingDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.sharding.ShardingDatastore.html",
-  "TieredDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.tiered.TieredDatastore.html",
-  "./tiered:TieredDatastore": "https://ipfs.github.io/js-stores/classes/datastore_core.tiered.TieredDatastore.html"
-}
\ No newline at end of file
diff --git a/node_modules/datastore-core/src/black-hole.ts b/node_modules/datastore-core/src/black-hole.ts
index f21ee82..e20f3c7 100644
--- a/node_modules/datastore-core/src/black-hole.ts
+++ b/node_modules/datastore-core/src/black-hole.ts
@@ -1,31 +1,36 @@
 import { NotFoundError } from 'interface-store'
 import { BaseDatastore } from './base.js'
-import type { Pair } from 'interface-datastore'
+import type { Pair, Query, KeyQuery } from 'interface-datastore'
 import type { Key } from 'interface-datastore/key'
-import type { Await, AwaitIterable } from 'interface-store'
+import type { AbortOptions, Await, AwaitIterable } from 'interface-store'
 
 export class BlackHoleDatastore extends BaseDatastore {
-  put (key: Key): Await<Key> {
+  put (key: Key, value: Uint8Array, options?: AbortOptions): Await<Key> {
+    options?.signal?.throwIfAborted()
     return key
   }
 
-  get (): Await<Uint8Array> {
+  get (key: Key, options?: AbortOptions): Await<Uint8Array> {
+    options?.signal?.throwIfAborted()
     throw new NotFoundError()
   }
 
-  has (key: Key): Await<boolean> {
+  has (key: Key, options?: AbortOptions): Await<boolean> {
+    options?.signal?.throwIfAborted()
     return false
   }
 
-  delete (key: Key): Await<void> {
-
+  delete (key: Key, options?: AbortOptions): Await<void> {
+    options?.signal?.throwIfAborted()
   }
 
-  * _all (): AwaitIterable<Pair> {
-
+  // eslint-disable-next-line require-yield
+  * _all (q: Query, options?: AbortOptions): AwaitIterable<Pair> {
+    options?.signal?.throwIfAborted()
   }
 
-  * _allKeys (): AwaitIterable<Key> {
-
+  // eslint-disable-next-line require-yield
+  * _allKeys (q: KeyQuery, options?: AbortOptions): AwaitIterable<Key> {
+    options?.signal?.throwIfAborted()
   }
 }
diff --git a/node_modules/datastore-core/src/index.ts b/node_modules/datastore-core/src/index.ts
index e3c75e8..b050078 100644
--- a/node_modules/datastore-core/src/index.ts
+++ b/node_modules/datastore-core/src/index.ts
@@ -5,12 +5,12 @@
  *
  * ## Implementations
  *
- * - Mount: [`src/mount`](src/mount.ts)
- * - Keytransform: [`src/keytransform`](src/keytransform.ts)
- * - Sharding: [`src/sharding`](src/sharding.ts)
- * - Tiered: [`src/tiered`](src/tirered.ts)
- * - Namespace: [`src/namespace`](src/namespace.ts)
- * - BlackHole: [`src/black-hole`](src/black-hole.ts)
+ * - Mount: [`src/mount`](./src/mount.ts)
+ * - Keytransform: [`src/keytransform`](./src/keytransform.ts)
+ * - Sharding: [`src/sharding`](./src/sharding.ts)
+ * - Tiered: [`src/tiered`](./src/tirered.ts)
+ * - Namespace: [`src/namespace`](./src/namespace.ts)
+ * - BlackHole: [`src/black-hole`](./src/black-hole.ts)
  *
  * @example BaseDatastore
  *
diff --git a/node_modules/datastore-core/src/memory.ts b/node_modules/datastore-core/src/memory.ts
index 1d12931..353751f 100644
--- a/node_modules/datastore-core/src/memory.ts
+++ b/node_modules/datastore-core/src/memory.ts
@@ -1,8 +1,8 @@
 import { Key } from 'interface-datastore/key'
 import { NotFoundError } from 'interface-store'
 import { BaseDatastore } from './base.js'
-import type { Pair } from 'interface-datastore'
-import type { Await, AwaitIterable } from 'interface-store'
+import type { KeyQuery, Pair, Query } from 'interface-datastore'
+import type { AbortOptions, Await, AwaitIterable } from 'interface-store'
 
 export class MemoryDatastore extends BaseDatastore {
   private readonly data: Map<string, Uint8Array>
@@ -13,13 +13,17 @@ export class MemoryDatastore extends BaseDatastore {
     this.data = new Map()
   }
 
-  put (key: Key, val: Uint8Array): Await<Key> { // eslint-disable-line require-await
+  put (key: Key, val: Uint8Array, options?: AbortOptions): Await<Key> {
+    options?.signal?.throwIfAborted()
+
     this.data.set(key.toString(), val)
 
     return key
   }
 
-  get (key: Key): Await<Uint8Array> {
+  get (key: Key, options?: AbortOptions): Await<Uint8Array> {
+    options?.signal?.throwIfAborted()
+
     const result = this.data.get(key.toString())
 
     if (result == null) {
@@ -29,23 +33,29 @@ export class MemoryDatastore extends BaseDatastore {
     return result
   }
 
-  has (key: Key): Await<boolean> { // eslint-disable-line require-await
+  has (key: Key, options?: AbortOptions): Await<boolean> {
+    options?.signal?.throwIfAborted()
     return this.data.has(key.toString())
   }
 
-  delete (key: Key): Await<void> { // eslint-disable-line require-await
+  delete (key: Key, options?: AbortOptions): Await<void> {
+    options?.signal?.throwIfAborted()
     this.data.delete(key.toString())
   }
 
-  * _all (): AwaitIterable<Pair> {
+  * _all (q: Query, options?: AbortOptions): AwaitIterable<Pair> {
+    options?.signal?.throwIfAborted()
     for (const [key, value] of this.data.entries()) {
       yield { key: new Key(key), value }
+      options?.signal?.throwIfAborted()
     }
   }
 
-  * _allKeys (): AwaitIterable<Key> {
+  * _allKeys (q: KeyQuery, options?: AbortOptions): AwaitIterable<Key> {
+    options?.signal?.throwIfAborted()
     for (const key of this.data.keys()) {
       yield new Key(key)
+      options?.signal?.throwIfAborted()
     }
   }
 }
diff --git a/node_modules/datastore-core/src/mount.ts b/node_modules/datastore-core/src/mount.ts
index 1e04de7..3e47e46 100644
--- a/node_modules/datastore-core/src/mount.ts
+++ b/node_modules/datastore-core/src/mount.ts
@@ -117,14 +117,14 @@ export class MountDatastore extends BaseDatastore {
     })
 
     let it = merge(...qs)
-    if (q.filters != null) q.filters.forEach(f => { it = filter(it, f) })
-    if (q.orders != null) q.orders.forEach(o => { it = sort(it, o) })
+    if (q.filters != null) { q.filters.forEach(f => { it = filter(it, f) }) }
+    if (q.orders != null) { q.orders.forEach(o => { it = sort(it, o) }) }
     if (q.offset != null) {
       let i = 0
       const offset = q.offset
       it = filter(it, () => i++ >= offset)
     }
-    if (q.limit != null) it = take(it, q.limit)
+    if (q.limit != null) { it = take(it, q.limit) }
 
     return it
   }
@@ -139,14 +139,14 @@ export class MountDatastore extends BaseDatastore {
 
     /** @type AsyncIterable<Key> */
     let it = merge(...qs)
-    if (q.filters != null) q.filters.forEach(f => { it = filter(it, f) })
-    if (q.orders != null) q.orders.forEach(o => { it = sort(it, o) })
+    if (q.filters != null) { q.filters.forEach(f => { it = filter(it, f) }) }
+    if (q.orders != null) { q.orders.forEach(o => { it = sort(it, o) }) }
     if (q.offset != null) {
       let i = 0
       const offset = q.offset
       it = filter(it, () => i++ >= offset)
     }
-    if (q.limit != null) it = take(it, q.limit)
+    if (q.limit != null) { it = take(it, q.limit) }
 
     return it
   }
diff --git a/node_modules/datastore-core/src/namespace.ts b/node_modules/datastore-core/src/namespace.ts
index faaf528..7b9d8c2 100644
--- a/node_modules/datastore-core/src/namespace.ts
+++ b/node_modules/datastore-core/src/namespace.ts
@@ -1,6 +1,7 @@
-import { Key, type Datastore, type Query, type Pair, type KeyQuery } from 'interface-datastore'
+import { Key } from 'interface-datastore'
 import map from 'it-map'
 import { KeyTransformDatastore } from './keytransform.js'
+import type { Datastore, Query, Pair, KeyQuery } from 'interface-datastore'
 import type { AbortOptions } from 'interface-store'
 
 /**
diff --git a/node_modules/datastore-core/src/tiered.ts b/node_modules/datastore-core/src/tiered.ts
index be5a8de..1998c23 100644
--- a/node_modules/datastore-core/src/tiered.ts
+++ b/node_modules/datastore-core/src/tiered.ts
@@ -1,7 +1,5 @@
 import { logger } from '@libp2p/logger'
-import { PutFailedError, NotFoundError, DeleteFailedError } from 'interface-store'
-import drain from 'it-drain'
-import { pushable } from 'it-pushable'
+import { NotFoundError } from 'interface-store'
 import { BaseDatastore } from './base.js'
 import type { Batch, Datastore, Key, KeyQuery, Pair, Query } from 'interface-datastore'
 import type { AbortOptions, AwaitIterable } from 'interface-store'
@@ -25,24 +23,32 @@ export class TieredDatastore extends BaseDatastore {
   }
 
   async put (key: Key, value: Uint8Array, options?: AbortOptions): Promise<Key> {
-    try {
-      await Promise.all(this.stores.map(async store => { await store.put(key, value, options) }))
-      return key
-    } catch (err: any) {
-      throw new PutFailedError(err.message)
-    }
+    await Promise.all(
+      this.stores.map(async store => {
+        await store.put(key, value, options)
+      })
+    )
+
+    return key
   }
 
   async get (key: Key, options?: AbortOptions): Promise<Uint8Array> {
+    let error: Error | undefined
+
     for (const store of this.stores) {
       try {
         const res = await store.get(key, options)
-        if (res != null) return res
-      } catch (err) {
+
+        if (res != null) {
+          return res
+        }
+      } catch (err: any) {
+        error = err
         log.error(err)
       }
     }
-    throw new NotFoundError()
+
+    throw error ?? new NotFoundError()
   }
 
   async has (key: Key, options?: AbortOptions): Promise<boolean> {
@@ -56,72 +62,24 @@ export class TieredDatastore extends BaseDatastore {
   }
 
   async delete (key: Key, options?: AbortOptions): Promise<void> {
-    try {
-      await Promise.all(this.stores.map(async store => { await store.delete(key, options) }))
-    } catch (err: any) {
-      throw new DeleteFailedError(err.message)
-    }
+    await Promise.all(
+      this.stores.map(async store => {
+        await store.delete(key, options)
+      })
+    )
   }
 
   async * putMany (source: AwaitIterable<Pair>, options: AbortOptions = {}): AsyncIterable<Key> {
-    let error: Error | undefined
-    const pushables = this.stores.map(store => {
-      const source = pushable<Pair>({
-        objectMode: true
-      })
-
-      drain(store.putMany(source, options))
-        .catch(err => {
-          // store threw while putting, make sure we bubble the error up
-          error = err
-        })
-
-      return source
-    })
-
-    try {
-      for await (const pair of source) {
-        if (error != null) {
-          throw error
-        }
-
-        pushables.forEach(p => p.push(pair))
-
-        yield pair.key
-      }
-    } finally {
-      pushables.forEach(p => p.end())
+    for await (const pair of source) {
+      await this.put(pair.key, pair.value, options)
+      yield pair.key
     }
   }
 
   async * deleteMany (source: AwaitIterable<Key>, options: AbortOptions = {}): AsyncIterable<Key> {
-    let error: Error | undefined
-    const pushables = this.stores.map(store => {
-      const source = pushable<Key>({
-        objectMode: true
-      })
-
-      drain(store.deleteMany(source, options))
-        .catch(err => {
-          // store threw while deleting, make sure we bubble the error up
-          error = err
-        })
-
-      return source
-    })
-
-    try {
-      for await (const key of source) {
-        if (error != null) {
-          throw error
-        }
-
-        pushables.forEach(p => p.push(key))
-
-        yield key
-      }
-    } finally {
-      pushables.forEach(p => p.end())
+    for await (const key of source) {
+      await this.delete(key, options)
+      yield key
     }
   }
 
